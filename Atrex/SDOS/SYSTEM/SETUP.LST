Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 1
setup.asm



      1	    0000			 _TEXT	 segment use16
      2					 assume	 cs:_TEXT, ds:_TEXT, es:_TEXT, ss:_TEXT
      3					 org	 100h
      4					 .486P
      5					 .487
      6
      7	    0100			 @FD:
      8	    0100  42				 inc	 dx
      9	    0101  4A				 dec	 dx
     10	    0102  E9 0086			 jmp	 start
     11					 include sheader.inc
1    12	00000105			 HeaderSt	 struc
1    13											 ;>
1    14	00000000  01*(31 38 2F 30 34  +		 _DATE_		 db	 ??DATE		 ;vyplåuje LINKER
     15		  2F 39	39)
1    16	00000008  01*(73 65 74 75 70  +		 _FILENAME_	 db	 ??FILENAME	 ;
     17		  20 20	20)
1    18	00000010  01*(31 32 3A 31 38  +		 _TIME_		 db	 ??TIME		 ;
     19		  3A 35	33)
1    20	00000018  01*(0314)			 _LINKVER_	 dw	 ??VERSION	 ;
1    21	0000001A  01*(1F9F)			 _CPU_		 dw	 @CPU		 ;
1    22											 ;<
1    23	0000001C  01*(0001)			 _OSMajorVer	 dw	 0001h
1    24	0000001E  01*(0000)			 _OSMinorVer	 dw	 0000h
1    25	00000020  01*(0010)			 _OSBuildVer	 dw	 0010h
1    26	00000022  01*(42)			 _OSSubVer	 db	 "B"
1    27	00000023  01*(00)			 _OSMode	 db	 00h		 ;0 - vçechny ,	1 - re lnì,
1    28											 ; 2 - chr nØnì
1    29	00000024  01*(0E)			 _OS		 db	 0Eh		 ;ATREX	(SDOS)
1    30	00000025  01*(41545245)			 _OS_		 dd	 "ATRE"
1    31	00000029  01*(584F5378)			 _OS__		 dd	 "XOSx"
1    32	0000002D  01*(0006)			 _ModuleType	 dw	 0006h		 ;1 - COM, 2 - DAT, 3 -	OVL,
1    33											 ; 4 - font, 5 - DLL, 6	- SYS
1    34	0000002F  01*(FF)			 _OSGrSubsystem	 db	 0FFh		 ;11h -	GUI, 22h - TEXT,
1    35											 ; FF -	zavadØŸ
1    36	00000030  01*(22FF)			 _ModuleFlags	 dw	 22FFh		 ;xx11h	- aplikace, xx22h - TSR
1    37											 ; xxFFh - j dro
1    38											 ; 00xxh - 8bit, 11xx -	16bit
1    39											 ; 22xxh - 32bit, 33xx - 64bit
1    40	00000032  01*(0001)			 _ModMajorVer	 dw	 0001h
1    41	00000034  01*(0000)			 _ModMinorVer	 dw	 0000h
1    42	00000036  01*(0010)			 _ModBuildVer	 dw	 0010h
1    43	00000038  01*(42)			 _ModSubVer	 db	 "B"
1    44
1    45	00000039  01*(11)			 _NeedCPU	 db	 11h		 ;00h -	8086, 11h - 386
1    46											 ; 22h - 486, 33h - 586
1    47	0000003A  01*(11)			 _NeedFPU	 db	 11h		 ;00h -	ne, 11h	- ano
1    48	0000003B  01*(00000000)			 _StartEIP	 dd	 00000000h	 ;Startovac¡ instrukce EIP
1    49	0000003F  01*(0000)			 _StartCS	 dw	 0000h		 ;Startovac¡ segment
1    50											 ; -mus¡ se nakop¡rovat	tam!!!
1    51	00000041  01*(00000000)			 _DataTblOff	 dd	 00000000h
1    52	00000045  01*(0000)			 _DataTblSeg	 dw	 0000h
1    53	00000047  01*(00000000)			 _ResourceTblOff dd	 00000000h
1    54	0000004B  01*(0000)			 _ResourceTblSeg dw	 0000h
1    55	0000004D  01*(00000000)			 _CodeTableOff	 dd	 00000000h
1    56	00000051  01*(0000)			 _CodeTableSeg	 dw	 0000h
1    57	00000053  01*(00000000)			 _ImportTblOff	 dd	 00000000h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 2
setup.asm



1    58	00000057  01*(0000)			 _ImportTblSeg	 dw	 0000h
1    59	00000059  01*(00000000)			 _ExportTblOff	 dd	 00000000h
1    60	0000005D  01*(0000)			 _ExportTblSeg	 dw	 0000h
1    61	0000005F  01*(00000000)			 _StartSP	 dd	 00000000h
1    62	00000063  01*(0000)			 _StartSS	 dw	 0000h
1    63	00000065  01*(0000)			 _MinMem	 dw	 0000h		 ;Potýebn  pamØœ MinMem	* 16
1    64	00000067  01*(0000)			 _MaxMem	 dw	 0000h
1    65	00000069  01*(00000000)			 _CheckSumCRC	 dd	 00000000h		 ;Kontroln¡ souŸet
1    66	0000006D  01*(00)			 _NeedDOSEnvir	 db	 00h		 ;0 - ne, 1 - ano
1    67	0000006E  01*(00000000)			 _FileSize	 dd	 00000000h
1    68	00000072  01*(00)			 _LoadedOK_	 db	 00h		 ;00 - mus¡ bìt	v souboru
1    69											 ; 11h - (v pamØti) OK
1    70											 ; 99h - nelze urŸit
1    71											 ; FFh - (v pamØti) CHYBA
1    72											 ; nastavuje inicializaŸn¡ rutina
1    73											 ; potvrzen¡ zaveden¡ na spr vn‚
1    74											 ; m¡sto, vyplnØn¡ potýebnìch
1    75											 ; polo§ek a spr vnost syst‚mu
1    76	00000073			 HeaderSt	 ends
1    77	    0105  31 38	2F 30 34 2F 39+	 HeaderSt_ HeaderSt<>
     78		  39 73	65 74 75 70 20+
     79		  20 20	31 32 3A 31 38+
     80		  3A 35	33 0314	1F9F  +
     81		  0001 0000 0010 42 00+
     82		  0E 41545245 584F5378+
     83		  0006 FF 22FF 0001   +
     84		  0000 0010 42 11 11  +
     85		  00000000 0000	      +
     86		  00000000 0000	      +
     87		  00000000 0000	      +
     88		  00000000 0000	      +
     89		  00000000 0000	      +
     90		  00000000 0000	      +
     91		  00000000 0000	0000  +
     92		  0000 00000000	00    +
     93		  00000000 00
1    94
     95	    0178  41 54	52 45 58 20 4F+		 db	 "ATREX	OS 1.00.0010",0
     96		  53 20	31 2E 30 30 2E+
     97		  30 30	31 30 00
     98
     99					 include .\makro.mac
1   100					 PUSHREG MACRO	 B
1   101						 IRP	 X,<B>
1   102						  PUSH	 X
1   103						 ENDM
1   104						 ENDM
1   105
1   106					 POPREG	 MACRO	 B
1   107						 IRP	 X,<B>
1   108						  POP	 X
1   109						 ENDM
1   110						 ENDM
1   111
1   112					 ;;Ÿ¡slo, var adresa ýetØzce
1   113					 BIN_ASC MACRO	 CISLO,	RET
1   114						 LOCAL	 DALSI_ZNAK
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 3
setup.asm



1   115						 PUSHREG <AX, BX, CX, DX, DI>
1   116						 MOV	 AX, CISLO
1   117						 MOV	 CX, 5
1   118						 MOV	 DI, 4
1   119						 MOV	 BX, 10
1   120					 DALSI_ZNAK:
1   121						 XOR	 DX,DX
1   122						 DIV	 BX
1   123						 OR	 DL,30h
1   124						 MOV	 RET[DI],DL
1   125						 DEC	 DI
1   126						 LOOP	 DALSI_ZNAK
1   127						 POPREG	 <DI, DX, CX, BX, AX>
1   128						 ENDM
1   129
    130
    131	    018B			 Start:
    132	    018B  8C C8				 mov	 ax, cs
    133	    018D  8E D8				 mov	 ds, ax
    134	    018F  88 16	3BAFr			 mov	 BootFromDisk, dl
    135	    0193  FA				 cli
    136	    0194  8E D0				 mov	 ss, ax
    137	    0196  BC 3F68r			 mov	 sp, offset ISTACK
    138	    0199  FB				 sti
    139
    140	    019A  B8 0012		 mov	 ax, 0012h
    141	    019D  CD 10			 int	 10h
    142
    143
    144	    019F  E8 0294			 call	 Int_Bak
    145	    01A2  BA 0C89r			 mov	 dx, offset INT00
    146	    01A5  B0 00				 mov	 al, 00h
    147	    01A7  E8 01A4			 Call	 Nastav_Int_Vec		 ;nast.	INT00h
    148
    149	    01AA  8C C8				 mov	 ax, cs
    150	    01AC  8E D8				 mov	 ds, ax
    151	    01AE  BE 3992r			 lea	 si, INIT_MESS	 ;Startuje se syst‚m ATREX...
    152	    01B1  E8 01D9			 call	 prtstr
    153	    01B4  BE 3B9Fr			 lea	 si, ENTER_MESS
    154	    01B7  E8 01D3			 call	 prtstr
    155
    156	    01BA  CC			 int	 3h
    157	    01BB  E8 0729			 call	 TestFor8086
    158	    01BE  3C 00				 cmp	 al, 0h
    159	    01C0  74 66	90 90			 je	 CpuInitError
    160
    161	    01C4  E8 0741			 call	 TestFor8087
    162	    01C7  3C 00				 cmp	 al, 0h
    163	    01C9  74 69	90 90			 je	 FpuInitError
    164
    165					 ;	 call	 VyplnExtBoot
    166	    01CD  CC			 int	 3h
    167
    168	    01CE  E8 0087			 call	 LogAdrFyzAdr
    169
    170	    01D1  E8 006C			 call	 SektoruNaFat
    171
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 4
setup.asm



    172	    01D4  E8 01FE			 call	 GET_EXT_MEM_SIZE
    173	    01D7  8B 16	3BB0r			 mov	 dx, EXT_MEM_SIZE
    174	    01DB  E8 0191			 call	 Print_Hex
    175	    01DE  B0 20				 mov	 al, " "
    176	    01E0  E8 01B9			 call	 PrtChr
    177
    178	    01E3  CC			 int	 3h
    179	    01E4  E8 020C			 call	 APM_BIOS_CHECK
    180	    01E7  8B 16	3BB4r			 mov	 dx, APM_BIOS_VER
    181	    01EB  E8 0181			 call	 Print_Hex
    182	    01EE  B0 20				 mov	 al, " "
    183	    01F0  E8 01A9			 call	 PrtChr
    184
    185	    01F3  E8 01E8			 call	 MOUSE_CHECK
    186	    01F6  8B 16	3BB2r			 mov	 dx, MOUSE_PRESENT
    187	    01FA  E8 0172			 call	 Print_Hex
    188	    01FD  BE 3B9Fr			 lea	 si,ENTER_MESS
    189	    0200  E8 018A			 call	 prtstr
    190
    191	    0203  E8 072F			 call	 DisksCheck	 ;test pý¡tomnosti pevnìch disk…
    192
    193	    0206  CC			 int	 3h
    194	    0207  BA 0597r			 mov	 dx, offset INT13
    195	    020A  B0 13				 mov	 al, 13h
    196	    020C  E8 013F			 Call	 Nastav_Int_Vec		 ;nast.	INT13h
    197
    198	    020F			 ErrorInit:
    199	    020F  8C C8				 mov	 ax, cs
    200	    0211  8E D8				 mov	 ds, ax
    201	    0213  BE 3A13r			 lea	 si, INIT_ERROR
    202	    0216  E8 0174			 call	 prtstr
    203	    0219  BE 39E1r			 lea	 si, PressAnyK
    204	    021C  E8 016E			 call	 prtstr
    205
    206	    021F  CC			 int	 3h
    207	    0220  33 C0				 xor	 ax,ax
    208	    0222  CD 16				 int	 16h
    209	    0224  E8 0F8A			 call	 Reset
    210	    0227  C3				 ret
    211
    212	    0228			 CpuInitError:
    213	    0228  8C C8				 mov	 ax, cs
    214	    022A  8E D8				 mov	 ds, ax
    215	    022C  BE 3A6Cr			 lea	 si, CPU_INIT_ERROR
    216	    022F  E8 015B			 call	 prtstr
    217	    0232  EB DB				 jmp	 ErrorInit
    218
    219	    0234			 FpuInitError:
    220	    0234  8C C8				 mov	 ax, cs
    221	    0236  8E D8				 mov	 ds, ax
    222	    0238  BE 3A9Er			 lea	 si, FPU_INIT_ERROR
    223	    023B  E8 014F			 call	 prtstr
    224	    023E  EB CF				 jmp	 ErrorInit
    225
    226					 include .\Vypocty.asm
1   227	    0240			 SektoruNaFat	 proc
1   228	    0240  DB E3				 fninit
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 5
setup.asm



1   229	    0242  9B DB	E3			 finit
1   230	    0245  DB 06	3976r			 fild	 dword ptr [Sektoru_TMP]
1   231	    0249  DB 2E	397Ar			 fld	 tbyte ptr [Konst_00195]
1   232					 ;	 fdivp	 st(1),	st
1   233	    024D  DE C9				 fmulp	 st(1),	st
1   234	    024F  DB 1E	3984r			 fistp	 dword ptr [SektoruNaFat_TMP]
1   235	    0253  9B				 fwait
1   236	    0254  9B DB	E3			 finit
1   237	    0257  C3				 ret
1   238	    0258			 SektoruNaFat	 endp
1   239
1   240					 ;--------------------
1   241	    0258			 LogAdrFyzAdr	 proc
1   242					 ;--------------------
1   243					 ;ECX=log. adresa
1   244					 ;!!! Vyplnit strukturu	ExtBoot	pro disk !!!
1   245					 ;->AL=Ÿ¡slo povrchu
1   246					 ;->BX=Ÿ¡slo stopy
1   247					 ;->DX=Ÿ¡slo sektoru
1   248	    0258  66| 2E: 89 0E	0329r		 mov	 dword ptr cs:[LogAdrSek], ECX
1   249						 ;Ÿ¡lo povrchu = (LogA/SekNaStopu) mod Povrchu + PoŸ teŸn¡PovrchOblasti
1   250	    025E  66| 8B C1			 mov	 eax, ecx
1   251	    0261  66| 33 C9			 xor	 ecx, ecx
1   252	    0264  2E: 8B 0E 3C6Ar		 mov	 cx, word ptr cs:[ExtBoot.SecOnCyl]
1   253
1   254	    0269  66| 83 F9 00			 cmp	 ecx,0
1   255	    026D  75 13	90 90			 jne	 LAFA_1
1   256	    0271  66| 60			 pushad
1   257	    0273  E8 0A97			 call	 CopyReg
1   258	    0276  B0 03				 mov	 al, 3
1   259	    0278  B3 FF				 mov	 bl, 0FFh
1   260	    027A  E8 0A28			 call	 ErrorMessage
1   261	    027D  66| 61			 popad
1   262	    027F  E9 00A6			 jmp	 LAFA_DONE
1   263	    0282			 LAFA_1:
1   264	    0282  66				 db	 66h
1   265	    0283  F7 F9				 idiv	 cx
1   266	    0285  66				 db	 66h
1   267	    0286  99				 cwd
1   268	    0287  2E: 8B 0E 3C6Cr		 mov	 cx, word ptr cs:[ExtBoot.Heads]
1   269
1   270	    028C  66| 83 F9 00			 cmp	 ecx,0
1   271	    0290  75 13	90 90			 jne	 LAFA_2
1   272	    0294  66| 60			 pushad
1   273	    0296  E8 0A74			 call	 CopyReg
1   274	    0299  B0 03				 mov	 al, 3
1   275	    029B  B3 FF				 mov	 bl, 0FFh
1   276	    029D  E8 0A05			 call	 ErrorMessage
1   277	    02A0  66| 61			 popad
1   278	    02A2  E9 0083			 jmp	 LAFA_DONE
1   279	    02A5			 LAFA_2:
1   280	    02A5  66				 db	 66h
1   281	    02A6  F7 F9				 idiv	 cx
1   282	    02A8  66				 db	 66h
1   283	    02A9  92				 xchg	 dx, ax
1   284	    02AA  66				 db	 66h
1   285	    02AB  33 C9				 xor	 cx, cx
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 6
setup.asm



1   286	    02AD  2E: 8A 0E 3BF1r		 mov	 cl, byte ptr cs:[ExtBoot.FirstHeaPart]
1   287	    02B2  03 C1				 add	 ax, cx
1   288	    02B4  50				 push	 ax
1   289						 ;Ÿ¡slo	stopy =	LogA/(SekNaStopu*Povrchu)+PoŸ teŸn¡StopaOblasti
1   290	    02B5  66| 33 C9			 xor	 ecx, ecx
1   291	    02B8  2E: A1 3C6Ar			 mov	 ax, word ptr cs:[ExtBoot.SecOnCyl]
1   292	    02BC  2E: 8B 0E 3C6Cr		 mov	 cx, word ptr cs:[ExtBoot.Heads]
1   293	    02C1  F7 E1				 mul	 cx
1   294	    02C3  8B C8				 mov	 cx, ax
1   295	    02C5  66| 2E: A1 0329r		 mov	 eax, dword ptr	cs:[LogAdrSek]
1   296	    02CA  66				 db	 66h
1   297	    02CB  99				 cwd
1   298
1   299	    02CC  66| 83 F9 00			 cmp	 ecx,0
1   300	    02D0  75 13	90 90			 jne	 LAFA_3
1   301	    02D4  66| 60			 pushad
1   302	    02D6  E8 0A34			 call	 CopyReg
1   303	    02D9  B0 03				 mov	 al, 3
1   304	    02DB  B3 FF				 mov	 bl, 0FFh
1   305	    02DD  E8 09C5			 call	 ErrorMessage
1   306	    02E0  66| 61			 popad
1   307	    02E2  EB 44	90			 jmp	 LAFA_DONE
1   308	    02E5			 LAFA_3:
1   309	    02E5  66				 db	 66h
1   310	    02E6  F7 F9				 idiv	 cx
1   311	    02E8  2E: 8B 0E 3BEFr		 mov	 cx, word ptr cs:[ExtBoot.FirstCylPart]
1   312	    02ED  03 C1				 add	 ax, cx
1   313	    02EF  93				 xchg	 bx, ax
1   314	    02F0  53				 push	 bx
1   315						 ;Ÿ¡slo	sektoru	= 1+(LodA mod SekNaStopu)+PoŸ teŸn¡SektorOblasti
1   316	    02F1  66| 33 C9			 xor	 ecx, ecx
1   317	    02F4  66| 2E: A1 0329r		 mov	 eax, dword ptr	cs:[LogAdrSek]
1   318	    02F9  66				 db	 66h
1   319	    02FA  99				 cwd
1   320	    02FB  2E: 8B 0E 3C6Ar		 mov	 cx, word ptr cs:[ExtBoot.SecOnCyl]
1   321
1   322	    0300  66| 83 F9 00			 cmp	 ecx,0
1   323	    0304  75 13	90 90			 jne	 LAFA_4
1   324	    0308  66| 60			 pushad
1   325	    030A  E8 0A00			 call	 CopyReg
1   326	    030D  B0 03				 mov	 al, 3
1   327	    030F  B3 FF				 mov	 bl, 0FFh
1   328	    0311  E8 0991			 call	 ErrorMessage
1   329	    0314  66| 61			 popad
1   330	    0316  EB 10	90			 jmp	 LAFA_DONE
1   331	    0319			 LAFA_4:
1   332	    0319  66				 db	 66h
1   333	    031A  F7 F9				 idiv	 cx
1   334	    031C  92				 xchg	 dx, ax
1   335	    031D  05 0001			 add	 ax, 1					 ;
1   336	    0320  2E: 03 06 3BEDr		 add	 ax, word ptr cs:[ExtBoot.FirstSecPart]	 ;
1   337	    0325  92				 xchg	 dx, ax
1   338	    0326  5B				 pop	 bx
1   339	    0327  58				 pop	 ax
1   340	    0328			 LAFA_DONE:
1   341	    0328  C3				 ret
1   342	    0329  00000000		 LogAdrSek	 dd	 0
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 7
setup.asm



1   343	    032D			 LogAdrFyzAdr	 endp
1   344
    345					 include .\func.asm
1   346					 ;¬ti vektor pýeruçen¡
1   347					 ;AL=vektor
1   348					 ;BX=0000:[AL*4]
1   349					 ;ES=0000:[(AL*4)+2]
1   350	    032D			 Cti_Int_Vec	 proc
1   351	    032D  FA				 cli
1   352	    032E  1E				 push	 ds
1   353	    032F  B4 00				 mov	 ah,00h
1   354	    0331  BB 0004			 mov	 bx,04h
1   355	    0334  F7 E3				 mul	 bx
1   356	    0336  50				 push	 ax
1   357	    0337  33 C0				 xor	 ax,ax
1   358	    0339  8E D8				 mov	 ds,ax
1   359	    033B  58				 pop	 ax
1   360	    033C  52				 push	 dx
1   361	    033D  8B D8				 mov	 bx,ax
1   362	    033F  8B 17				 mov	 dx, word ptr ds:[bx]
1   363	    0341  05 0002			 add	 ax,02h
1   364	    0344  8B D8				 mov	 bx,ax
1   365	    0346  8E 07				 mov	 ES, word ptr DS:[BX]
1   366	    0348  8B DA				 mov	 bx,dx
1   367	    034A  5A				 pop	 dx
1   368	    034B  1F				 pop	 ds
1   369	    034C  FB				 sti
1   370	    034D  C3				 ret
1   371	    034E			 Cti_Int_Vec	 endp
1   372
1   373					 ;Nastav vektor	pýeruçen¡
1   374					 ;AL=vektor
1   375					 ;DX=0000:[AL*4]
1   376					 ;DS=0000:[(AL*4)+2]
1   377	    034E			 Nastav_Int_Vec	 proc
1   378	    034E  FA				 cli
1   379	    034F  51				 push	 cx
1   380	    0350  8B CA				 mov	 cx, dx
1   381	    0352  B4 00				 mov	 ah, 00h
1   382	    0354  BB 0004			 mov	 bx, 04h
1   383	    0357  F7 E3				 mul	 bx
1   384	    0359  1E				 push	 ds
1   385	    035A  50				 push	 ax
1   386	    035B  33 C0				 xor	 ax, ax
1   387	    035D  8E D8				 mov	 ds, ax
1   388	    035F  58				 pop	 ax
1   389	    0360  8B D8				 mov	 bx, ax
1   390	    0362  89 0F				 mov	 word ptr DS:[BX], cx
1   391	    0364  05 0002			 add	 ax,02h
1   392	    0367  8B D8				 mov	 bx,ax
1   393	    0369  58				 pop	 ax
1   394	    036A  89 07				 mov	 word ptr DS:[BX], ax
1   395	    036C  59				 pop	 cx
1   396	    036D  FB				 sti
1   397	    036E  C3				 ret
1   398	    036F			 Nastav_Int_Vec	 endp
1   399
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 8
setup.asm



1   400					 ;Tisk 4 hex Ÿ¡slic
1   401					 ;DX=¬¡slo
1   402	    036F			 Print_Hex	 proc
1   403	    036F  60				 pusha
1   404	    0370  B9 0004			 mov	 cx, 4		 ; 8 hex digits
1   405	    0373			 print_digit:
1   406	    0373  C1 C2	04			 rol	 dx, 4		 ; rotate so that lowest 4 bits	are used
1   407	    0376  B8 0E0F			 mov	 ax, 0e0fh	 ; ah =	request, al = mask for nybble
1   408	    0379  22 C2				 and	 al, dl
1   409	    037B  04 90				 add	 al, 090h	 ; convert al to ascii hex (four instructions)
1   410	    037D  27				 daa
1   411	    037E  14 40				 adc	 al, 040h
1   412	    0380  27				 daa
1   413	    0381  53				 push	 bx	 ;;;;;;;;;;;;;
1   414	    0382  8A 1E	3989r			 mov	 bl,VideoAtribut ;;;;;;;;;;;;;
1   415	    0386  CD 10				 int	 10h
1   416	    0388  5B				 pop	 bx	 ;;;;;;;;;;;;;
1   417	    0389  E2 E8				 loop	 print_digit
1   418	    038B  61				 popa
1   419	    038C  C3				 ret
1   420	    038D			 Print_Hex	 endp
1   421
1   422					 ; Routine to print asciiz-string at DS:SI
1   423	    038D			 PrtStr	 Proc
1   424	    038D  60				 pusha
1   425	    038E  AC			 PS_2:	 lodsb
1   426	    038F  3C 00				 cmp	 al,00h
1   427	    0391  74 07	90 90			 jz	 fin
1   428	    0395  E8 0004			 call	 prtchr
1   429	    0398  EB F4				 jmp	 PS_2
1   430	    039A			 fin:
1   431	    039A  61				 popa
1   432	    039B  C3				 ret
1   433	    039C			 PrtStr	 endp
1   434
1   435					 ; Part	of above routine, this one just	prints ascii al
1   436	    039C			 prtchr	 proc
1   437	    039C  60				 pusha
1   438	    039D  8A 3E	3988r			 mov	 bh, VideoStranka
1   439	    03A1  B9 0001			 mov	 cx, 01h
1   440	    03A4  B4 0E				 mov	 ah, 0eh
1   441	    03A6  53				 push	 bx	 ;;;;;;;;;;;;;
1   442	    03A7  8A 1E	3989r			 mov	 bl, VideoAtribut	 ;;;;;;;;;;;;;
1   443	    03AB  CD 10				 int	 10h
1   444	    03AD  5B				 pop	 bx	 ;;;;;;;;;;;;;
1   445	    03AE  61				 popa
1   446	    03AF  C3				 ret
1   447	    03B0			 prtchr	 endp
1   448
1   449					 ; Routine to print asciiz-string at DS:SI
1   450	    03B0			 PrtColorStr	 Proc
1   451	    03B0  60				 pusha
1   452	    03B1  AC			 PS__2:	 lodsb
1   453	    03B2  3C 00				 cmp	 al,00h
1   454	    03B4  74 E4				 jz	 fin
1   455	    03B6  E8 000A			 call	 PrtColorChr
1   456	    03B9  E8 00F3			 call	 WhereXY
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 9
setup.asm



1   457	    03BC  FE C2				 inc	 dl
1   458	    03BE  E8 00FC			 call	 GotoXY
1   459	    03C1  EB EE				 jmp	 PS__2
1   460	    03C3			 PrtColorStr	 endp
1   461
1   462					 ; Part	of above routine, this one just	prints ascii al	! nepoposune kurzor
1   463	    03C3			 PrtColorChr	 proc
1   464	    03C3  60				 pusha
1   465	    03C4  8A 1E	3989r			 mov	 bl, VideoAtribut
1   466	    03C8  8A 3E	3988r			 mov	 bh, VideoStranka
1   467	    03CC  B9 0001			 mov	 cx,01h
1   468	    03CF  B4 09				 mov	 ah,09h
1   469	    03D1  CD 10				 int	 10h
1   470	    03D3  61				 popa
1   471	    03D4  C3				 ret
1   472	    03D5			 PrtColorChr	 endp
1   473
1   474	    03D5			 GET_EXT_MEM_SIZE	 proc
1   475					 ; Get memory size (extended mem, kB)
1   476	    03D5  B8 8800			 mov	 ax,08800h
1   477	    03D8  CD 15				 int	 15h
1   478	    03DA  A3 3BB0r			 mov	 EXT_MEM_SIZE,ax
1   479	    03DD  C3				 ret
1   480	    03DE			 Get_Ext_Mem_Size	 endp
1   481
1   482	    03DE			 MOUSE_CHECK	 proc
1   483					 ; Check for PS/2 pointing device
1   484					 ;	 mov	 ax,cs		 ; aka #SETUPSEG
1   485					 ;	 sub	 ax,#DELTA_INITSEG ; aka #INITSEG
1   486					 ;	 mov	 ds,ax
1   487	    03DE  C7 06	3BB2r 0000		 mov	 MOUSE_PRESENT,0 ; default is no pointing device
1   488	    03E4  CD 11				 int	 11h		 ; int 0x11: equipment determination
1   489	    03E6  A8 04				 test	 al,04h		 ; check if pointing device installed
1   490	    03E8  74 08	90 90			 jz	 no_psmouse
1   491	    03EC  C7 06	3BB2r 00AA		 mov	 MOUSE_PRESENT,0aah	 ; device present
1   492	    03F2			 no_psmouse:
1   493	    03F2  C3				 ret
1   494	    03F3			 Mouse_Check	 endp
1   495
1   496	    03F3			 APM_BIOS_CHECK	 proc
1   497	    03F3  C7 06	3BB4r 0000		 mov	 APM_BIOS_VER,0	 ; version == 0	means no APM BIOS
1   498	    03F9  B8 5300			 mov	 ax,05300h	 ; APM BIOS installation check
1   499	    03FC  33 DB				 xor	 bx,bx
1   500	    03FE  CD 15				 int	 15h
1   501	    0400  72 33	90 90			 jc	 done_apm_bios	 ; error -> no APM BIOS
1   502	    0404  81 FB	504D			 cmp	 bx,0504dh	 ; check for "PM" signature
1   503	    0408  75 2B	90 90			 jne	 done_apm_bios	 ; no signature	-> no APM BIOS
1   504	    040C  A3 3BB4r			 mov	 APM_BIOS_VER,ax ; record the APM BIOS version
1   505	    040F  89 0E	3BB6r			 mov	 APM_BIOS_FLAGS,cx	 ;	 and flags
1   506	    0413  83 E1	02			 and	 cx,02h		 ; Is 32 bit supported?
1   507	    0416  74 1D	90 90			 je	 done_apm_bios	 ;	 no ...
1   508	    041A  B8 5304			 mov	 ax,05304h	 ; Disconnect first just in case
1   509	    041D  33 DB				 xor	 bx,bx
1   510	    041F  CD 15				 int	 15h		 ; ignore return code
1   511	    0421  B8 5303			 mov	 ax,05303h	 ; 32 bit connect
1   512	    0424  33 DB				 xor	 bx,bx
1   513	    0426  CD 15				 int	 15h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 10
setup.asm



1   514	    0428  72 05	90 90			 jc	 no_32_apm_bios	 ; error
1   515					 ;	 mov	 [66],ax	 ; BIOS	code segment
1   516					 ;	 mov	 [68],ebx	 ; BIOS	entry point offset
1   517					 ;	 mov	 [72],cx	 ; BIOS	16 bit code segment
1   518					 ;	 mov	 [74],dx	 ; BIOS	data segment
1   519					 ;	 mov	 [78],si	 ; BIOS	code segment length
1   520					 ;	 mov	 [80],di	 ; BIOS	data segment length
1   521	    042C  EB 07	90			 jmp	 done_apm_bios
1   522	    042F			 no_32_apm_bios:
1   523	    042F  81 26	3BB6r FFFD		 and	 APM_BIOS_FLAGS,0fffdh	 ; remove 32 bit support bit
1   524	    0435			 done_apm_bios:
1   525	    0435  C3				 ret
1   526	    0436			 APM_BIOS_CHECK	 endp
1   527
1   528					 ;ENABLE_A20	 proc
1   529					 ; that	was painless, now we enable A20
1   530					 ;	 call	 empty_8042
1   531					 ;	 mov	 al,0D1h	 ; command write
1   532					 ;	 out	 64h,al
1   533					 ;	 call	 empty_8042
1   534					 ;	 mov	 al,0DFh	 ; A20 on
1   535					 ;	 out	 60h,al
1   536					 ;	 call	 empty_8042
1   537					 ; make	sure any possible coprocessor is properly reset..
1   538					 ;	 xor	 ax,ax
1   539					 ;	 out	 0f0h,al
1   540					 ;	 call	 delay
1   541					 ;	 out	 0f1h,al
1   542					 ;	 call	 delay
1   543					 ;	 ret
1   544					 ;empty_8042:
1   545					 ;	 call	 delay
1   546					 ;	 in	 al,64h		 ; 8042	status port
1   547					 ;	 test	 al,1		 ; output buffer?
1   548					 ;	 jz	 no_output
1   549					 ;	 call	 delay
1   550					 ;	 in	 al,60h		 ; read	it
1   551					 ;	 jmp	 empty_8042
1   552					 ;no_output:
1   553					 ;	 test	 al,2		 ; is input buffer full?
1   554					 ;	 jnz	 empty_8042	 ; yes - loop
1   555					 ;	 ret
1   556					 ;delay:
1   557					 ;	 dw	 00ebh			 ; jmp $+2
1   558					 ;	 ret
1   559					 ;ENABLE_A20	 endp
1   560
1   561	    0436			 Int_Bak Proc
1   562	    0436  B0 13				 mov	 al,13h
1   563	    0438  E8 FEF2			 Call	 Cti_Int_Vec
1   564	    043B  2E: 89 1E 3BC0r		 mov	 word ptr cs:[OldInts.OFS_13],bx
1   565	    0440  2E: 8C 06 3BC2r		 mov	 word ptr cs:[OldInts.SEG_13],es
1   566	    0445  B0 00				 mov	 al,00h
1   567	    0447  E8 FEE3			 Call	 Cti_Int_Vec
1   568	    044A  2E: 89 1E 3BB8r		 mov	 word ptr cs:[OldInts.OFS_00],bx
1   569	    044F  2E: 8C 06 3BBAr		 mov	 word ptr cs:[OldInts.SEG_00],es
1   570	    0454  B0 09				 mov	 al,9h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 11
setup.asm



1   571	    0456  E8 FED4			 Call	 Cti_Int_Vec
1   572	    0459  2E: 89 1E 3BBCr		 mov	 word ptr cs:[OldInts.OFS_09],bx
1   573	    045E  2E: 8C 06 3BBEr		 mov	 word ptr cs:[OldInts.SEG_09],es
1   574	    0463  B0 16				 mov	 al,16h
1   575	    0465  E8 FEC5			 Call	 Cti_Int_Vec
1   576	    0468  2E: 89 1E 3BC4r		 mov	 word ptr cs:[OldInts.OFS_16],bx
1   577	    046D  2E: 8C 06 3BC6r		 mov	 word ptr cs:[OldInts.SEG_16],es
1   578	    0472  B0 20				 mov	 al,20h
1   579	    0474  E8 FEB6			 Call	 Cti_Int_Vec
1   580	    0477  2E: 89 1E 3BC8r		 mov	 word ptr cs:[OldInts.OFS_20],bx
1   581	    047C  2E: 8C 06 3BCAr		 mov	 word ptr cs:[OldInts.SEG_20],es
1   582	    0481  B0 21				 mov	 al,21h
1   583	    0483  E8 FEA7			 Call	 Cti_Int_Vec
1   584	    0486  2E: 89 1E 3BCCr		 mov	 word ptr cs:[OldInts.OFS_21],bx
1   585	    048B  2E: 8C 06 3BCEr		 mov	 word ptr cs:[OldInts.SEG_21],es
1   586	    0490  B0 22				 mov	 al,22h
1   587	    0492  E8 FE98			 Call	 Cti_Int_Vec
1   588	    0495  2E: 89 1E 3BD0r		 mov	 word ptr cs:[OldInts.OFS_22],bx
1   589	    049A  2E: 8C 06 3BD2r		 mov	 word ptr cs:[OldInts.SEG_22],es
1   590	    049F  B0 2F				 mov	 al,2Fh
1   591	    04A1  E8 FE89			 Call	 Cti_Int_Vec
1   592	    04A4  2E: 89 1E 3BD4r		 mov	 word ptr cs:[OldInts.OFS_2F],bx
1   593	    04A9  2E: 8C 06 3BD6r		 mov	 word ptr cs:[OldInts.SEG_2F],es
1   594	    04AE  C3				 ret
1   595	    04AF			 Int_Bak endp
1   596
1   597	    04AF			 WhereXY proc
1   598	    04AF  50				 push	 ax
1   599	    04B0  53				 push	 bx
1   600	    04B1  B8 0300			 mov	 ax, 0300h
1   601	    04B4  8A 3E	3988r			 mov	 bh, VideoStranka
1   602	    04B8  CD 10				 int	 10h
1   603	    04BA  5B				 pop	 bx
1   604	    04BB  58				 pop	 ax
1   605	    04BC  C3				 ret
1   606					 ;DL=sloupec
1   607					 ;DH=ý dek
1   608	    04BD			 WhereXY endp
1   609
1   610	    04BD			 GotoXY	 proc
1   611					 ;DL=sloupec
1   612					 ;DH=ý dek
1   613	    04BD  60				 pusha
1   614	    04BE  B8 0200			 mov	 ax, 0200h
1   615	    04C1  8A 3E	3988r			 mov	 bh, VideoStranka
1   616	    04C5  CD 10				 int	 10h
1   617	    04C7  61				 popa
1   618	    04C8  C3				 ret
1   619	    04C9			 GotoXY	 endp
1   620
1   621	    04C9			 ClrScr	 proc
1   622	    04C9  60				 pusha
1   623	    04CA  BA 0000			 mov	 dx, 0000h
1   624	    04CD  E8 FFED			 call	 GotoXY
1   625	    04D0  8A 1E	3989r			 mov	 bl, VideoAtribut
1   626	    04D4  8A 3E	3988r			 mov	 bh, VideoStranka
1   627	    04D8  B0 20				 mov	 al, 32
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 12
setup.asm



1   628	    04DA  B9 1F40			 mov	 cx,8000
1   629	    04DD  B4 09				 mov	 ah, 09
1   630	    04DF  CD 10				 int	 10h
1   631	    04E1  61				 popa
1   632	    04E2  C3				 ret
1   633	    04E3			 ClrScr	 endp
1   634
1   635					 ;DS:SI=ukazatel na ýetØtec ukonŸenì 00h
1   636					 ;->CX=poŸet znak… vŸetnØ 00h
1   637	    04E3			 LengthString	 proc
1   638	    04E3  33 C9				 xor	 cx,cx
1   639	    04E5			 LS_:
1   640	    04E5  AC				 LODSB
1   641	    04E6  41				 inc	 cx
1   642	    04E7  3C 00				 cmp	 al, 00h
1   643	    04E9  74 04	90 90			 je	 LS_EX_
1   644	    04ED  EB F6				 jmp	 LS_
1   645	    04EF			 LS_EX_:
1   646	    04EF  C3				 ret
1   647	    04F0			 LengthString	 endp
1   648
1   649					 ;DS:SI=ukazatel na form tovanì	ýetØtec	ukonŸenì 00h
1   650					 ;ES:DI=ukazatel na c¡lovì ýetØtec
1   651					 ;BX:DX=ukazatel na ýetØtec paramer… + 00h
1   652	    04F0			 FormatString	 proc
1   653	    04F0  06				 push	 es
1   654	    04F1  57				 push	 di
1   655	    04F2  FC				 cld
1   656	    04F3			 FS_1:
1   657	    04F3  AC				 LODSB
1   658	    04F4  3C 25				 cmp	 al, "%"
1   659	    04F6  74 19	90 90			 je	 FS_PARAM
1   660	    04FA  3C 00				 cmp	 al, 00h
1   661	    04FC  74 05	90 90			 je	 FS_EXIT
1   662	    0500			 FS_2:
1   663	    0500  AA				 STOSB
1   664	    0501  EB F0				 jmp	 FS_1
1   665	    0503			 FS_EXIT:
1   666	    0503  B0 00				 mov	 al, 00h
1   667	    0505  AA				 STOSB
1   668	    0506  5F				 pop	 di
1   669	    0507  07				 pop	 es
1   670	    0508  C3				 ret
1   671	    0509			 FS_3:
1   672	    0509  8C DB				 mov	 bx, ds
1   673	    050B  8B D6				 mov	 dx, si
1   674	    050D  5E				 pop	 si
1   675	    050E  1F				 pop	 ds
1   676	    050F  EB E2				 jmp	 FS_1
1   677	    0511			 FS_PARAM:
1   678	    0511  AC				 LODSB
1   679	    0512  3C 25				 cmp	 al, "%"
1   680	    0514  74 EA				 je	 FS_2
1   681	    0516  4E				 dec	 si
1   682	    0517  1E				 push	 ds
1   683	    0518  56				 push	 si
1   684	    0519  8E DB				 mov	 ds, bx
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 13
setup.asm



1   685	    051B  8B F2				 mov	 si, dx
1   686					 ;	 cmp	 al, 00h
1   687					 ;	 je	 FS_EXIT
1   688	    051D			 FS_4:
1   689	    051D  AC				 LODSB
1   690	    051E  3C 00				 cmp	 al, 00h
1   691	    0520  74 E7				 je	 FS_3
1   692	    0522  AA				 STOSB
1   693	    0523  EB F8				 jmp	 FS_4
1   694	    0525			 FormatString	 endp
1   695
1   696					 ;------------------------------
1   697	    0525			 Wait30sForPressK	 proc
1   698					 ; Read	a key with a timeout of	30 seconds. The	hardware clock is used to get
1   699					 ; the time.
1   700					 ;------------------------------
1   701	    0525  E8 0039			 call	 FlushKbd
1   702	    0528  E8 0023			 call	 gettime
1   703	    052B  04 1E				 add	 al,30		 ; Wait	30 seconds
1   704	    052D  3C 3C				 cmp	 al,60
1   705	    052F  7C 04	90 90			 jl	 lminute
1   706	    0533  2C 3C				 sub	 al,60
1   707	    0535			 lminute:
1   708	    0535  8A C8				 mov	 cl,al
1   709	    0537  B4 01			 again:	 mov	 ah,01
1   710	    0539  CD 16				 int	 16h
1   711	    053B  75 0C	90 90			 jnz	 getkey		 ; key pressed,	so get it
1   712	    053F  E8 000C			 call	 gettime
1   713					 ;	 cmp	 al,cl
1   714					 ;	 push	 ax
1   715					 ;	 push	 cx
1   716					 ;	 sub	 cl, al
1   717					 ;	 xchg	 al, cl
1   718					 ;	 call	 WhereXY
1   719					 ;	 call	 PrtDec
1   720					 ;	 call	 GotoXY
1   721					 ;	 pop	 cx
1   722					 ;	 pop	 ax
1   723	    0542  3A C1				 cmp	 al, cl
1   724	    0544  75 F1				 jne	 again
1   725	    0546  B0 20				 mov	 al,20h		 ; timeout, return default char	`space'
1   726	    0548  C3				 ret
1   727	    0549  32 E4			 getkey: xor	 ah,ah
1   728	    054B  CD 16				 int	 16h
1   729	    054D  C3				 ret
1   730	    054E			 Wait30sForPressK	 endp
1   731
1   732					 ;--------------------------
1   733	    054E			 GetTime proc
1   734					 ; Read	the cmos clock.	Return the seconds in al
1   735					 ;--------------------------
1   736	    054E  51				 push	 cx
1   737	    054F  B4 02				 mov	 ah,02
1   738	    0551  CD 1A				 int	 1Ah
1   739	    0553  8A C6				 mov	 al,dh			 ; dh contains the seconds
1   740	    0555  24 0F				 and	 al,0fh
1   741	    0557  8A E6				 mov	 ah,dh
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 14
setup.asm



1   742	    0559  B1 04				 mov	 cl,04
1   743	    055B  D2 EC				 shr	 ah,cl
1   744	    055D  D5 0A				 aad
1   745	    055F  59				 pop	 cx
1   746	    0560  C3				 ret
1   747	    0561			 GetTime endp
1   748
1   749					 ;-------------------------
1   750	    0561			 FlushKbd	 proc
1   751					 ; Flush the keyboard buffer
1   752					 ;-------------------------
1   753	    0561  66| 60			 pushad
1   754	    0563			 FlushKbd_:
1   755	    0563  B4 01				 mov	 ah,01
1   756	    0565  CD 16				 int	 16h
1   757	    0567  74 08	90 90			 jz	 empty
1   758	    056B  32 E4				 xor	 ah,ah
1   759	    056D  CD 16				 int	 16h
1   760	    056F  EB F2				 jmp	 FlushKbd_
1   761	    0571			 empty:
1   762	    0571  66| 61			 popad
1   763	    0573  C3				 ret
1   764	    0574			 FlushKbd	 endp
1   765
1   766					 ;---------------------------
1   767					 ; Print decimal number	(AL).
1   768					 ;---------------------------
1   769
1   770	    0574  50			 prtdec: push	 ax
1   771	    0575  51				 push	 cx
1   772	    0576  32 E4				 xor	 ah,ah
1   773	    0578  B1 0A				 mov	 cl,0Ah
1   774	    057A  F6 F9				 idiv	 cl
1   775	    057C  3C 09				 cmp	 al,09h
1   776	    057E  76 08	90 90			 jbe	 lt100
1   777	    0582  E8 FFEF			 call	 prtdec
1   778	    0585  EB 06	90			 jmp	 skip10
1   779	    0588  04 30			 lt100:	 add	 al,30h
1   780	    058A  E8 FE0F			 call	 prtchr
1   781	    058D  8A C4			 skip10: mov	 al,ah
1   782	    058F  04 30				 add	 al,30h
1   783	    0591  E8 FE08			 call	 prtchr
1   784	    0594  59				 pop	 cx
1   785	    0595  58				 pop	 ax
1   786	    0596  C3				 ret
1   787
    788					 include .\DiskIO.asm
1   789	    0597			 Int13	 proc
1   790	    0597  EB 1E	90			 jmp	 DD_D
1   791	    059A			 KONEC:
1   792	    059A  FA				 cli
1   793	    059B  1F				 pop	 ds
1   794	    059C  5D				 pop	 BP
1   795	    059D  07				 pop	 ES
1   796	    059E  1F				 pop	 DS
1   797	    059F  5F				 pop	 DI
1   798	    05A0  5E				 pop	 SI
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 15
setup.asm



1   799	    05A1  5A				 pop	 DX
1   800	    05A2  59				 pop	 CX
1   801	    05A3  5B				 pop	 BX
1   802	    05A4  58				 pop	 AX
1   803	    05A5  FB				 sti
1   804	    05A6  CF				 iret
1   805	    05A7			 NV_:
1   806	    05A7  2E: C6 06 3BAAr 30		 mov	 byte ptr cs:[NV],'0'
1   807	    05AD  EB EB				 jmp	 konec
1   808	    05AF			 NV__:
1   809	    05AF  2E: C6 06 3BAAr 31		 mov	 byte ptr cs:[NV],'1'
1   810	    05B5  EB E3				 jmp	 konec
1   811	    05B7			 DD_D:
1   812	    05B7  FA				 cli
1   813	    05B8  50				 push	 AX
1   814	    05B9  53				 push	 BX
1   815	    05BA  51				 push	 CX
1   816	    05BB  52				 push	 DX
1   817	    05BC  56				 push	 SI
1   818	    05BD  57				 push	 DI
1   819	    05BE  1E				 push	 DS
1   820	    05BF  06				 push	 ES
1   821	    05C0  55				 push	 BP
1   822	    05C1  1E				 push	 ds
1   823	    05C2  0E				 push	 cs
1   824	    05C3  1F				 pop	 ds
1   825	    05C4  FB				 sti
1   826
1   827	    05C5  2E: A3 3BA2r			 mov	 word ptr cs:[Old13._AX], AX
1   828	    05C9  2E: 89 1E 3BA4r		 mov	 word ptr cs:[Old13._BX], BX
1   829	    05CE  2E: 89 0E 3BA6r		 mov	 word ptr cs:[Old13._CX], CX
1   830	    05D3  2E: 89 16 3BA8r		 mov	 word ptr cs:[Old13._DX], DX
1   831
1   832	    05D8  8A C4				 mov	 al,ah	 ;zaka§	zobrazen¡
1   833	    05DA  3C EE				 cmp	 al,0EEh ;
1   834	    05DC  74 C9				 je	 NV_
1   835	    05DE  8A C4				 mov	 al,ah	 ;povol	zobrazen¡
1   836	    05E0  3C EF				 cmp	 al,0EFh ;
1   837	    05E2  74 CB				 je	 NV__
1   838	    05E4  2E: A0 3BAAr			 mov	 al,byte ptr cs:[NV]
1   839	    05E8  3C 30				 cmp	 al,'0'
1   840	    05EA  74 69	90 90			 je	 DAL_
1   841	    05EE  2E: C6 06 3B9Br 20		 mov	 byte ptr cs:[DISK+1],'	'
1   842	    05F4  8A C2				 mov	 al,dl
1   843	    05F6  3C 00				 cmp	 al,00	 ;A:
1   844	    05F8  74 37	90 90			 je	 DDA__
1   845	    05FC  3C 01				 cmp	 al,01	 ;B:
1   846	    05FE  74 34	90 90			 je	 DDB__
1   847	    0602  3C 80				 cmp	 al,80h	 ;HD0:
1   848	    0604  74 31	90 90			 je	 DDC__
1   849	    0608  3C 81				 cmp	 al,81h	 ;HD1:
1   850	    060A  74 2E	90 90			 je	 DDD__
1   851	    060E			 DDAL:
1   852	    060E  2E: C6 06 3B9Ar 20		 mov	 byte ptr cs:[DISK],' '
1   853	    0614  8A C4				 mov	 al,ah
1   854	    0616  3C 02				 cmp	 al,02	 ;Ÿten¡
1   855	    0618  74 59	90 90			 je	 C_
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 16
setup.asm



1   856	    061C  3C 03				 cmp	 al,03	 ;z pis
1   857	    061E  74 5B	90 90			 je	 Z_
1   858	    0622  3C 04				 cmp	 al,04	 ;verifikace
1   859	    0624  74 5D	90 90			 je	 V_
1   860	    0628  3C 05				 cmp	 al,05	 ;form tov n¡
1   861	    062A  74 5F	90 90			 je	 F_
1   862	    062E  EB 0D	90			 jmp	 DDAL1
1   863	    0631			 DDA__:
1   864	    0631  EB 60	90			 jmp	 DA_
1   865	    0634			 DDB__:
1   866	    0634  EB 66	90			 jmp	 DB_
1   867	    0637			 DDC__:
1   868	    0637  EB 6C	90			 jmp	 DC_
1   869	    063A			 DDD__:
1   870	    063A  EB 72	90			 jmp	 DD_
1   871	    063D			 DDAL1:
1   872	    063D  8C C8				 mov	 AX,cs ;Disk
1   873	    063F  8E C0				 mov	 ES,AX
1   874	    0641  BD 3B9Ar			 mov	 BP,offset cs:[Disk]
1   875	    0644  B9 0002			 mov	 CX,2
1   876	    0647  B7 00				 mov	 BH,00h
1   877	    0649  B3 7F				 mov	 BL,(16*7)+0Fh
1   878	    064B  B6 00				 mov	 DH,0
1   879	    064D  B2 4E				 mov	 DL,78
1   880	    064F  B4 13				 mov	 AH,13h
1   881	    0651  B0 00				 mov	 AL,00h
1   882	    0653  CD 10				 Int	 10h
1   883
1   884	    0655			 DAL_:
1   885					 ;	 push	 ds
1   886					 ;	 mov	 ax,0040h
1   887					 ;	 mov	 ds,ax
1   888					 ;	 mov	 ax,word ptr cs:[Disk]
1   889					 ;	 mov	 word ptr ds:[00F0h],ax
1   890					 ;	 pop	 ds
1   891
1   892	    0655  FA				 cli
1   893	    0656  1F				 pop	 ds
1   894	    0657  5D				 pop	 BP
1   895	    0658  07				 pop	 ES
1   896	    0659  1F				 pop	 DS
1   897	    065A  5F				 pop	 DI
1   898	    065B  5E				 pop	 SI
1   899	    065C  5A				 pop	 DX
1   900	    065D  59				 pop	 CX
1   901	    065E  5B				 pop	 BX
1   902	    065F  58				 pop	 AX
1   903	    0660  FB				 sti
1   904	    0661  9C				 pushf
1   905	    0662  2E: FF 1E 3BC0r		 call	 dword ptr cs:[OldInts.OFS_13]
1   906	    0667  72 4E	90 90			 jc	 error
1   907	    066B  80 FC	00			 cmp	 ah, 00
1   908	    066E  75 47	90 90			 jne	 error
1   909	    0672  CF				 iret
1   910	    0673			 C_:
1   911	    0673  2E: C6 06 3B9Ar 3C		 mov	 byte ptr cs:[DISK],'<'
1   912	    0679  EB C2				 jmp	 DDAL1
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 17
setup.asm



1   913	    067B			 Z_:
1   914	    067B  2E: C6 06 3B9Ar 3E		 mov	 byte ptr cs:[DISK],'>'
1   915	    0681  EB BA				 jmp	 DDAL1
1   916	    0683			 V_:
1   917	    0683  2E: C6 06 3B9Ar 23		 mov	 byte ptr cs:[DISK],'#'
1   918	    0689  EB B2				 jmp	 DDAL1
1   919	    068B			 F_:
1   920	    068B  2E: C6 06 3B9Ar 04		 mov	 byte ptr cs:[DISK],''
1   921	    0691  EB AA				 jmp	 DDAL1
1   922	    0693			 DA_:
1   923	    0693  2E: C6 06 3B9Br 41		 mov	 byte ptr cs:[DISK+1],'A'
1   924	    0699  E9 FF72			 jmp	 DDAL
1   925	    069C			 DB_:
1   926	    069C  2E: C6 06 3B9Br 42		 mov	 byte ptr cs:[DISK+1],'B'
1   927	    06A2  E9 FF69			 jmp	 DDAL
1   928	    06A5			 DC_:
1   929	    06A5  2E: C6 06 3B9Br 43		 mov	 byte ptr cs:[DISK+1],'C'
1   930	    06AB  E9 FF60			 jmp	 DDAL
1   931	    06AE			 DD_:
1   932	    06AE  2E: C6 06 3B9Br 44		 mov	 byte ptr cs:[DISK+1],'D'
1   933	    06B4  E9 FF57			 jmp	 DDAL
1   934	    06B7			 Error:
1   935	    06B7  FA				 cli
1   936	    06B8  50				 push	 AX
1   937	    06B9  53				 push	 BX
1   938	    06BA  51				 push	 CX
1   939	    06BB  52				 push	 DX
1   940	    06BC  56				 push	 SI
1   941	    06BD  57				 push	 DI
1   942	    06BE  1E				 push	 DS
1   943	    06BF  06				 push	 ES
1   944	    06C0  55				 push	 BP
1   945	    06C1  1E				 push	 ds
1   946
1   947	    06C2  50				 push	 ax
1   948	    06C3  1E				 push	 ds
1   949	    06C4  0E				 push	 cs
1   950	    06C5  1F				 pop	 ds
1   951	    06C6  FB				 sti
1   952
1   953	    06C7  52				 push	 dx
1   954	    06C8  56				 push	 si
1   955	    06C9  E8 FDFD			 call	 ClrScr
1   956	    06CC  BA 0607			 mov	 dx, 0607h
1   957	    06CF  E8 FDEB			 call	 GotoXY
1   958	    06D2  BE 2C3Fr			 lea	 si, PrintDiskError
1   959	    06D5  E8 FCB5			 call	 PrtStr
1   960	    06D8  BA 1032			 mov	 dx, 1032h
1   961	    06DB  E8 FDDF			 call	 GotoXY
1   962	    06DE  5E				 pop	 si
1   963	    06DF  8B D6				 mov	 dx,si
1   964	    06E1  E8 FC8B			 call	 Print_Hex
1   965	    06E4  BA 0E32			 mov	 dx, 0E32h
1   966	    06E7  E8 FDD3			 call	 GotoXY
1   967	    06EA  5A				 pop	 dx
1   968	    06EB  E8 FC81			 call	 Print_Hex
1   969	    06EE  BA 0D32			 mov	 dx, 0D32h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 18
setup.asm



1   970	    06F1  E8 FDC9			 call	 GotoXY
1   971	    06F4  8B D1				 mov	 dx, cx
1   972	    06F6  E8 FC76			 call	 Print_Hex
1   973	    06F9  BA 0C32			 mov	 dx, 0C32h
1   974	    06FC  E8 FDBE			 call	 GotoXY
1   975	    06FF  8B D3				 mov	 dx, bx
1   976	    0701  E8 FC6B			 call	 Print_Hex
1   977	    0704  BA 0B32			 mov	 dx, 0B32h
1   978	    0707  E8 FDB3			 call	 GotoXY
1   979	    070A  8B D0				 mov	 dx, ax
1   980	    070C  E8 FC60			 call	 Print_Hex
1   981	    070F  BA 0F32			 mov	 dx, 0F32h
1   982	    0712  E8 FDA8			 call	 GotoXY
1   983	    0715  8B D5				 mov	 dx, bp
1   984	    0717  E8 FC55			 call	 Print_Hex
1   985	    071A  BA 0B42			 mov	 dx, 0B42h
1   986	    071D  E8 FD9D			 call	 GotoXY
1   987	    0720  8B D7				 mov	 dx, di
1   988	    0722  E8 FC4A			 call	 Print_Hex
1   989	    0725  BA 0C42			 mov	 dx, 0C42h
1   990	    0728  E8 FD92			 call	 GotoXY
1   991	    072B  1F				 pop	 ds
1   992	    072C  8C DA				 mov	 dx, ds
1   993	    072E  0E				 push	 cs
1   994	    072F  1F				 pop	 ds
1   995	    0730  E8 FC3C			 call	 Print_Hex
1   996	    0733  BA 0D42			 mov	 dx, 0D42h
1   997	    0736  E8 FD84			 call	 GotoXY
1   998	    0739  8C C2				 mov	 dx, es
1   999	    073B  E8 FC31			 call	 Print_Hex
1  1000	    073E  BA 0E42			 mov	 dx, 0E42h
1  1001	    0741  E8 FD79			 call	 GotoXY
1  1002	    0744  9C				 pushf
1  1003	    0745  5A				 pop	 dx
1  1004	    0746  E8 FC26			 call	 Print_Hex
1  1005
1  1006	    0749  BA 0B17			 mov	 dx, 0B17h
1  1007	    074C  E8 FD6E			 call	 GotoXY
1  1008	    074F  2E: 8B 16 3BA8r		 mov	 dx, word ptr cs:[Old13._DX]
1  1009	    0754  32 F6				 xor	 dh, dh
1  1010	    0756  E8 FC16			 call	 Print_Hex
1  1011	    0759  BA 0C17			 mov	 dx, 0C17h
1  1012	    075C  E8 FD5E			 call	 GotoXY
1  1013	    075F  2E: 8B 0E 3BA6r		 mov	 cx, word ptr cs:[Old13._CX]
1  1014	    0764  81 E1	FFC0			 and	 cx, 1111111111000000B
1  1015	    0768  86 CD				 xchg	 cl, ch
1  1016	    076A  8B C1				 mov	 ax, cx
1  1017	    076C  32 ED				 xor	 ch, ch
1  1018	    076E  F6 C4	80			 test	 ah, 10000000B
1  1019	    0771  75 0C	90 90			 jnz	 I13_Ok1
1  1020	    0775			 I13_D1:
1  1021	    0775  F6 C4	40			 test	 ah, 01000000B
1  1022	    0778  75 0A	90 90			 jnz	 I13_Ok2
1  1023	    077C  EB 09	90			 jmp	 I13_D12
1  1024	    077F			 I13_Ok1:
1  1025	    077F  80 CD	02			 or	 ch, 00000010B
1  1026	    0782  EB F1				 jmp	 I13_D1
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 19
setup.asm



1  1027	    0784			 I13_Ok2:
1  1028	    0784  80 CD	01			 or	 ch, 00000001B
1  1029	    0787			 I13_D12:
1  1030	    0787  8B D1				 mov	 dx, cx
1  1031	    0789  E8 FBE3			 call	 Print_Hex
1  1032	    078C  BA 0D17			 mov	 dx, 0D17h
1  1033	    078F  E8 FD2B			 call	 GotoXY
1  1034	    0792  2E: 8B 0E 3BA6r		 mov	 cx, word ptr cs:[Old13._CX]
1  1035	    0797  32 ED				 xor	 ch, ch
1  1036	    0799  80 E1	3F			 and	 cl, 00111111B
1  1037	    079C  8B D1				 mov	 dx, cx
1  1038	    079E  E8 FBCE			 call	 Print_Hex
1  1039	    07A1  BA 0E17			 mov	 dx, 0E17h
1  1040	    07A4  E8 FD16			 call	 GotoXY
1  1041	    07A7  2E: 8B 16 3BA8r		 mov	 dx, word ptr cs:[Old13._DX]
1  1042	    07AC  32 D2				 xor	 dl, dl
1  1043	    07AE  86 F2				 xchg	 dh, dl
1  1044	    07B0  E8 FBBC			 call	 Print_Hex
1  1045	    07B3  BA 0F17			 mov	 dx, 0F17h
1  1046	    07B6  E8 FD04			 call	 GotoXY
1  1047	    07B9  2E: A1 3BA2r			 mov	 ax, word ptr cs:[Old13._AX]
1  1048	    07BD  32 E4				 xor	 ah, ah
1  1049	    07BF  8B D0				 mov	 dx, ax
1  1050	    07C1  E8 FBAB			 call	 Print_Hex
1  1051	    07C4  BA 1017			 mov	 dx, 1017h
1  1052	    07C7  E8 FCF3			 call	 GotoXY
1  1053	    07CA  2E: A1 3BA2r			 mov	 ax, word ptr cs:[Old13._AX]
1  1054	    07CE  32 C0				 xor	 al, al
1  1055	    07D0  86 E0				 xchg	 ah, al
1  1056	    07D2  8B D0				 mov	 dx, ax
1  1057	    07D4  E8 FB98			 call	 Print_Hex
1  1058
1  1059	    07D7  2E: A1 3BA2r			 mov	 ax, word ptr cs:[Old13._AX]
1  1060
1  1061	    07DB  3D 1C0A			 cmp	 ax, 1c0ah
1  1062	    07DE  74 24	90 90			 je	 I13_1c0a
1  1063	    07E2  3D 1C0B			 cmp	 ax, 1c0bh
1  1064	    07E5  74 23	90 90			 je	 I13_1c0b
1  1065	    07E9  3D 1C0C			 cmp	 ax, 1c0ch
1  1066	    07EC  74 22	90 90			 je	 I13_1c0c
1  1067	    07F0  3D 1C0E			 cmp	 ax, 1c0eh
1  1068	    07F3  74 21	90 90			 je	 I13_1c0e
1  1069
1  1070	    07F7  8B F8				 mov	 di, ax
1  1071	    07F9  86 E0				 xchg	 ah, al
1  1072	    07FB  03 FF				 add	 di, di
1  1073	    07FD  8B B5	2BCBr			 mov	 si, [di+Bios_Disk_Func]
1  1074	    0801  EB 16	90			 jmp	 I13_Dal
1  1075	    0804			 I13_1c0a:
1  1076	    0804  BE 274Dr			 lea	 si, DiskFunc_1c0A
1  1077	    0807  EB 10	90			 jmp	 I13_Dal
1  1078	    080A			 I13_1c0b:
1  1079	    080A  BE 2767r			 lea	 si, DiskFunc_1c0B
1  1080	    080D  EB 0A	90			 jmp	 I13_Dal
1  1081	    0810			 I13_1c0c:
1  1082	    0810  BE 277Fr			 lea	 si, DiskFunc_1c0C
1  1083	    0813  EB 04	90			 jmp	 I13_Dal
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 20
setup.asm



1  1084	    0816			 I13_1c0e:
1  1085	    0816  BE 2794r			 lea	 si, DiskFunc_1c0E
1  1086
1  1087	    0819			 I13_Dal:
1  1088	    0819  BA 071A			 mov	 dx, 071Ah
1  1089	    081C  E8 FC9E			 call	 GotoXY
1  1090	    081F  E8 FB6B			 call	 PrtStr
1  1091
1  1092	    0822  58				 pop	 ax
1  1093
1  1094	    0823  80 FC	AA			 cmp	 ah, 0aah
1  1095	    0826  74 5C	90 90			 je	 I13_E0aa
1  1096	    082A  80 FC	BB			 cmp	 ah, 0bbh
1  1097	    082D  74 5A	90 90			 je	 I13_E0bb
1  1098	    0831  80 FC	CC			 cmp	 ah, 0cch
1  1099	    0834  74 58	90 90			 je	 I13_E0cc
1  1100	    0838  80 FC	E0			 cmp	 ah, 0e0h
1  1101	    083B  74 56	90 90			 je	 I13_E0e0
1  1102	    083F  80 FC	FF			 cmp	 ah, 0ffh
1  1103	    0842  74 54	90 90			 je	 I13_E0ff
1  1104
1  1105	    0846  8B F8				 mov	 di, ax
1  1106	    0848  86 E0				 xchg	 ah, al
1  1107	    084A  03 FF				 add	 di, di
1  1108	    084C  8B B5	2C0Br			 mov	 si, [di+Bios_Disk_Error]
1  1109
1  1110	    0850			 I13_PERR:
1  1111	    0850  8C CB				 mov	 bx, cs
1  1112	    0852  BA 3B9Br			 mov	 dx, offset Disk+1
1  1113	    0855  BF 392Er			 lea	 di, TMPString
1  1114	    0858  0E				 push	 cs
1  1115	    0859  1F				 pop	 ds
1  1116	    085A  0E				 push	 cs
1  1117	    085B  07				 pop	 es
1  1118	    085C  E8 FC91			 call	 FormatString
1  1119	    085F  1E				 push	 ds
1  1120	    0860  06				 push	 es
1  1121	    0861  1F				 pop	 ds
1  1122	    0862  07				 pop	 es
1  1123					 ;	 xchg	 es, ds
1  1124	    0863  87 FE				 xchg	 di, si
1  1125	    0865  BA 0816			 mov	 dx, 0816h
1  1126	    0868  E8 FC52			 call	 GotoXY
1  1127	    086B  0E				 push	 cs
1  1128	    086C  1F				 pop	 ds
1  1129	    086D  BE 392Er			 lea	 si, TMPString
1  1130	    0870  E8 FB1A			 call	 PrtStr
1  1131
1  1132					 ;	 lea	 si, ENTER_MESS
1  1133					 ;	 call	 PrtStr
1  1134					 ;	 lea	 si, DiskIOErr
1  1135					 ;	 call	 PrtStr
1  1136					 ;	 lea	 si, Disk+1
1  1137					 ;	 call	 PrtStr
1  1138					 ;	 lea	 si, PressAnyK
1  1139					 ;	 call	 PrtStr
1  1140	    0873  33 C0				 xor	 ax,ax
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 21
setup.asm



1  1141	    0875  CD 16				 int	 16h
1  1142
1  1143					 ;	 mov	 dx, word ptr cs:[OldInts.OFS_13]
1  1144					 ;	 mov	 ds, word ptr cs:[OldInts.SEG_13]
1  1145					 ;	 mov	 al, 13h
1  1146					 ;	 Call	 Nastav_Int_Vec		 ;nast.	INT13h
1  1147
1  1148	    0877			 I13_konec:
1  1149	    0877  FA				 cli
1  1150	    0878  1F				 pop	 ds
1  1151	    0879  5D				 pop	 BP
1  1152	    087A  07				 pop	 ES
1  1153	    087B  1F				 pop	 DS
1  1154	    087C  5F				 pop	 DI
1  1155	    087D  5E				 pop	 SI
1  1156	    087E  5A				 pop	 DX
1  1157	    087F  59				 pop	 CX
1  1158	    0880  5B				 pop	 BX
1  1159	    0881  58				 pop	 AX
1  1160	    0882  FB				 sti
1  1161	    0883  CF				 iret
1  1162
1  1163	    0884			 I13_E0aa:
1  1164	    0884  BE 2ABDr			 lea	 si, DiskError_0aa
1  1165	    0887  EB C7				 jmp	 I13_PERR
1  1166	    0889			 I13_E0bb:
1  1167	    0889  BE 2AD9r			 lea	 si, DiskError_0bb
1  1168	    088C  EB C2				 jmp	 I13_PERR
1  1169	    088E			 I13_E0cc:
1  1170	    088E  BE 2B0Br			 lea	 si, DiskError_0cc
1  1171	    0891  EB BD				 jmp	 I13_PERR
1  1172	    0893			 I13_E0e0:
1  1173	    0893  BE 2B32r			 lea	 si, DiskError_0e0
1  1174	    0896  EB B8				 jmp	 I13_PERR
1  1175	    0898			 I13_E0ff:
1  1176	    0898  BE 2B65r			 lea	 si, DiskError_0ff
1  1177	    089B  EB B3				 jmp	 I13_PERR
1  1178	    089D			 int13	 endp
1  1179
1  1180	    089D			 VyplnExtBoot	 proc
1  1181	    089D  B6 00				 mov	 dh, 00h
1  1182	    089F  8A 16	3BAFr			 mov	 dl, BootFromDisk
1  1183	    08A3  BB 3BD8r			 mov	 bx, offset cs:ExtBoot.MajorVer
1  1184	    08A6  8C C8				 mov	 ax, cs
1  1185	    08A8  8E C0				 mov	 es, ax
1  1186	    08AA  B8 0201			 mov	 ax, 0201h
1  1187	    08AD  B9 0002			 mov	 cx, 0002h
1  1188	    08B0  CD 13				 int	 13h
1  1189	    08B2  72 0A	90 90			 jc	 VyplnEBerror
1  1190	    08B6  80 FC	00			 cmp	 ah, 00
1  1191	    08B9  75 03	90 90			 jne	 VyplnEBerror
1  1192	    08BD  C3				 ret
1  1193	    08BE			 VyplnEBerror:
1  1194	    08BE  BE 3B9Fr			 lea	 si, ENTER_MESS
1  1195	    08C1  E8 FAC9			 call	 PrtStr
1  1196	    08C4  BE 39B0r			 lea	 si, DiskIOErr
1  1197	    08C7  E8 FAC3			 call	 PrtStr
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 22
setup.asm



1  1198	    08CA  B0 0D				 mov	 al, 0Dh
1  1199	    08CC  E8 FACD			 call	 PrtChr
1  1200	    08CF  B0 0A				 mov	 al, 0Ah
1  1201	    08D1  E8 FAC8			 call	 PrtChr
1  1202	    08D4  BE 39D1r			 lea	 si, ReplaceDisk
1  1203	    08D7  E8 FAB3			 call	 PrtStr
1  1204	    08DA  BE 39E1r			 lea	 si, PressAnyK
1  1205	    08DD  E8 FAAD			 call	 PrtStr
1  1206	    08E0  33 C0				 xor	 ax,ax
1  1207	    08E2  CD 16				 int	 16h
1  1208	    08E4  CD 19				 int	 19h
1  1209	    08E6  C3				 ret
1  1210	    08E7			 VyplnExtBoot	 endp
1  1211
   1212					 include .\testcpu.asm
1  1213	    08E7			 TestFor8086	 proc
1  1214	    08E7  54					 push	 sp
1  1215	    08E8  58					 pop	 ax
1  1216	    08E9  3B E0					 cmp	 sp,ax
1  1217	    08EB  74 05	90 90				 je	 Not_8086
1  1218	    08EF  B0 00					 mov	 al, 0
1  1219	    08F1  C3					 ret
1  1220	    08F2			 Not_8086:
1  1221
1  1222					 ;Test for 80286.
1  1223	    08F2  9C					 pushf
1  1224	    08F3  58					 pop	 ax
1  1225	    08F4  0D 4000				 or	 ax, 4000h
1  1226	    08F7  50					 push	 ax
1  1227	    08F8  9D					 popf
1  1228	    08F9  9C					 pushf
1  1229	    08FA  58					 pop	 ax
1  1230	    08FB  A9 4000				 test	 ax, 4000h
1  1231	    08FE  75 05	90 90				 jnz	 Not_286
1  1232	    0902  B0 00					 mov	 al, 0
1  1233	    0904  C3					 ret
1  1234	    0905			 Not_286:
1  1235	    0905  B0 FF					 mov	 al, 0FFh
1  1236	    0907  C3					 ret
1  1237	    0908			 TestFor8086	 endp
1  1238
1  1239	    0908			 TestFor8087	 proc
1  1240	    0908  9B DB	E3			 finit
1  1241	    090B  C7 06	396Ar 5A5A		 mov	 fp_status, 5A5Ah
1  1242	    0911  DD 3E	396Ar			 fnstsw	 fp_status
1  1243	    0915  A1 396Ar			 mov	 ax, fp_status
1  1244	    0918  3C 00				 cmp	 al, 0
1  1245	    091A  75 16	90 90			 jne	 Not_87
1  1246	    091E  D9 3E	396Ar			 fnstcw	 fp_status
1  1247	    0922  A1 396Ar			 mov	 ax, fp_status
1  1248	    0925  25 103F			 and	 ax, 103Fh
1  1249	    0928  3D 003F			 cmp	 ax, 3Fh
1  1250	    092B  75 05	90 90			 jne	 Not_87
1  1251	    092F  B0 FF				 mov	 al, 0FFh
1  1252	    0931  C3				 ret
1  1253	    0932			 Not_87:
1  1254	    0932  B0 00				 mov	 al, 0h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 23
setup.asm



1  1255	    0934  C3				 ret
1  1256	    0935			 TestFor8087	 endp
1  1257
   1258					 include .\part.asm
1  1259	    0935			 DisksCheck	 proc
1  1260	    0935  BE 3ADAr			 lea	 si, _HD0
1  1261	    0938  BA 0080			 mov	 dx, 0080h
1  1262	    093B  E8 0020			 call	 DalsiD
1  1263
1  1264	    093E  BE 3AE9r			 lea	 si, _HD1
1  1265	    0941  BA 0081			 mov	 dx, 0081h
1  1266	    0944  E8 0017			 call	 DalsiD
1  1267
1  1268	    0947  BE 3AF8r			 lea	 si, _HD2
1  1269	    094A  BA 0082			 mov	 dx, 0082h
1  1270	    094D  E8 000E			 call	 DalsiD
1  1271
1  1272	    0950  BE 3B07r			 lea	 si, _HD3
1  1273	    0953  BA 0083			 mov	 dx, 0083h
1  1274	    0956  E8 0005			 call	 DalsiD
1  1275
1  1276	    0959  8C C8				 mov	 ax, cs
1  1277	    095B  8E D8				 mov	 ds, ax
1  1278	    095D  C3				 ret
1  1279	    095E			 DalsiD:
1  1280	    095E  E8 FA2C			 call	 prtstr
1  1281	    0961  BB 3F69r			 mov	 bx, offset cs:DiskData
1  1282	    0964  8C C8				 mov	 ax, cs
1  1283	    0966  8E C0				 mov	 es, ax
1  1284	    0968  B8 0201			 mov	 ax, 0201h
1  1285	    096B  B9 0001			 mov	 cx, 0001h
1  1286	    096E  CD 13				 int	 13h
1  1287	    0970  8C C8				 mov	 ax, cs
1  1288	    0972  8E D8				 mov	 ds, ax
1  1289	    0974  BE 3AC2r			 lea	 si, _Nenalezen
1  1290	    0977  72 14	90 90			 jc	 DNenalezen
1  1291	    097B  BE 3ACEr			 lea	 si, _Ok
1  1292	    097E  E8 FA0C			 call	 prtstr
1  1293	    0981  BE 3B9Fr			 lea	 si, ENTER_MESS
1  1294	    0984  E8 FA06			 call	 prtstr
1  1295	    0987  E8 002A			 call	 PartTable
1  1296	    098A  EB 0A	90			 jmp	 _Nalezen
1  1297	    098D			 DNenalezen:
1  1298	    098D  E8 F9FD			 call	 prtstr
1  1299	    0990  BE 3B9Fr			 lea	 si, ENTER_MESS
1  1300	    0993  E8 F9F7			 call	 prtstr
1  1301	    0996			 _Nalezen:
1  1302	    0996  BB 3F69r			 mov	 bx, offset cs:DiskData
1  1303	    0999  2E: C7 06 3972r 0000		 mov	 cs:[TMP], 00h
1  1304	    09A0  B9 0200			 mov	 cx, 512
1  1305	    09A3  33 C0				 xor	 ax,ax
1  1306	    09A5			 ClearDiskData:
1  1307	    09A5  2E: 8B 36 3B98r		 mov	 si, cs:[AdrObl]
1  1308	    09AA  89 00				 mov	 [bx][si], ax
1  1309	    09AC  2E: FF 06 3972r		 inc	 cs:[TMP]
1  1310	    09B1  E2 F2				 loop	 ClearDiskData
1  1311	    09B3  C3				 ret
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 24
setup.asm



1  1312	    09B4			 DisksCheck	 endp
1  1313
1  1314	    09B4			 PartTable	 proc
1  1315	    09B4  2E: C7 06 3B98r 01BE		 mov	 cs:[AdrObl], 1BEh
1  1316	    09BB  BE 3B16r			 lea	 si, _Oblast1
1  1317	    09BE  E8 0040			 call	 CheckPart
1  1318	    09C1  BE 3B9Fr			 lea	 si, ENTER_MESS
1  1319	    09C4  E8 F9C6			 call	 prtstr
1  1320
1  1321	    09C7  2E: C7 06 3B98r 01CE		 mov	 cs:[AdrObl], 1CEh
1  1322	    09CE  BE 3B27r			 lea	 si, _Oblast2
1  1323	    09D1  E8 002D			 call	 CheckPart
1  1324	    09D4  BE 3B9Fr			 lea	 si, ENTER_MESS
1  1325	    09D7  E8 F9B3			 call	 prtstr
1  1326
1  1327	    09DA  2E: C7 06 3B98r 01DE		 mov	 cs:[AdrObl], 1DEh
1  1328	    09E1  BE 3B38r			 lea	 si, _Oblast3
1  1329	    09E4  E8 001A			 call	 CheckPart
1  1330	    09E7  BE 3B9Fr			 lea	 si, ENTER_MESS
1  1331	    09EA  E8 F9A0			 call	 prtstr
1  1332
1  1333	    09ED  2E: C7 06 3B98r 01EE		 mov	 cs:[AdrObl], 1EEh
1  1334	    09F4  BE 3B49r			 lea	 si, _Oblast4
1  1335	    09F7  E8 0007			 call	 CheckPart
1  1336	    09FA  BE 3B9Fr			 lea	 si, ENTER_MESS
1  1337	    09FD  E8 F98D			 call	 prtstr
1  1338	    0A00  C3				 ret
1  1339	    0A01			 PartTable	 endp
1  1340
1  1341	    0A01			 CheckPart	 proc
1  1342	    0A01  E8 F989			 call	 prtstr
1  1343	    0A04  BB 3F69r			 mov	 bx, offset cs:DiskData
1  1344	    0A07  2E: 8B 36 3B98r		 mov	 si, cs:[AdrObl]
1  1345	    0A0C  8A 40	05			 mov	 al, [bx][si+5]
1  1346	    0A0F  3C 00				 cmp	 al, 00
1  1347	    0A11  BE 3AC2r			 lea	 si, _Nenalezen
1  1348	    0A14  74 2E	90 90			 je	 PTD1
1  1349	    0A18  BE 3ACEr			 lea	 si, _OK
1  1350	    0A1B  E8 F96F			 call	 prtstr
1  1351					 ;	 lea	 si, _PrizAktiv
1  1352					 ;	 call	 prtstr
1  1353	    0A1E  2E: 8B 36 3B98r		 mov	 si, cs:[AdrObl]
1  1354	    0A23  8A 00				 mov	 al, [bx][si]
1  1355	    0A25  3C 80				 cmp	 al, 80h
1  1356	    0A27  BE 3AC2r			 lea	 si, _Nenalezen
1  1357	    0A2A  75 05	90 90			 jne	 PT1
1  1358	    0A2E  BE 3ACEr			 lea	 si, _OK
1  1359	    0A31			 PT1:
1  1360	    0A31  E8 F959			 call	 prtstr
1  1361					 ;	 lea	 si, _PrizOS
1  1362					 ;	 call	 prtstr
1  1363	    0A34  2E: 8B 36 3B98r		 mov	 si, cs:[AdrObl]
1  1364	    0A39  8A 40	04			 mov	 al, [bx][si+4]
1  1365	    0A3C  32 E4				 xor	 ah, ah
1  1366	    0A3E  8B D0				 mov	 dx, ax
1  1367	    0A40  E8 F92C			 call	 Print_Hex
1  1368	    0A43  C3				 ret
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 25
setup.asm



1  1369	    0A44			 PTD1:
1  1370	    0A44  E8 F946			 call	 prtstr
1  1371	    0A47  C3				 ret
1  1372	    0A48			 CheckPart	 endp
1  1373
1  1374
1  1375
   1376					 include .\int21.asm
1  1377					 ;;DokonŸit funkci 0Ah
1  1378
1  1379	    0A48			 INT21	 proc
1  1380	    0A48  80 FC	01			 cmp	 ah, 01h
1  1381	    0A4B  0F 84	009F			 je	 I21_01_
1  1382	    0A4F  80 FC	02			 cmp	 ah, 02h
1  1383	    0A52  0F 84	009B			 je	 I21_02_
1  1384	    0A56  80 FC	03			 cmp	 ah, 03h
1  1385	    0A59  0F 84	0097			 je	 I21_03_
1  1386	    0A5D  80 FC	04			 cmp	 ah, 04h
1  1387	    0A60  0F 84	0093			 je	 I21_04_
1  1388	    0A64  80 FC	05			 cmp	 ah, 05h
1  1389	    0A67  0F 84	008F			 je	 I21_05_
1  1390	    0A6B  80 FC	06			 cmp	 ah, 06h
1  1391	    0A6E  0F 84	008B			 je	 I21_06_
1  1392	    0A72  80 FC	07			 cmp	 ah, 07h
1  1393	    0A75  0F 84	0087			 je	 I21_07_
1  1394	    0A79  80 FC	08			 cmp	 ah, 08h
1  1395	    0A7C  0F 84	0083			 je	 I21_08_
1  1396	    0A80  80 FC	09			 cmp	 ah, 09h
1  1397	    0A83  0F 84	007F			 je	 I21_09_
1  1398					 ;	 cmp	 ah, 0Ah
1  1399					 ;	 je	 I21_0A_
1  1400	    0A87  80 FC	0B			 cmp	 ah, 0Bh
1  1401	    0A8A  0F 84	007E			 je	 I21_0B_
1  1402	    0A8E  80 FC	0C			 cmp	 ah, 0Ch
1  1403	    0A91  74 23	90 90			 je	 I21_0C
1  1404
1  1405	    0A95  80 FC	25			 cmp	 ah, 25h
1  1406	    0A98  74 0E	90 90			 je	 I21_25
1  1407	    0A9C  80 FC	35			 cmp	 ah, 35h
1  1408	    0A9F  74 0B	90 90			 je	 I21_35
1  1409
1  1410					 ;	 cmp	 ah, 052h
1  1411					 ;	 je	 I21_052
1  1412					 ;	 iret
1  1413	    0AA3  2E: FF 2E 3BCCr		 jmp	 dword ptr cs:[OldInts.OFS_21]
1  1414	    0AA8			 INT21	 endp
1  1415
1  1416	    0AA8			 I21_25	 proc
1  1417	    0AA8  E8 F8A3			 call	 Nastav_Int_Vec
1  1418	    0AAB  CF				 iret
1  1419	    0AAC			 I21_25	 endp
1  1420
1  1421	    0AAC			 I21_35	 proc
1  1422	    0AAC  E8 F87E			 call	 Cti_Int_Vec
1  1423	    0AAF  CF				 iret
1  1424	    0AB0			 I21_35	 endp
1  1425
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 26
setup.asm



1  1426					 ;Vr t¡	polohu tabulky syst‚mu SDOS
1  1427	    0AB0			 I21_052 proc
1  1428	    0AB0  BB 3BAAr			 mov	 bx, offset Struktury_SDOS_
1  1429	    0AB3  0E				 push	 cs
1  1430	    0AB4  07				 pop	 es
1  1431	    0AB5  CF				 iret
1  1432	    0AB6			 I21_052 endp
1  1433
1  1434					 ;Vypr zdn¡ kbd	buffer a provede vol n¡
1  1435	    0AB6			 I21_0C	 proc
1  1436	    0AB6  50				 push	 ax
1  1437	    0AB7			 I21__0C_:
1  1438	    0AB7  B4 01				 mov	 ah, 01
1  1439	    0AB9  CD 16				 int	 16h
1  1440	    0ABB  73 0B	90 90			 jnc	 I21__0C
1  1441	    0ABF  B4 00				 mov	 ah, 00
1  1442	    0AC1  CD 16				 int	 16h
1  1443	    0AC3  A2 3974r			 mov	 ScanCode, al
1  1444	    0AC6  EB EF				 jmp	 I21__0C_
1  1445	    0AC8			 I21__0C:
1  1446	    0AC8  C6 06	3974r 00 90		 mov	 ScanCode, 0
1  1447	    0ACE  58				 pop	 ax
1  1448	    0ACF  3C 01				 cmp	 al, 01h
1  1449	    0AD1  74 3C	90 90			 je	 I21_01
1  1450	    0AD5  3C 06				 cmp	 al, 06h
1  1451	    0AD7  74 24	90 90			 je	 I21_06_
1  1452	    0ADB  3C 07				 cmp	 al, 07h
1  1453	    0ADD  74 21	90 90			 je	 I21_07_
1  1454	    0AE1  3C 08				 cmp	 al, 08h
1  1455	    0AE3  74 1E	90 90			 je	 I21_08_
1  1456	    0AE7  3C 0A				 cmp	 al, 0Ah
1  1457	    0AE9  74 1E	90 90			 je	 I21_0A_
1  1458	    0AED  CF				 iret
1  1459	    0AEE			 I21_0C	 endp
1  1460
1  1461					 ;;;Pýeskok
1  1462	    0AEE			 I21_01_:
1  1463	    0AEE  EB 1F	90			 jmp	 I21_01
1  1464	    0AF1			 I21_02_:
1  1465	    0AF1  EB 4E	90			 jmp	 I21_02
1  1466	    0AF4			 I21_03_:
1  1467	    0AF4  EB 53	90			 jmp	 I21_03
1  1468	    0AF7			 I21_04_:
1  1469	    0AF7  EB 62	90			 jmp	 I21_04
1  1470	    0AFA			 I21_05_:
1  1471	    0AFA  EB 70	90			 jmp	 I21_05
1  1472	    0AFD			 I21_06_:
1  1473	    0AFD  EB 7E	90			 jmp	 I21_06
1  1474	    0B00			 I21_07_:
1  1475	    0B00  E9 0087			 jmp	 I21_07
1  1476	    0B03			 I21_08_:
1  1477	    0B03  E9 00AA			 jmp	 I21_08
1  1478	    0B06			 I21_09_:
1  1479	    0B06  E9 00D0			 jmp	 I21_09
1  1480	    0B09			 I21_0A_:
1  1481	    0B09  E9 00DE			 jmp	 I21_0A
1  1482	    0B0C			 I21_0B_:
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 27
setup.asm



1  1483	    0B0C  E9 00DC			 jmp	 I21_0B
1  1484					 ;;;
1  1485
1  1486					 ; Read	character from keyboard
1  1487					 ; Out	 AL = Character
1  1488	    0B0F			 I21_01	 proc
1  1489	    0B0F  A0 3974r			 MOV	 AL,ScanCode
1  1490	    0B12  C6 06	3974r 00 90		 MOV	 ScanCode,0
1  1491	    0B18  0A C0				 OR	 AL,AL
1  1492	    0B1A  75 18	90 90			 JNE	 @_@1
1  1493	    0B1E  B4 10				 mov	 AH,10h
1  1494	    0B20  CD 16				 INT	 16H
1  1495	    0B22  0A C0				 OR	 AL,AL
1  1496	    0B24  75 0E	90 90			 JNE	 @_@1
1  1497	    0B28  88 26	3974r			 MOV	 ScanCode,AH
1  1498	    0B2C  0A E4				 OR	 AH,AH
1  1499	    0B2E  75 04	90 90			 JNE	 @_@1
1  1500	    0B32  B0 03				 MOV	 AL,'C'-64
1  1501	    0B34  E8 011B		 @_@1:	 CALL	 BreakCheck
1  1502	    0B37  3C 00				 cmp	 al, 00
1  1503	    0B39  74 05	90 90			 je	 @_@2
1  1504	    0B3D  E8 F85C			 call	 PrtChr
1  1505	    0B40			 @_@2:
1  1506	    0B40  CF				 iret
1  1507	    0B41			 I21_01	 endp
1  1508
1  1509					 ;Tisk znaku
1  1510					 ;dl = vstup
1  1511	    0B41			 I21_02	 proc
1  1512	    0B41  50				 push	 ax
1  1513	    0B42  8A C2				 mov	 al, dl
1  1514	    0B44  E8 F855			 call	 PrtChr
1  1515	    0B47  58				 pop	 ax
1  1516	    0B48  CF				 iret
1  1517	    0B49			 I21_02	 endp
1  1518
1  1519					 ;Vstup	z pomocn‚ho v/v	zaý¡zen¡ AUX
1  1520					 ;al = vìstup
1  1521	    0B49			 I21_03	 proc
1  1522	    0B49  52				 push	 dx
1  1523	    0B4A			 I21_03R:
1  1524	    0B4A  B8 0200			 mov	 ax, 0200h
1  1525	    0B4D  2E: 8B 16 3BABr		 mov	 dx, word ptr cs:[AUX]
1  1526	    0B52  CD 14				 int	 14h
1  1527	    0B54  F6 C4	80			 test	 ah, 10000000B
1  1528	    0B57  75 F1				 jnz	 I21_03R
1  1529	    0B59  5A				 pop	 dx
1  1530	    0B5A  CF				 iret
1  1531	    0B5B			 I21_03	 endp
1  1532
1  1533					 ;Vìstup na v/v	zaý¡zen¡ AUX
1  1534					 ;dl = vstup
1  1535	    0B5B			 I21_04	 proc
1  1536	    0B5B  52				 push	 dx
1  1537	    0B5C  50				 push	 ax
1  1538					 ;I21_04R:
1  1539	    0B5D  B8 0100			 mov	 ax, 0100h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 28
setup.asm



1  1540	    0B60  8A C2				 mov	 al, dl
1  1541	    0B62  2E: 8B 16 3BABr		 mov	 dx, word ptr cs:[AUX]
1  1542	    0B67  CD 14				 int	 14h
1  1543					 ;	 test	 ah, 10000000B
1  1544					 ;	 jnz	 I21_04R
1  1545	    0B69  58				 pop	 ax
1  1546	    0B6A  5A				 pop	 dx
1  1547	    0B6B  CF				 iret
1  1548	    0B6C			 I21_04	 endp
1  1549
1  1550					 ;Vìstup na tisk rnu PRN
1  1551					 ;dl = vstup
1  1552	    0B6C			 I21_05	 proc
1  1553	    0B6C  52				 push	 dx
1  1554	    0B6D  50				 push	 ax
1  1555	    0B6E  B8 0000			 mov	 ax, 0000h
1  1556	    0B71  8A C2				 mov	 al, dl
1  1557	    0B73  2E: 8B 16 3BADr		 mov	 dx, word ptr cs:[PRN]
1  1558	    0B78  CD 17				 int	 17h
1  1559	    0B7A  58				 pop	 ax
1  1560	    0B7B  5A				 pop	 dx
1  1561	    0B7C  CF				 iret
1  1562	    0B7D			 I21_05	 endp
1  1563
1  1564					 ;Vìstup/vstup na konzole
1  1565					 ;dl = vstup
1  1566	    0B7D			 I21_06	 proc
1  1567	    0B7D  80 FA	FF			 cmp	 dl, 0ffh
1  1568	    0B80  74 04	90 90			 je	 @@_@0
1  1569	    0B84  EB BB				 jmp	 I21_02
1  1570	    0B86			 @@_@0:
1  1571	    0B86  E9 009A			 jmp	 I21_CtiKbdBuffer
1  1572	    0B89  CF				 iret
1  1573	    0B8A			 I21_06	 endp
1  1574
1  1575					 ; Read	character from keyboard
1  1576					 ; Out	 AL = Character
1  1577	    0B8A			 I21_07	 proc
1  1578	    0B8A  A0 3974r			 MOV	 AL,ScanCode
1  1579	    0B8D  C6 06	3974r 00 90		 MOV	 ScanCode,0
1  1580	    0B93  0A C0				 OR	 AL, AL
1  1581	    0B95  75 18	90 90			 JNE	 @_@1_
1  1582	    0B99  B4 10				 mov	 AH, 10h
1  1583	    0B9B  CD 16				 INT	 16H
1  1584	    0B9D  0A C0				 OR	 AL,AL
1  1585	    0B9F  75 0E	90 90			 JNE	 @_@1_
1  1586	    0BA3  88 26	3974r			 MOV	 ScanCode,AH
1  1587	    0BA7  0A E4				 OR	 AH, AH
1  1588	    0BA9  75 04	90 90			 JNE	 @_@1_
1  1589	    0BAD  B0 03				 MOV	 AL,'C'-64
1  1590	    0BAF			 @_@1_:
1  1591	    0BAF  CF				 iret
1  1592	    0BB0			 I21_07	 endp
1  1593
1  1594					 ; Read	character from keyboard
1  1595					 ; Out	 AL = Character
1  1596	    0BB0			 I21_08	 proc
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 29
setup.asm



1  1597	    0BB0  A0 3974r			 MOV	 AL,ScanCode
1  1598	    0BB3  C6 06	3974r 00 90		 MOV	 ScanCode,0
1  1599	    0BB9  0A C0				 OR	 AL, AL
1  1600	    0BBB  75 18	90 90			 JNE	 @_@__1_
1  1601	    0BBF  B4 10				 mov	 AH, 10h
1  1602	    0BC1  CD 16				 INT	 16H
1  1603	    0BC3  0A C0				 OR	 AL,AL
1  1604	    0BC5  75 0E	90 90			 JNE	 @_@__1_
1  1605	    0BC9  88 26	3974r			 MOV	 ScanCode,AH
1  1606	    0BCD  0A E4				 OR	 AH, AH
1  1607	    0BCF  75 04	90 90			 JNE	 @_@__1_
1  1608	    0BD3  B0 03				 MOV	 AL,'C'-64
1  1609	    0BD5			 @_@__1_:
1  1610	    0BD5  E8 007A			 CALL	 BreakCheck
1  1611	    0BD8  CF				 iret
1  1612	    0BD9			 I21_08	 endp
1  1613
1  1614					 ; Routine to print asciiz-string at DS:DX
1  1615	    0BD9			 I21_09	 proc
1  1616	    0BD9  56				 push	 si
1  1617	    0BDA  8B F2				 mov	 si, dx
1  1618	    0BDC			 PrtStr_:
1  1619	    0BDC  AC				 lodsb
1  1620	    0BDD  3C 24				 cmp	 al,"$"
1  1621	    0BDF  74 07	90 90			 jz	 fin_
1  1622	    0BE3  E8 F7B6			 call	 prtchr
1  1623	    0BE6  EB F4				 jmp	 prtstr_
1  1624	    0BE8			 fin_:
1  1625	    0BE8  5E				 pop	 si
1  1626	    0BE9  CF				 iret
1  1627	    0BEA			 I21_09	 endp
1  1628
1  1629	    0BEA			 I21_0A	 proc
1  1630	    0BEA  CF				 iret
1  1631	    0BEB			 I21_0A	 endp
1  1632
1  1633					 ;Stav stand. vst. zaý¡zen¡
1  1634	    0BEB			 I21_0B	 proc
1  1635	    0BEB  A0 3974r			 MOV	 AL,ScanCode
1  1636	    0BEE  C6 06	3974r 00 90		 MOV	 ScanCode,0
1  1637	    0BF4  0A C0				 OR	 AL,AL
1  1638	    0BF6  75 18	90 90			 JNE	 @_@_1__
1  1639	    0BFA  B4 11				 mov	 AH, 11h
1  1640	    0BFC  CD 16				 INT	 16H
1  1641	    0BFE  0A C0				 OR	 AL,AL
1  1642	    0C00  75 0E	90 90			 JNE	 @_@_1__
1  1643	    0C04  88 26	3974r			 MOV	 ScanCode,AH
1  1644	    0C08  0A E4				 OR	 AH,AH
1  1645	    0C0A  75 04	90 90			 JNE	 @_@_1__
1  1646	    0C0E  B0 03				 MOV	 AL,'C'-64
1  1647	    0C10			 @_@_1__:
1  1648	    0C10  3C 00				 cmp	 al, 00
1  1649	    0C12  74 07	90 90			 je	 _0B_00
1  1650	    0C16  B0 FF				 mov	 al, 0FFh
1  1651	    0C18  EB 03	90			 jmp	 _0B_01
1  1652	    0C1B			 _0B_00:
1  1653	    0C1B  B0 00				 mov	 al, 00h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 30
setup.asm



1  1654	    0C1D			 _0B_01:
1  1655	    0C1D  50				 push	 ax
1  1656	    0C1E  E8 0031			 CALL	 BreakCheck
1  1657	    0C21  58				 pop	 ax
1  1658	    0C22  CF				 iret
1  1659	    0C23			 I21_0B	 endp
1  1660
1  1661	    0C23			 I21_CtiKbdBuffer	 proc
1  1662	    0C23  A0 3974r			 MOV	 AL,ScanCode
1  1663	    0C26  C6 06	3974r 00 90		 MOV	 ScanCode,0
1  1664	    0C2C  0A C0				 OR	 AL,AL
1  1665	    0C2E  75 18	90 90			 JNE	 @_@_1
1  1666	    0C32  B4 11				 mov	 AH, 11h
1  1667	    0C34  CD 16				 INT	 16H
1  1668	    0C36  0A C0				 OR	 AL,AL
1  1669	    0C38  75 0E	90 90			 JNE	 @_@_1
1  1670	    0C3C  88 26	3974r			 MOV	 ScanCode,AH
1  1671	    0C40  0A E4				 OR	 AH,AH
1  1672	    0C42  75 04	90 90			 JNE	 @_@_1
1  1673	    0C46  B0 03				 MOV	 AL,'C'-64
1  1674	    0C48  3C 00			 @_@_1:	 cmp	 al, 00
1  1675	    0C4A  74 05	90 90			 je	 @_@_2
1  1676	    0C4E  E8 F74B			 call	 PrtChr
1  1677	    0C51			 @_@_2:
1  1678	    0C51  CF				 iret
1  1679	    0C52			 I21_CtiKbdBuffer	 endp
1  1680
1  1681					 ; Check for Ctrl-Break
1  1682	    0C52			 BreakCheck	 proc
1  1683	    0C52  80 3E	3975r 00		 CMP	 BreakFlag,0
1  1684	    0C57  75 03	90 90			 JNE	 _@@1
1  1685	    0C5B  C3				 RET
1  1686	    0C5C  C6 06	3975r 00 90	 _@@1:	 MOV	 BreakFlag,0
1  1687	    0C62  B4 01			 _@@2:	 MOV	 AH,1
1  1688	    0C64  CD 16				 INT	 16H
1  1689	    0C66  74 08	90 90			 JE	 _@@3
1  1690	    0C6A  B4 00				 MOV	 AH,0
1  1691	    0C6C  CD 16				 INT	 16H
1  1692	    0C6E  EB F2				 JMP	 _@@2
1  1693	    0C70  B0 5E			 _@@3:	 MOV	 AL,'^'
1  1694	    0C72  E8 F727			 CALL	 PrtChr
1  1695	    0C75  B0 43				 MOV	 AL,'C'
1  1696	    0C77  E8 F722			 CALL	 PrtChr
1  1697	    0C7A  B0 13				 MOV	 AL,13h
1  1698	    0C7C  E8 F71D			 CALL	 PrtChr
1  1699	    0C7F  B0 10				 MOV	 AL,10h
1  1700	    0C81  E8 F718			 CALL	 PrtChr
1  1701	    0C84  CD 23				 Int	 23h
1  1702	    0C86  33 C0				 xor	 ax,ax
1  1703	    0C88  C3				 ret
1  1704	    0C89			 BreakCheck	 endp
1  1705
1  1706
1  1707
   1708					 include .\ErrorsFc.asm
1  1709	    0C89			 Int00	 proc	 far
1  1710	    0C89  FA				 cli
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 31
setup.asm



1  1711	    0C8A  66| 60			 pushad
1  1712	    0C8C  FB				 sti
1  1713	    0C8D  E8 F8D1			 call	 FlushKbd
1  1714	    0C90  0E				 push	 cs
1  1715	    0C91  1F				 pop	 ds
1  1716	    0C92  B4 09				 mov	 ah, 09h
1  1717	    0C94  66| BA 000021F1r		 mov	 edx, offset INT00Err
1  1718	    0C9A  CD 21				 int	 21h
1  1719	    0C9C  33 C0				 xor	 ax, ax
1  1720	    0C9E  CD 16				 int	 16h
1  1721	    0CA0  FA				 cli
1  1722	    0CA1  66| 61			 popad
1  1723	    0CA3  FB				 sti
1  1724	    0CA4  CF				 iret
1  1725	    0CA5			 int00	 endp
1  1726
1  1727	    0CA5			 ErrorMessage	 proc
1  1728	    0CA5  E8 F8B9			 call	 FlushKbd
1  1729	    0CA8  3C 03				 cmp	 al, 3
1  1730	    0CAA  74 03	90 90			 je	 ErrB3_
1  1731	    0CAE  C3				 ret
1  1732	    0CAF			 ErrB3_:
1  1733	    0CAF  80 FB	FF			 cmp	 bl, 0FFh
1  1734	    0CB2  75 53	90 90			 jne	 ErrB3__
1  1735	    0CB6			 ErrB3_u:
1  1736	    0CB6  B4 09				 mov	 ah, 09h
1  1737	    0CB8  66| BA 00002264r		 mov	 edx, offset ErrA2
1  1738	    0CBE  CD 21				 int	 21h
1  1739	    0CC0  B4 09				 mov	 ah, 09h
1  1740	    0CC2  66| BA 000022CEr		 mov	 edx, offset ErrB3
1  1741	    0CC8  CD 21				 int	 21h
1  1742	    0CCA  B4 09				 mov	 ah, 09h
1  1743	    0CCC  66| BA 00002301r		 mov	 edx, offset ErrK1
1  1744	    0CD2  CD 21				 int	 21h
1  1745	    0CD4  B4 09				 mov	 ah, 09h
1  1746	    0CD6  66| BA 0000230Fr		 mov	 edx, offset ErrK2
1  1747	    0CDC  CD 21				 int	 21h
1  1748	    0CDE  B4 09				 mov	 ah, 09h
1  1749	    0CE0  66| BA 0000234Br		 mov	 edx, offset ErrK6
1  1750	    0CE6  CD 21				 int	 21h
1  1751	    0CE8  B4 09				 mov	 ah, 09h
1  1752	    0CEA  66| BA 00002363r		 mov	 edx, offset ErrX0
1  1753	    0CF0  CD 21				 int	 21h
1  1754	    0CF2  E8 F86C			 call	 FlushKbd
1  1755	    0CF5			 ErrB3___:
1  1756	    0CF5  33 C0				 xor	 ax, ax
1  1757	    0CF7  CD 16				 int	 16h
1  1758	    0CF9  3C 0D				 cmp	 al, 13
1  1759	    0CFB  74 0A	90 90			 je	 ErrB3__
1  1760	    0CFF  3C 72				 cmp	 al, "r"
1  1761	    0D01  74 05	90 90			 je	 ErrB3x__
1  1762	    0D05  EB EE				 jmp	 ErrB3___
1  1763	    0D07			 ErrB3__:
1  1764	    0D07  C3				 ret
1  1765
1  1766	    0D08			 ErrB3x__:
1  1767	    0D08  E8 007C			 call	 ErrorRegTbl
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 32
setup.asm



1  1768	    0D0B  EB A9				 jmp	 ErrB3_u
1  1769	    0D0D			 ErrorMessage	 endp
1  1770
   1771					 include .\Errors.asm
1  1772					 ;
1  1773					 ;line 329
1  1774					 ;opravit bude-li lepç¡	TASM
1  1775					 ;
1  1776	    0D0D			 CopyReg proc
1  1777	    0D0D  66| 50			 push	 eax
1  1778	    0D0F  8C D8				 mov	 ax, ds
1  1779	    0D11  0E				 push	 cs
1  1780	    0D12  1F				 pop	 ds
1  1781	    0D13  2E: A3 38BAr			 mov	 word ptr CS:[OldErrReg._DS], AX
1  1782	    0D17  66| 58			 pop	 eax
1  1783	    0D19  66| 2E: A3 388Er		 mov	 dword ptr CS:[OldErrReg._EAX],	EAX
1  1784	    0D1E  66| 2E: 89 1E	3892r		 mov	 dword ptr CS:[OldErrReg._EBX],	EBX
1  1785	    0D24  66| 2E: 89 0E	3896r		 mov	 dword ptr CS:[OldErrReg._ECX],	ECX
1  1786	    0D2A  66| 2E: 89 16	389Ar		 mov	 dword ptr CS:[OldErrReg._EDX],	EDX
1  1787	    0D30  66| 2E: 89 36	389Er		 mov	 dword ptr CS:[OldErrReg._ESI],	ESI
1  1788	    0D36  66| 2E: 89 3E	38A2r		 mov	 dword ptr CS:[OldErrReg._EDI],	EDI
1  1789	    0D3C  66| 2E: 89 2E	38A6r		 mov	 dword ptr CS:[OldErrReg._EBP],	EBP
1  1790	    0D42  66| 2E: 89 26	38AAr		 mov	 dword ptr CS:[OldErrReg._ESP],	ESP
1  1791					 ;	 mov	 dword ptr CS:[OldErrReg._EIP],	EIP ;
1  1792	    0D48  66				 db	 66h
1  1793	    0D49  9C				 pushf
1  1794	    0D4A  66				 db	 66h
1  1795	    0D4B  58				 pop	 ax
1  1796	    0D4C  66| 2E: A3 38B2r		 mov	 dword ptr CS:[OldErrReg._EFLAGS], EAX
1  1797	    0D51  2E: 8C 0E 38B6r		 mov	 word ptr CS:[OldErrReg._CS], CS ;
1  1798	    0D56  2E: 8C 16 38B8r		 mov	 word ptr CS:[OldErrReg._SS], SS
1  1799	    0D5B  2E: 8C 06 38BCr		 mov	 word ptr CS:[OldErrReg._ES], ES
1  1800	    0D60  2E: 8C 26 38BEr		 mov	 word ptr CS:[OldErrReg._FS], FS
1  1801	    0D65  2E: 8C 2E 38C0r		 mov	 word ptr CS:[OldErrReg._GS], GS
1  1802	    0D6A  66| 60			 pushad
1  1803	    0D6C  0F 20	C0			 mov	 eax, CR0
1  1804	    0D6F  66| 2E: A3 38C2r		 mov	 dword ptr CS:[OldErrReg._CR0],	EAX
1  1805	    0D74  0F 20	D0			 mov	 eax, CR2
1  1806	    0D77  66| 2E: A3 38C6r		 mov	 dword ptr CS:[OldErrReg._CR2],	EAX
1  1807	    0D7C  0F 20	D8			 mov	 eax, CR3
1  1808	    0D7F  66| 2E: A3 38CAr		 mov	 dword ptr CS:[OldErrReg._CR3],	EAX
1  1809	    0D84  66| 61			 popad
1  1810	    0D86  C3				 ret
1  1811	    0D87			 CopyReg endp
1  1812
1  1813	    0D87			 ErrorRegTbl	 proc
1  1814	    0D87  8C C8				 mov	 ax, cs
1  1815	    0D89  8E D8				 mov	 ds, ax
1  1816	    0D8B  8E C0				 mov	 es, ax
1  1817	    0D8D  C6 06	38DAr 00 90		 mov	 [TMP__3], 00h
1  1818
1  1819	    0D93  E8 F733			 call	 ClrScr
1  1820	    0D96  B2 00				 mov	 dl, 00h
1  1821	    0D98  B6 03				 mov	 dh, 03h
1  1822	    0D9A  E8 F720			 call	 GotoXY
1  1823	    0D9D  66| 8D 36 3325r		 lea	 esi, PrintSystemError
1  1824	    0DA2  E8 F5E8			 call	 Prtstr
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 33
setup.asm



1  1825
1  1826	    0DA5  B2 18				 mov	 dl, 18h
1  1827	    0DA7  B6 08				 mov	 dh, 08h
1  1828	    0DA9  66| 2E: A1 388Er		 mov	 eax, cs:[OldErrReg._EAX]
1  1829	    0DAE  E8 03C3			 call	 PrintErrorReg32
1  1830	    0DB1  B2 18				 mov	 dl, 18h
1  1831	    0DB3  B6 09				 mov	 dh, 09h
1  1832	    0DB5  66| 2E: A1 3892r		 mov	 eax, cs:[OldErrReg._EBX]
1  1833	    0DBA  E8 03B7			 call	 PrintErrorReg32
1  1834	    0DBD  B2 18				 mov	 dl, 18h
1  1835	    0DBF  B6 0A				 mov	 dh, 0Ah
1  1836	    0DC1  66| 2E: A1 3896r		 mov	 eax, cs:[OldErrReg._ECX]
1  1837	    0DC6  E8 03AB			 call	 PrintErrorReg32
1  1838	    0DC9  B2 18				 mov	 dl, 18h
1  1839	    0DCB  B6 0B				 mov	 dh, 0Bh
1  1840	    0DCD  66| 2E: A1 389Ar		 mov	 eax, cs:[OldErrReg._EDX]
1  1841	    0DD2  E8 039F			 call	 PrintErrorReg32
1  1842	    0DD5  B2 18				 mov	 dl, 18h
1  1843	    0DD7  B6 0C				 mov	 dh, 0Ch
1  1844	    0DD9  66| 2E: A1 389Er		 mov	 eax, cs:[OldErrReg._ESI]
1  1845	    0DDE  E8 0393			 call	 PrintErrorReg32
1  1846	    0DE1  B2 18				 mov	 dl, 18h
1  1847	    0DE3  B6 0D				 mov	 dh, 0Dh
1  1848	    0DE5  66| 2E: A1 38A2r		 mov	 eax, cs:[OldErrReg._EDI]
1  1849	    0DEA  E8 0387			 call	 PrintErrorReg32
1  1850	    0DED  B2 18				 mov	 dl, 18h
1  1851	    0DEF  B6 0E				 mov	 dh, 0Eh
1  1852	    0DF1  66| 2E: A1 38A6r		 mov	 eax, cs:[OldErrReg._EBP]
1  1853	    0DF6  E8 037B			 call	 PrintErrorReg32
1  1854	    0DF9  B2 18				 mov	 dl, 18h
1  1855	    0DFB  B6 0F				 mov	 dh, 0Fh
1  1856	    0DFD  66| 2E: A1 38AAr		 mov	 eax, cs:[OldErrReg._ESP]
1  1857	    0E02  E8 036F			 call	 PrintErrorReg32
1  1858	    0E05  B2 18				 mov	 dl, 18h
1  1859	    0E07  B6 10				 mov	 dh, 10h
1  1860	    0E09  66| 2E: A1 38AEr		 mov	 eax, cs:[OldErrReg._EIP]
1  1861	    0E0E  E8 0363			 call	 PrintErrorReg32
1  1862					 ;vyplnØn¡ pole	EFLAGS
1  1863	    0E11  B2 18				 mov	 dl, 18h
1  1864	    0E13  B6 11				 mov	 dh, 11h
1  1865	    0E15  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1866	    0E1A  E8 0357			 call	 PrintErrorReg32
1  1867	    0E1D  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1868	    0E22  66| A9 00200000		 test	 eax, 00000000001000000000000000000000B
1  1869	    0E28  74 0B	90 90			 jz	 Err_NoIDBit
1  1870	    0E2C  BA 111D			 mov	 dx, 111Dh
1  1871	    0E2F  BE 38DBr			 lea	 si, Err_Sh_ID
1  1872	    0E32  E8 0365			 call	 PrintCStr
1  1873	    0E35			 Err_NoIDBit:
1  1874	    0E35  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1875	    0E3A  66| A9 00100000		 test	 eax, 00000000000100000000000000000000B
1  1876	    0E40  74 11	90 90			 jz	 Err_NoVIPBit
1  1877	    0E44  C6 06	38DAr FF 90		 mov	 [TMP__3], -1
1  1878	    0E4A  BA 1120			 mov	 dx, 1120h
1  1879	    0E4D  BE 38DEr			 lea	 si, Err_Sh_VIP
1  1880	    0E50  E8 0347			 call	 PrintCStr
1  1881	    0E53			 Err_NoVIPBit:
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 34
setup.asm



1  1882	    0E53  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1883	    0E58  66| A9 00080000		 test	 eax, 00000000000010000000000000000000B
1  1884	    0E5E  74 0B	90 90			 jz	 Err_NoVIFBit
1  1885	    0E62  BA 1124			 mov	 dx, 1124h
1  1886	    0E65  BE 38E2r			 lea	 si, Err_Sh_VIF
1  1887	    0E68  E8 032F			 call	 PrintCStr
1  1888	    0E6B			 Err_NoVIFBit:
1  1889	    0E6B  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1890	    0E70  66| A9 00020000		 test	 eax, 00000000000000100000000000000000B
1  1891	    0E76  74 0B	90 90			 jz	 Err_NoVMBit
1  1892	    0E7A  BA 1128			 mov	 dx, 1128h
1  1893	    0E7D  BE 38E6r			 lea	 si, Err_Sh_VM
1  1894	    0E80  E8 0317			 call	 PrintCStr
1  1895	    0E83			 Err_NoVMBit:
1  1896	    0E83  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1897	    0E88  66| A9 00002000		 test	 eax, 00000000000000000010000000000000B	;bit 13
1  1898	    0E8E  0F 95	06 38D8r		 setnz	 TMP__1
1  1899	    0E93  66| A9 00001000		 test	 eax, 00000000000000000001000000000000B	;bit 12
1  1900	    0E99  0F 95	06 38D9r		 setnz	 TMP__2
1  1901	    0E9E  33 C0				 xor	 ax, ax
1  1902	    0EA0  A0 38D8r			 mov	 al, TMP__1
1  1903	    0EA3  D0 E0				 shl	 al, 1
1  1904	    0EA5  02 06	38D9r			 add	 al, TMP__2
1  1905	    0EA9  04 30				 add	 al, 30h
1  1906	    0EAB  8A 1E	3989r			 mov	 bl, VideoAtribut
1  1907	    0EAF  53				 push	 bx
1  1908	    0EB0  BA 112F			 mov	 dx, 112Fh
1  1909	    0EB3  E8 F607			 call	 GotoXY
1  1910	    0EB6  C6 06	3989r 0E 90		 mov	 VideoAtribut, 0Eh
1  1911	    0EBC  E8 F504			 call	 PrtColorChr
1  1912	    0EBF  5B				 pop	 bx
1  1913	    0EC0  88 1E	3989r			 mov	 VideoAtribut, bl
1  1914						 ;IOPL end
1  1915	    0EC4  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1916	    0EC9  66| A9 00000800		 test	 eax, 00000000000000000000100000000000B
1  1917	    0ECF  74 0B	90 90			 jz	 Err_NoOFBit
1  1918	    0ED3  BA 1131			 mov	 dx, 1131h
1  1919	    0ED6  BE 38E9r			 lea	 si, Err_Sh_OF
1  1920	    0ED9  E8 02BE			 call	 PrintCStr
1  1921	    0EDC			 Err_NoOFBit:
1  1922	    0EDC  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1923	    0EE1  66| A9 00000400		 test	 eax, 00000000000000000000010000000000B
1  1924	    0EE7  74 0B	90 90			 jz	 Err_NoDFBit
1  1925	    0EEB  BA 1134			 mov	 dx, 1134h
1  1926	    0EEE  BE 38ECr			 lea	 si, Err_Sh_DF
1  1927	    0EF1  E8 02A6			 call	 PrintCStr
1  1928	    0EF4			 Err_NoDFBit:
1  1929	    0EF4  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1930	    0EF9  66| A9 00000100		 test	 eax, 00000000000000000000000100000000B
1  1931	    0EFF  74 0B	90 90			 jz	 Err_NoTFBit
1  1932	    0F03  BA 1137			 mov	 dx, 1137h
1  1933	    0F06  BE 38EFr			 lea	 si, Err_Sh_TF
1  1934	    0F09  E8 028E			 call	 PrintCStr
1  1935	    0F0C			 Err_NoTFBit:
1  1936	    0F0C  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1937	    0F11  66| A9 00000080		 test	 eax, 00000000000000000000000010000000B
1  1938	    0F17  74 0B	90 90			 jz	 Err_NoSFBit
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 35
setup.asm



1  1939	    0F1B  BA 113A			 mov	 dx, 113Ah
1  1940	    0F1E  BE 38F2r			 lea	 si, Err_Sh_SF
1  1941	    0F21  E8 0276			 call	 PrintCStr
1  1942	    0F24			 Err_NoSFBit:
1  1943	    0F24  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1944	    0F29  66| A9 00000040		 test	 eax, 00000000000000000000000001000000B
1  1945	    0F2F  74 0B	90 90			 jz	 Err_NoZFBit
1  1946	    0F33  BA 113D			 mov	 dx, 113Dh
1  1947	    0F36  BE 38F5r			 lea	 si, Err_Sh_ZF
1  1948	    0F39  E8 025E			 call	 PrintCStr
1  1949	    0F3C			 Err_NoZFBit:
1  1950	    0F3C  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1951	    0F41  66| A9 00000010		 test	 eax, 00000000000000000000000000010000B
1  1952	    0F47  74 0B	90 90			 jz	 Err_NoAFBit
1  1953	    0F4B  BA 1140			 mov	 dx, 1140h
1  1954	    0F4E  BE 38F8r			 lea	 si, Err_Sh_AF
1  1955	    0F51  E8 0246			 call	 PrintCStr
1  1956	    0F54			 Err_NoAFBit:
1  1957	    0F54  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1958	    0F59  66| A9 00000004		 test	 eax, 00000000000000000000000000000100B
1  1959	    0F5F  74 0B	90 90			 jz	 Err_NoPFBit
1  1960	    0F63  BA 1143			 mov	 dx, 1143h
1  1961	    0F66  BE 38FBr			 lea	 si, Err_Sh_PF
1  1962	    0F69  E8 022E			 call	 PrintCStr
1  1963	    0F6C			 Err_NoPFBit:
1  1964	    0F6C  66| 2E: A1 38B2r		 mov	 eax, cs:[OldErrReg._EFLAGS]
1  1965	    0F71  66| A9 00000001		 test	 eax, 00000000000000000000000000000001B
1  1966	    0F77  74 0B	90 90			 jz	 Err_NoCFBit
1  1967	    0F7B  BA 1146			 mov	 dx, 1146h
1  1968	    0F7E  BE 38FEr			 lea	 si, Err_Sh_CF
1  1969	    0F81  E8 0216			 call	 PrintCStr
1  1970	    0F84			 Err_NoCFBit:
1  1971					 ;
1  1972	    0F84  B2 24				 mov	 dl, 24h
1  1973	    0F86  B6 08				 mov	 dh, 08h
1  1974	    0F88  2E: A1 38BAr			 mov	 ax, cs:[OldErrReg._DS]
1  1975	    0F8C  E8 0202			 call	 PrintErrorReg16
1  1976	    0F8F  B2 24				 mov	 dl, 24h
1  1977	    0F91  B6 09				 mov	 dh, 09h
1  1978	    0F93  2E: A1 38BCr			 mov	 ax, cs:[OldErrReg._ES]
1  1979	    0F97  E8 01F7			 call	 PrintErrorReg16
1  1980	    0F9A  B2 24				 mov	 dl, 24h
1  1981	    0F9C  B6 0A				 mov	 dh, 0Ah
1  1982	    0F9E  2E: A1 38BEr			 mov	 ax, cs:[OldErrReg._FS]
1  1983	    0FA2  E8 01EC			 call	 PrintErrorReg16
1  1984	    0FA5  B2 24				 mov	 dl, 24h
1  1985	    0FA7  B6 0B				 mov	 dh, 0Bh
1  1986	    0FA9  2E: A1 38C0r			 mov	 ax, cs:[OldErrReg._GS]
1  1987	    0FAD  E8 01E1			 call	 PrintErrorReg16
1  1988	    0FB0  B2 24				 mov	 dl, 24h
1  1989	    0FB2  B6 0C				 mov	 dh, 0Ch
1  1990	    0FB4  2E: A1 38B8r			 mov	 ax, cs:[OldErrReg._SS]
1  1991	    0FB8  E8 01D6			 call	 PrintErrorReg16
1  1992	    0FBB  B2 24				 mov	 dl, 24h
1  1993	    0FBD  B6 0D				 mov	 dh, 0Dh
1  1994	    0FBF  2E: A1 38B6r			 mov	 ax, cs:[OldErrReg._CS]
1  1995	    0FC3  E8 01CB			 call	 PrintErrorReg16
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 36
setup.asm



1  1996					 ;vyplnØn¡ pole	CR0
1  1997	    0FC6  B2 28				 mov	 dl, 28h
1  1998	    0FC8  B6 0E				 mov	 dh, 0Eh
1  1999	    0FCA  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2000	    0FCF  E8 01A2			 call	 PrintErrorReg32
1  2001	    0FD2  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2002	    0FD7  66| A9 80000000		 test	 eax, 10000000000000000000000000000000B
1  2003	    0FDD  74 0B	90 90			 jz	 Err_NoPGBit
1  2004	    0FE1  BA 0E2D			 mov	 dx, 0E2Dh
1  2005	    0FE4  BE 3901r			 lea	 si, Err_Sh_PG
1  2006	    0FE7  E8 01B0			 call	 PrintCStr
1  2007	    0FEA			 Err_NoPGBit:
1  2008	    0FEA  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2009	    0FEF  66| A9 40000000		 test	 eax, 01000000000000000000000000000000B
1  2010	    0FF5  74 0B	90 90			 jz	 Err_NoCDBit
1  2011	    0FF9  BA 0E30			 mov	 dx, 0E30h
1  2012	    0FFC  BE 3904r			 lea	 si, Err_Sh_CD
1  2013	    0FFF  E8 0198			 call	 PrintCStr
1  2014	    1002			 Err_NoCDBit:
1  2015	    1002  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2016	    1007  66| A9 20000000		 test	 eax, 00100000000000000000000000000000B
1  2017	    100D  74 0B	90 90			 jz	 Err_NoNWBit
1  2018	    1011  BA 0E33			 mov	 dx, 0E33h
1  2019	    1014  BE 3907r			 lea	 si, Err_Sh_NW
1  2020	    1017  E8 0180			 call	 PrintCStr
1  2021	    101A			 Err_NoNWBit:
1  2022	    101A  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2023	    101F  66| A9 00040000		 test	 eax, 00000000000001000000000000000000B
1  2024	    1025  74 0B	90 90			 jz	 Err_NoAMBit
1  2025	    1029  BA 0E36			 mov	 dx, 0E36h
1  2026	    102C  BE 390Ar			 lea	 si, Err_Sh_AM
1  2027	    102F  E8 0168			 call	 PrintCStr
1  2028	    1032			 Err_NoAMBit:
1  2029	    1032  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2030	    1037  66| A9 00010000		 test	 eax, 00000000000000010000000000000000B
1  2031	    103D  74 0B	90 90			 jz	 Err_NoWPBit
1  2032	    1041  BA 0E39			 mov	 dx, 0E39h
1  2033	    1044  BE 390Dr			 lea	 si, Err_Sh_WP
1  2034	    1047  E8 0150			 call	 PrintCStr
1  2035	    104A			 Err_NoWPBit:
1  2036	    104A  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2037	    104F  66| A9 00000020		 test	 eax, 00000000000000000000000000100000B
1  2038	    1055  74 0B	90 90			 jz	 Err_NoNEBit
1  2039	    1059  BA 0E3C			 mov	 dx, 0E3Ch
1  2040	    105C  BE 3910r			 lea	 si, Err_Sh_NE
1  2041	    105F  E8 0138			 call	 PrintCStr
1  2042	    1062			 Err_NoNEBit:
1  2043	    1062  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2044	    1067  66| A9 00000008		 test	 eax, 00000000000000000000000000001000B
1  2045	    106D  74 0B	90 90			 jz	 Err_NoTSBit
1  2046	    1071  BA 0E3F			 mov	 dx, 0E3Fh
1  2047	    1074  BE 3913r			 lea	 si, Err_Sh_TS
1  2048	    1077  E8 0120			 call	 PrintCStr
1  2049	    107A			 Err_NoTSBit:
1  2050	    107A  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2051	    107F  66| A9 00000004		 test	 eax, 00000000000000000000000000000100B
1  2052	    1085  74 0B	90 90			 jz	 Err_NoEMBit
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 37
setup.asm



1  2053	    1089  BA 0E42			 mov	 dx, 0E42h
1  2054	    108C  BE 3916r			 lea	 si, Err_Sh_EM
1  2055	    108F  E8 0108			 call	 PrintCStr
1  2056	    1092			 Err_NoEMBit:
1  2057	    1092  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2058	    1097  66| A9 00000002		 test	 eax, 00000000000000000000000000000010B
1  2059	    109D  74 0B	90 90			 jz	 Err_NoMPBit
1  2060	    10A1  BA 0E45			 mov	 dx, 0E45h
1  2061	    10A4  BE 3919r			 lea	 si, Err_Sh_MP
1  2062	    10A7  E8 00F0			 call	 PrintCStr
1  2063	    10AA			 Err_NoMPBit:
1  2064	    10AA  66| 2E: A1 38C2r		 mov	 eax, cs:[OldErrReg._CR0]
1  2065	    10AF  66| A9 00000001		 test	 eax, 00000000000000000000000000000001B
1  2066	    10B5  74 0B	90 90			 jz	 Err_NoPEBit
1  2067	    10B9  BA 0E48			 mov	 dx, 0E48h
1  2068	    10BC  BE 391Cr			 lea	 si, Err_Sh_PE
1  2069	    10BF  E8 00D8			 call	 PrintCStr
1  2070	    10C2			 Err_NoPEBit:
1  2071					 ;
1  2072	    10C2  B2 28				 mov	 dl, 28h
1  2073	    10C4  B6 0F				 mov	 dh, 0Fh
1  2074	    10C6  66| 2E: A1 38C6r		 mov	 eax, cs:[OldErrReg._CR2]
1  2075	    10CB  E8 00A6			 call	 PrintErrorReg32
1  2076					 ;vyplnØn¡ pole	CR3
1  2077	    10CE  B2 28				 mov	 dl, 28h
1  2078	    10D0  B6 10				 mov	 dh, 10h
1  2079	    10D2  66| 2E: A1 38CAr		 mov	 eax, cs:[OldErrReg._CR3]
1  2080	    10D7  E8 009A			 call	 PrintErrorReg32
1  2081	    10DA  66| 2E: A1 38CAr		 mov	 eax, cs:[OldErrReg._CR3]
1  2082	    10DF  66| A9 00000010		 test	 eax, 00000000000000000000000000010000B
1  2083	    10E5  74 0B	90 90			 jz	 Err_NoPCDBit
1  2084	    10E9  BA 102D			 mov	 dx, 102Dh
1  2085	    10EC  BE 391Fr			 lea	 si, Err_Sh_PCD
1  2086	    10EF  E8 00A8			 call	 PrintCStr
1  2087	    10F2			 Err_NoPCDBit:
1  2088	    10F2  66| 2E: A1 38CAr		 mov	 eax, cs:[OldErrReg._CR3]
1  2089	    10F7  66| A9 00000008		 test	 eax, 00000000000000000000000000001000B
1  2090	    10FD  74 0B	90 90			 jz	 Err_NoPWTBit
1  2091	    1101  BA 1030			 mov	 dx, 1030h
1  2092	    1104  BE 3922r			 lea	 si, Err_Sh_PWT
1  2093	    1107  E8 0090			 call	 PrintCStr
1  2094	    110A			 Err_NoPWTBit:
1  2095					 ;
1  2096					 ;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
1  2097					 ;vyplnØn¡ pole	CR4
1  2098	    110A  80 3E	38DAr 00		 cmp	 TMP__3, 00h ;lze pou§¡	intr. CPUID?
1  2099	    110F  74 5E	90 90			 je	 Err_NoCPUID
1  2100	    1113  0F 20	E0			 db	 0Fh,20h,0E0h	 ;mov	 eax, CR4	 ;lepç¡	TASM odstranit!!!
1  2101	    1116  66| 2E: A3 38CEr		 mov	 dword ptr CS:[OldErrReg._CR4],	EAX
1  2102	    111B  B2 3D				 mov	 dl, 3Dh
1  2103	    111D  B6 10				 mov	 dh, 10h
1  2104	    111F  66| 2E: A1 38CEr		 mov	 eax, cs:[OldErrReg._CR4]
1  2105	    1124  E8 004D			 call	 PrintErrorReg32
1  2106	    1127  66| 2E: A1 38CEr		 mov	 eax, cs:[OldErrReg._CR4]
1  2107	    112C  66| A9 00000010		 test	 eax, 00000000000000000000000000010000B
1  2108	    1132  74 0B	90 90			 jz	 Err_NoPSEBit
1  2109	    1136  BA 1042			 mov	 dx, 1042h
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 38
setup.asm



1  2110	    1139  BE 3925r			 lea	 si, Err_Sh_PSE
1  2111	    113C  E8 005B			 call	 PrintCStr
1  2112	    113F			 Err_NoPSEBit:
1  2113	    113F  66| 2E: A1 38CEr		 mov	 eax, cs:[OldErrReg._CR4]
1  2114	    1144  66| A9 00000002		 test	 eax, 00000000000000000000000000000010B
1  2115	    114A  74 0B	90 90			 jz	 Err_NoPVIBit
1  2116	    114E  BA 1045			 mov	 dx, 1045h
1  2117	    1151  BE 3928r			 lea	 si, Err_Sh_PVI
1  2118	    1154  E8 0043			 call	 PrintCStr
1  2119	    1157			 Err_NoPVIBit:
1  2120	    1157  66| 2E: A1 38CEr		 mov	 eax, cs:[OldErrReg._CR4]
1  2121	    115C  66| A9 00000001		 test	 eax, 00000000000000000000000000000001B
1  2122	    1162  74 0B	90 90			 jz	 Err_NoVMEBit
1  2123	    1166  BA 1048			 mov	 dx, 1048h
1  2124	    1169  BE 392Br			 lea	 si, Err_Sh_VME
1  2125	    116C  E8 002B			 call	 PrintCStr
1  2126	    116F			 Err_NoVMEBit:
1  2127	    116F			 Err_NoCPUID:
1  2128					 ;
1  2129	    116F  33 C0				 xor	 ax, ax
1  2130	    1171  CD 16				 int	 16h
1  2131					 ;	 mov	 dl, 00h
1  2132					 ;	 mov	 dh, 22h
1  2133					 ;	 call	 GotoXY
1  2134	    1173  C3				 ret
1  2135
1  2136	    1174			 PrintErrorReg32:
1  2137	    1174  66| 50			 push	 eax
1  2138	    1176  8B DA				 mov	 bx, dx
1  2139	    1178  E8 F342			 call	 GotoXY
1  2140	    117B  5A				 pop	 dx
1  2141	    117C  E8 F1F0			 call	 Print_Hex
1  2142	    117F  FE CB				 dec	 bl
1  2143	    1181  FE CB				 dec	 bl
1  2144	    1183  FE CB				 dec	 bl
1  2145	    1185  FE CB				 dec	 bl
1  2146	    1187  8B D3				 mov	 dx, bx
1  2147	    1189  E8 F331			 call	 GotoXY
1  2148	    118C  5A				 pop	 dx
1  2149	    118D  E8 F1DF			 call	 Print_Hex
1  2150	    1190  C3				 ret
1  2151	    1191			 PrintErrorReg16:
1  2152	    1191  E8 F329			 call	 GotoXY
1  2153	    1194  8B D0				 mov	 dx, ax
1  2154	    1196  E8 F1D6			 call	 Print_Hex
1  2155	    1199  C3				 ret
1  2156	    119A			 PrintCStr:
1  2157	    119A  E8 F320			 call	 GotoXY
1  2158	    119D  8A 1E	3989r			 mov	 bl, VideoAtribut
1  2159	    11A1  53				 push	 bx
1  2160	    11A2  C6 06	3989r 0E 90		 mov	 VideoAtribut, 0Eh
1  2161	    11A8  E8 F205			 call	 PrtColorStr
1  2162	    11AB  5B				 pop	 bx
1  2163	    11AC  88 1E	3989r			 mov	 VideoAtribut, bl
1  2164	    11B0  C3				 ret
1  2165	    11B1			 ErrorRegTbl	 endp
1  2166
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 39
setup.asm



   2167					 include .\Reset.asm
1  2168	    11B1			 Reset	 proc	 near
1  2169	    11B1  C7 06	11C7r 02A0		 mov	 word ptr [SEG_R],02A0h
1  2170	    11B7  C7 06	11C5r 04D4		 mov	 word ptr [OFS_R],04D4h
1  2171	    11BD  FA				 cli
1  2172	    11BE  2E: FF 2E 11C5r		 jmp	 dword ptr cs:[OFS_R]
1  2173	    11C3  FB				 sti
1  2174	    11C4  C3				 ret
1  2175	    11C5  ????			 OFS_R	 dw	 ?
1  2176	    11C7  ????			 SEG_R	 dw	 ?
1  2177	    11C9			 Reset	 endp
1  2178
   2179					 include .\Kbc.asm
1  2180
1  2181						 Include equates.inc
2  2182
2  2183
2  2184					 ;-----------------------------------------------------------------------------
2  2185					 ;
2  2186					 ; EQUATES.INC
2  2187					 ;
2  2188					 ;	 Copyright (c) 1991, 1995-Present  Robert Collins
2  2189					 ;
2  2190					 ;	 You have my permission	to copy	and distribute this software for
2  2191					 ;	 non-commercial	purposes.  Any commercial use of this software or
2  2192					 ;	 source	code is	allowed, so long as the	appropriate copyright
2  2193					 ;	 attributions (to me) are intact, *AND*	my email address is properly
2  2194					 ;	 displayed.
2  2195					 ;
2  2196					 ;	 Basically, give me credit, where credit is due, and show my email
2  2197					 ;	 address.
2  2198					 ;
2  2199					 ;-----------------------------------------------------------------------------
2  2200					 ;
2  2201					 ;	 Robert	R. Collins		 email:	 rcollins@x86.org
2  2202					 ;
2  2203					 ;-----------------------------------------------------------------------------
2  2204
2  2205
2  2206					 ;-----------------------------------------------------------------------------
2  2207					 ; Local equates
2  2208					 ;-----------------------------------------------------------------------------
2  2209		  =009B				 Code_Seg_Access	 equ	 10011011b
2  2210		  =0093				 Data_Seg_Access	 equ	 10010011b
2  2211		  = 0dh,0ah			 CRLF			 equ	 <0dh,0ah>
2  2212		  = 0dh,0ah,'$'			 CRLF$			 equ	 <0dh,0ah,'$'>
2  2213		  = [bp-4]			 INT_SAVE		 equ	 [bp-4]
2  2214		  = [bp-8]			 INT_STACK		 equ	 [bp-8]
2  2215		  = word ptr [bp-0ah]		 Test_counter		 equ	 word ptr [bp-0ah]
2  2216		  = word ptr [bp-0ch]		 Test_status		 equ	 word ptr [bp-0ch]
2  2217		  = byte ptr [bp-0dh]		 Access_Attr		 equ	 byte ptr [bp-0dh]
2  2218		  = byte ptr [bp-0eh]		 Big_Attr		 equ	 byte ptr [bp-0eh]
2  2219		  = byte ptr [bp-10h]		 Expect_Results		 equ	 byte ptr [bp-10h]
2  2220		  = dword ptr [bp-14h]		 Upper_Limit		 equ	dword ptr [bp-14h]
2  2221		  = dword ptr [bp-18h]		 Test_Within		 equ	dword ptr [bp-18h]
2  2222		  = dword ptr [bp-1ch]		 Test_Beyond		 equ	dword ptr [bp-1ch]
2  2223		  = dword ptr [bp-20h]		 Expansion_BIAS		 equ	dword ptr [bp-20h]
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 40
setup.asm



2  2224
2  2225
2  2226					 ;-----------------------------------------------------------------------------
2  2227					 ; I/O Ports
2  2228					 ;-----------------------------------------------------------------------------
2  2229		  =0060				 KBC_CTL		 equ	 060h	 ; 8042	control	port
2  2230		  =0064				 KBC_STAT		 equ	 064h	 ; 8042	status port
2  2231		  =0070				 Cmos_index		 equ	 070h	 ; CMOS	address	port
2  2232		  =0071				 Cmos_data		 equ	 071h	 ; CMOS	data port
2  2233
2  2234					 ;-----------------------------------------------------------------------------
2  2235					 ; Keyboard Controller
2  2236					 ;-----------------------------------------------------------------------------
2  2237		  =0002				 inpt_buf_full		 equ	 2	 ; Input buffer	full
2  2238		  =00DF				 enable_bit20		 equ	 0dfh	 ; enable A20 command
2  2239		  =00DD				 disable_bit20		 equ	 0ddh	 ; disable A20 command
2  2240		  =00FE				 ResetCPU		 equ	 0feh
2  2241
2  2242					 ;-----------------------------------------------------------------------------
2  2243					 ; CMOS	RAM
2  2244					 ;-----------------------------------------------------------------------------
2  2245		  =000F				 CMOS_Shutdown		 equ	 0fh
2  2246		  =000A				 User_Shutdown		 equ	 0ah
2  2247
1  2248					 IO_Delay	 MACRO
1  2249						 out	 0edh,ax
1  2250						 ENDM
1  2251
1  2252					 ;---------------------------------------------------------------
1  2253					 ; Enable_gate20:  Turn	on A20,	and check for errors.
1  2254					 ;---------------------------------------------------------------
1  2255					 ; Input:   None
1  2256					 ; Output:  CY=ERROR
1  2257					 ; Register(s) modified:  None
1  2258					 ;---------------------------------------------------------------
1  2259	    11C9			   Enable_gate20 proc	 near
1  2260					 ;---------------------------------------------------------------
1  2261	    11C9  50				 push	 ax
1  2262	    11CA  B4 DF				 mov	 ah,enable_bit20	 ; gate	address	bit 20 on
1  2263	    11CC  E8 000A			 Call	 Gate_A20
1  2264	    11CF  0A C0				 or	 al,al			 ; command accepted?
1  2265	    11D1  74 04	90 90			 jz	 A20_OK			 ; go if yes
1  2266	    11D5  F1				 db 0f1h
1  2267	    11D6  F9				 stc				 ; set error flag
1  2268	    11D7  58			 A20_OK: pop	 ax
1  2269	    11D8  C3				 ret				 ; exit
1  2270	    11D9			 Enable_gate20	 endp
1  2271
1  2272
1  2273					 ;---------------------------------------------------------------
1  2274					 ; GATE_A20:  This routine controls a signal which gates address
1  2275					 ;	      line 20 (A20).  The gate A20 signal is an	output of
1  2276					 ;	      of the 8042 slave	processor (keyboard controller).
1  2277					 ;	      A20 should be gated on before entering protected
1  2278					 ;	      mode, to allow addressing	of the entire 16M address
1  2279					 ;	      space of the 80286, or 4G	address	space of the
1  2280					 ;	      80386 & 80486.  It should	be gated off after
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 41
setup.asm



1  2281					 ;	      entering real mode -- from protected mode.
1  2282					 ;---------------------------------------------------------------
1  2283					 ; Input:   AH = DD ==>	A20 gated off (A20 always 0)
1  2284					 ;	    AH = DF ==>	A20 gated on  (CPU controls A20)
1  2285					 ; Output:  AL = 0  ==>	Operation successful
1  2286					 ;	    AL = 2  ==>	Operation failed, 8042 can't accept cmd
1  2287					 ; Register(s) modified:  AX
1  2288					 ;---------------------------------------------------------------
1  2289	    11D9			   Gate_A20	 proc	 near
1  2290					 ;---------------------------------------------------------------
1  2291	    11D9  9C				 pushf			 ; save	interrupt status
1  2292	    11DA  FA				 cli			 ; disable ints	while using 8042
1  2293	    11DB  E8 0027			 Call	 Empty_8042	 ; insure 8042 input buffer empty
1  2294	    11DE  75 23	90 90			 jnz	 A20_Fail	 ; ret:	8042 unable to accept cmd
1  2295						 IO_Delay		 ; I/O Delay
2  2296	    11E2  E7 ED				 out	 0edh,ax
1  2297	    11E4  B0 D1				 mov	 al,0D1h	 ; 8042	cmd to write output port
1  2298	    11E6  E6 64				 out	 KBC_STAT,al	 ; output cmd to 8042
1  2299	    11E8  E8 001A			 Call	 Empty_8042	 ; wait	for 8042 to accept cmd
1  2300	    11EB  75 16	90 90			 jnz	 A20_Fail	 ; ret:	8042 unable to accept cmd
1  2301	    11EF  8A C4				 mov	 al,ah		 ; 8042	port data
1  2302	    11F1  E6 60				 out	 KBC_CTL,al	 ; output port data to 8042
1  2303	    11F3  E8 000F			 Call	 Empty_8042	 ; wait	for 8042 to port data
1  2304	    11F6  75 0B	90 90			 jnz	 A20_Fail
1  2305	    11FA  51				 push	 cx		 ; save	it
1  2306	    11FB  B9 0014			 mov	 cx,14h		 ;
1  2307	    11FE			 @DLY:	 IO_Delay		 ; Wait	for KBC	to execute the
2  2308	    11FE  E7 ED				 out	 0edh,ax
1  2309	    1200  E2 FC				 loop	 @DLY		 ;  command.  (about 25uS)
1  2310	    1202  59				 pop	 cx		 ; restore it
1  2311
1  2312	    1203			 A20_Fail:
1  2313	    1203  9D				 popf			 ; restore flags
1  2314	    1204  C3				 ret
1  2315	    1205			 Gate_A20	 endp
1  2316
1  2317
1  2318					 ;---------------------------------------------------------------
1  2319					 ; EMPTY_8042:	This routine waits for the 8042	buffer to empty.
1  2320					 ;---------------------------------------------------------------
1  2321					 ; Input:   None
1  2322					 ; Output:  AL = 0, 8042 input buffer empty:	 ZF
1  2323					 ;	    AL = 2, Time out; 8042 buffer full:	 NZ
1  2324					 ; Register(s) modified:  AX
1  2325					 ;---------------------------------------------------------------
1  2326	    1205			   Empty_8042	 proc	 near
1  2327					 ;---------------------------------------------------------------
1  2328	    1205  53				 push	 bx		 ; save	BX
1  2329	    1206  51				 push	 cx		 ; save	CX
1  2330	    1207  BB 0005			 mov	 bx,5		 ; set super-long timeout
1  2331	    120A  33 C9				 xor	 cx,cx		 ; CX=0:  timeout value
1  2332
1  2333	    120C			 Try_KBC:
1  2334						 IO_Delay		 ;
2  2335	    120C  E7 ED				 out	 0edh,ax
1  2336	    120E  E4 64				 in	 al,KBC_STAT	 ; read	8042 status port
1  2337	    1210  24 02				 and	 al,inpt_buf_full; input buffer	full flag (D1)
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 42
setup.asm



1  2338	    1212  E0 F8				 loopnz	 Try_KBC	 ; loop	until input buffer empty
1  2339									 ;   or	timeout
1  2340	    1214  74 07	90 90			 jz	 @TryKbc	 ; success!
1  2341	    1218  4B				 dec	 bx		 ; are we done yet?
1  2342	    1219  75 F1				 jnz	 Try_KBC	 ; keep	trying
1  2343	    121B  0A C0				 or	 al,al		 ; success on last try?
1  2344	    121D			 @TryKbc:
1  2345	    121D  59				 pop	 cx		 ; restore CX
1  2346	    121E  5B				 pop	 bx
1  2347	    121F  C3				 ret
1  2348	    1220			 Empty_8042	 endp
1  2349
1  2350
1  2351					 ;---------------------------------------------------------------
1  2352					 ; SHUT_A20:  Disable A20 from CPU address BUS.
1  2353					 ;---------------------------------------------------------------
1  2354					 ; Input:   None
1  2355					 ; Output:  CY=ERROR
1  2356					 ; Register(s) modified:  None
1  2357					 ;---------------------------------------------------------------
1  2358	    1220			   Shut_a20	 proc	 near
1  2359					 ;---------------------------------------------------------------
1  2360	    1220  50				 push	 ax
1  2361	    1221  B4 DD				 mov	 ah,disable_bit20	 ; gate	address	bit 20 on
1  2362	    1223  E8 FFB3			 Call	 Gate_A20
1  2363	    1226  0A C0				 or	 al,al			 ; was command accepted?
1  2364	    1228  74 03	90 90			 jz	 A20_Shut		 ; go if yes
1  2365	    122C  F9				 stc				 ; set error flag
1  2366	    122D			 A20_Shut:
1  2367	    122D  58				 pop	 ax
1  2368	    122E  C3				 ret				 ; exit
1  2369	    122F			 Shut_a20	 endp
1  2370
1  2371
   2372					 include .\EGA.852
1  2373	    122F  00 FF	FF FF FF FF FF+	 Font852:	 db									    +
   2374		  FF FF	FF FF FF FF FF+	 " ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ  ~¥½™~      ~ÿÛÿÿÃçÿÿ~        lþþþþ|8        8|þ|8        <<ççç
   2375		  FF FF	FF 00 00 7E 81+	 <       <~ÿÿ~<          <<      "
   2376		  A5 81	81 BD 99 81 81+
   2377		  7E 00	00 00 00 00 00+
   2378		  7E FF	DB FF FF C3 E7+
   2379		  FF FF	7E 00 00 00 00+
   2380		  00 00	00 00 6C FE FE+
   2381		  FE FE	7C 38 10 00 00+
   2382		  00 00	00 00 00 00 10+
   2383		  38 7C	FE 7C 38 10 00+
   2384		  00 00	00 00 00 00 00+
   2385		  18 3C	3C E7 E7 E7 18+
   2386		  18 3C	00 00 00 00 00+
   2387		  00 00	18 3C 7E FF FF+
   2388		  7E 18	18 3C 00 00 00+
   2389		  00 00	00 00 00 00 00+
   2390		  18 3C	3C 18 00 00 00+
   2391		  00 00	00
1  2392	    12B0  FF FF	FF FF FF FF E7+			 db									    +
   2393		  C3 C3	E7 FF FF FF FF+	 "ÿÿÿÿÿÿçÃÃçÿÿÿÿÿÿ     <fBBf<     ÿÿÿÿÿÃ™½½™Ãÿÿÿÿÿ  2xÌÌÌÌx      <ffff<~      >6>0000pðà
   2394		  FF FF	00 00 00 00 00+	       ~f~ffffnîìÀ      Û<ç<Û     "
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 43
setup.asm



   2395		  3C 66	42 42 66 3C 00+
   2396		  00 00	00 00 FF FF FF+
   2397		  FF FF	C3 99 BD BD 99+
   2398		  C3 FF	FF FF FF FF 00+
   2399		  00 1E	0E 1A 32 78 CC+
   2400		  CC CC	CC 78 00 00 00+
   2401		  00 00	00 3C 66 66 66+
   2402		  66 3C	18 7E 18 18 00+
   2403		  00 00	00 00 00 3E 36+
   2404		  3E 30	30 30 30 70 F0+
   2405		  E0 00	00 00 00 00 00+
   2406		  7E 66	7E 66 66 66 66+
   2407		  6E EE	EC C0 00 00 00+
   2408		  00 00	00 18 18 DB 3C+
   2409		  E7 3C	DB 18 18 00 00+
   2410		  00 00	00
1  2411	    1331  80 C0	E0 F0 F8 FE F8+			 db									    +
   2412		  F0 E0	C0 80 00 00 00+	 "€ÀàðøþøðàÀ€     >þ>      <~~<       fffffff ff      ÛÛÛ{     |Æ`8lÆÆl8Æ
   2413		  00 00	02 06 0E 1E 3E+	 |           þþþþ      <~~<~      "
   2414		  FE 3E	1E 0E 06 02 00+
   2415		  00 00	00 00 00 18 3C+
   2416		  7E 18	18 18 7E 3C 18+
   2417		  00 00	00 00 00 00 00+
   2418		  66 66	66 66 66 66 66+
   2419		  00 66	66 00 00 00 00+
   2420		  00 00	7F DB DB DB 7B+
   2421		  1B 1B	1B 1B 1B 00 00+
   2422		  00 00	00 7C C6 60 38+
   2423		  6C C6	C6 6C 38 0C C6+
   2424		  7C 00	00 00 00 00 00+
   2425		  00 00	00 00 00 FE FE+
   2426		  FE FE	00 00 00 00 00+
   2427		  00 18	3C 7E 18 18 18+
   2428		  7E 3C	18 7E 00 00 00+
   2429		  00 00	00
1  2430	    13B2  18 3C	7E 18 18 18 18+			 db									    +
   2431		  18 18	18 00 00 00 00+	 "<~      ~<         þ           0`ü`0            ÀÀÀþ           (lþl   +
   2432		  00 00	18 18 18 18 18+	 (          88||þþ         þþ||88        "
   2433		  18 18	7E 3C 18 00 00+
   2434		  00 00	00 00 00 00 00+
   2435		  18 0C	FE 0C 18 00 00+
   2436		  00 00	00 00 00 00 00+
   2437		  00 00	30 60 FC 60 30+
   2438		  00 00	00 00 00 00 00+
   2439		  00 00	00 00 00 C0 C0+
   2440		  C0 FE	00 00 00 00 00+
   2441		  00 00	00 00 00 00 28+
   2442		  6C FE	6C 28 00 00 00+
   2443		  00 00	00 00 00 00 00+
   2444		  10 38	38 7C 7C FE FE+
   2445		  00 00	00 00 00 00 00+
   2446		  00 00	FE FE 7C 7C 38+
   2447		  38 10	00 00 00 00 00+
   2448		  00 00	00
1  2449	    1433  00 00	00 00 00 00 00+			 db									    +
   2450		  00 00	00 00 00 00 00+	 "               <<<      ÆÆÆD              llþlllþll    |ÆÂÀ|†Æ|      ÂÆ0`Æ†  
   2451		  00 18	3C 3C 3C 18 18+	     8ll8vÜÌÌÌv     000`             "
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 44
setup.asm



   2452		  18 00	18 18 00 00 00+
   2453		  00 00	C6 C6 C6 44 00+
   2454		  00 00	00 00 00 00 00+
   2455		  00 00	00 00 00 00 6C+
   2456		  6C FE	6C 6C 6C FE 6C+
   2457		  6C 00	00 00 00 18 18+
   2458		  7C C6	C2 C0 7C 06 06+
   2459		  86 C6	7C 18 18 00 00+
   2460		  00 00	00 00 C2 C6 0C+
   2461		  18 30	60 C6 86 00 00+
   2462		  00 00	00 00 38 6C 6C+
   2463		  38 76	DC CC CC CC 76+
   2464		  00 00	00 00 00 30 30+
   2465		  30 60	00 00 00 00 00+
   2466		  00 00	00 00 00 00 00+
   2467		  00 0C	18
1  2468	    14B4  30 30	30 30 30 30 18+			 db									    +
   2469		  0C 00	00 00 00 00 00+	 "000000      00         f<ÿ<f           ~               0          þ       
   2470		  30 18	0C 0C 0C 0C 0C+	                    0`À€      8lÆ"
   2471		  0C 18	30 00 00 00 00+
   2472		  00 00	00 00 00 66 3C+
   2473		  FF 3C	66 00 00 00 00+
   2474		  00 00	00 00 00 00 00+
   2475		  18 18	7E 18 18 00 00+
   2476		  00 00	00 00 00 00 00+
   2477		  00 00	00 00 00 00 18+
   2478		  18 18	30 00 00 00 00+
   2479		  00 00	00 00 00 00 FE+
   2480		  00 00	00 00 00 00 00+
   2481		  00 00	00 00 00 00 00+
   2482		  00 00	00 00 18 18 00+
   2483		  00 00	00 00 00 00 00+
   2484		  02 06	0C 18 30 60 C0+
   2485		  80 00	00 00 00 00 00+
   2486		  38 6C	C6
1  2487	    1535  C6 D6	D6 C6 C6 6C 38+			 db									    +
   2488		  00 00	00 00 00 00 18+	 "ÆÖÖÆÆl8      8x~      |Æ0`ÀÆþ      |Æ<Æ|      <lÌþ      þÀÀÀüÆ|    
   2489		  38 78	18 18 18 18 18+	   8`ÀÀüÆÆÆÆ|      þÆ00000      |ÆÆÆ"
   2490		  18 7E	00 00 00 00 00+
   2491		  00 7C	C6 06 0C 18 30+
   2492		  60 C0	C6 FE 00 00 00+
   2493		  00 00	00 7C C6 06 06+
   2494		  3C 06	06 06 C6 7C 00+
   2495		  00 00	00 00 00 0C 1C+
   2496		  3C 6C	CC FE 0C 0C 0C+
   2497		  1E 00	00 00 00 00 00+
   2498		  FE C0	C0 C0 FC 06 06+
   2499		  06 C6	7C 00 00 00 00+
   2500		  00 00	38 60 C0 C0 FC+
   2501		  C6 C6	C6 C6 7C 00 00+
   2502		  00 00	00 00 FE C6 06+
   2503		  0C 18	30 30 30 30 30+
   2504		  00 00	00 00 00 00 7C+
   2505		  C6 C6	C6
1  2506	    15B6  7C C6	C6 C6 C6 7C 00+			 db									    +
   2507		  00 00	00 00 00 7C C6+	 "|ÆÆÆÆ|      |ÆÆÆ~x                       0       0`0         ~  ~        
   2508		  C6 C6	7E 06 06 06 0C+	   `00`      |ÆÆ        |ÆÆÞ"
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 45
setup.asm



   2509		  78 00	00 00 00 00 00+
   2510		  00 00	18 18 00 00 00+
   2511		  18 18	00 00 00 00 00+
   2512		  00 00	00 00 18 18 00+
   2513		  00 00	18 18 30 00 00+
   2514		  00 00	00 00 00 06 0C+
   2515		  18 30	60 30 18 0C 06+
   2516		  00 00	00 00 00 00 00+
   2517		  00 00	7E 00 00 7E 00+
   2518		  00 00	00 00 00 00 00+
   2519		  00 00	60 30 18 0C 06+
   2520		  0C 18	30 60 00 00 00+
   2521		  00 00	00 7C C6 C6 0C+
   2522		  18 18	18 00 18 18 00+
   2523		  00 00	00 00 00 00 7C+
   2524		  C6 C6	DE
1  2525	    1637  DE DE	DC C0 7C 00 00+			 db									    +
   2526		  00 00	00 00 10 38 6C+	 "ÞÞÜÀ|      8lÆÆþÆÆÆÆ      üfff|ffffü      <fÂÀÀÀÀÂf<      ølfffffflø      þfbhxh`bfþ      
   2527		  C6 C6	FE C6 C6 C6 C6+	 þfbhxh```ð      <fÂÀÀÞÆÆf:      ÆÆÆÆþÆ"
   2528		  00 00	00 00 00 00 FC+
   2529		  66 66	66 7C 66 66 66+
   2530		  66 FC	00 00 00 00 00+
   2531		  00 3C	66 C2 C0 C0 C0+
   2532		  C0 C2	66 3C 00 00 00+
   2533		  00 00	00 F8 6C 66 66+
   2534		  66 66	66 66 6C F8 00+
   2535		  00 00	00 00 00 FE 66+
   2536		  62 68	78 68 60 62 66+
   2537		  FE 00	00 00 00 00 00+
   2538		  FE 66	62 68 78 68 60+
   2539		  60 60	F0 00 00 00 00+
   2540		  00 00	3C 66 C2 C0 C0+
   2541		  DE C6	C6 66 3A 00 00+
   2542		  00 00	00 00 C6 C6 C6+
   2543		  C6 FE	C6
1  2544	    16B8  C6 C6	C6 C6 00 00 00+			 db									    +
   2545		  00 00	00 3C 18 18 18+	 "ÆÆÆÆ      <<      ÌÌÌx      æfflxxlffæ      ð``````bfþ      ÆîþþÖÆÆÆÆÆ      Æ
   2546		  18 18	18 18 18 3C 00+	 æöþÞÎÆÆÆÆ      |ÆÆÆÆÆÆÆÆ|      üfff|``"
   2547		  00 00	00 00 00 1E 0C+
   2548		  0C 0C	0C 0C CC CC CC+
   2549		  78 00	00 00 00 00 00+
   2550		  E6 66	66 6C 78 78 6C+
   2551		  66 66	E6 00 00 00 00+
   2552		  00 00	F0 60 60 60 60+
   2553		  60 60	62 66 FE 00 00+
   2554		  00 00	00 00 C6 EE FE+
   2555		  FE D6	C6 C6 C6 C6 C6+
   2556		  00 00	00 00 00 00 C6+
   2557		  E6 F6	FE DE CE C6 C6+
   2558		  C6 C6	00 00 00 00 00+
   2559		  00 7C	C6 C6 C6 C6 C6+
   2560		  C6 C6	C6 7C 00 00 00+
   2561		  00 00	00 FC 66 66 66+
   2562		  7C 60	60
1  2563	    1739  60 60	F0 00 00 00 00+			 db									    +
   2564		  00 00	7C C6 C6 C6 C6+	 "``ð      |ÆÆÆÆÆÆÖÞ|    üfff|lfffö      |ÆÆ`8ÆÆ|      ~~Z<      ÆÆÆÆÆÆÆÆÆ|      ÆÆ
   2565		  C6 C6	D6 DE 7C 0C 0E+	 ÆÆÆÆÆl8      ÆÆÆÆÖÖÖþîl      ÆÆl|88|l"
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 46
setup.asm



   2566		  00 00	00 00 FC 66 66+
   2567		  66 7C	6C 66 66 66 F6+
   2568		  00 00	00 00 00 00 7C+
   2569		  C6 C6	60 38 0C 06 C6+
   2570		  C6 7C	00 00 00 00 00+
   2571		  00 7E	7E 5A 18 18 18+
   2572		  18 18	18 3C 00 00 00+
   2573		  00 00	00 C6 C6 C6 C6+
   2574		  C6 C6	C6 C6 C6 7C 00+
   2575		  00 00	00 00 00 C6 C6+
   2576		  C6 C6	C6 C6 C6 6C 38+
   2577		  10 00	00 00 00 00 00+
   2578		  C6 C6	C6 C6 D6 D6 D6+
   2579		  FE EE	6C 00 00 00 00+
   2580		  00 00	C6 C6 6C 7C 38+
   2581		  38 7C	6C
1  2582	    17BA  C6 C6	00 00 00 00 00+			 db									    +
   2583		  00 66	66 66 66 3C 18+	 "ÆÆ      ffff<<      þÆ†0`ÂÆþ      <00000000<       €Ààp8      <<    8lÆ 
   2584		  18 18	18 3C 00 00 00+	                         ÿ  00        "
   2585		  00 00	00 FE C6 86 0C+
   2586		  18 30	60 C2 C6 FE 00+
   2587		  00 00	00 00 00 3C 30+
   2588		  30 30	30 30 30 30 30+
   2589		  3C 00	00 00 00 00 00+
   2590		  00 80	C0 E0 70 38 1C+
   2591		  0E 06	02 00 00 00 00+
   2592		  00 00	3C 0C 0C 0C 0C+
   2593		  0C 0C	0C 0C 3C 00 00+
   2594		  00 00	10 38 6C C6 00+
   2595		  00 00	00 00 00 00 00+
   2596		  00 00	00 00 00 00 00+
   2597		  00 00	00 00 00 00 00+
   2598		  00 00	00 FF 00 00 30+
   2599		  30 18	00 00 00 00 00+
   2600		  00 00	00
1  2601	    183B  00 00	00 00 00 00 00+			 db									    +
   2602		  00 00	00 78 0C 7C CC+	 "          x|ÌÌÌv      à``xlffff|         |ÆÀÀÀÆ|      <lÌÌÌÌv         |ÆþÀÀÆ|      620
   2603		  CC CC	76 00 00 00 00+	 x0000x         vÌÌÌÌÌ|Ìx   à``lvffffæ"
   2604		  00 00	E0 60 60 78 6C+
   2605		  66 66	66 66 7C 00 00+
   2606		  00 00	00 00 00 00 00+
   2607		  7C C6	C0 C0 C0 C6 7C+
   2608		  00 00	00 00 00 00 1C+
   2609		  0C 0C	3C 6C CC CC CC+
   2610		  CC 76	00 00 00 00 00+
   2611		  00 00	00 00 7C C6 FE+
   2612		  C0 C0	C6 7C 00 00 00+
   2613		  00 00	00 1C 36 32 30+
   2614		  78 30	30 30 30 78 00+
   2615		  00 00	00 00 00 00 00+
   2616		  00 76	CC CC CC CC CC+
   2617		  7C 0C	CC 78 00 00 00+
   2618		  E0 60	60 6C 76 66 66+
   2619		  66 66	E6
1  2620	    18BC  00 00	00 00 00 00 18+			 db									    +
   2621		  18 00	38 18 18 18 18+	 "       8<       ff<   à``flxxlfæ      8<         ìþÖÖÖÖÆ         Üf
   2622		  18 3C	00 00 00 00 00+	 fffff         |ÆÆÆÆÆ|         Üfffff|``ð      "
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 47
setup.asm



   2623		  00 06	06 00 0E 06 06+
   2624		  06 06	06 06 66 66 3C+
   2625		  00 00	00 E0 60 60 66+
   2626		  6C 78	78 6C 66 E6 00+
   2627		  00 00	00 00 00 38 18+
   2628		  18 18	18 18 18 18 18+
   2629		  3C 00	00 00 00 00 00+
   2630		  00 00	00 EC FE D6 D6+
   2631		  D6 D6	C6 00 00 00 00+
   2632		  00 00	00 00 00 DC 66+
   2633		  66 66	66 66 66 00 00+
   2634		  00 00	00 00 00 00 00+
   2635		  7C C6	C6 C6 C6 C6 7C+
   2636		  00 00	00 00 00 00 00+
   2637		  00 00	DC 66 66 66 66+
   2638		  66 7C	60 60 F0 00 00+
   2639		  00 00	00 00
1  2640	    1945  76 CC	CC CC CC CC 7C+			 db									    +
   2641		  0C 0C	1E 00 00 00 00+	 "vÌÌÌÌÌ|      Üvf```ð         |Æ`8Æ|      00ü00006         ÌÌÌÌÌÌv         ÌÌÌÌÌx0    
   2642		  00 00	DC 76 66 60 60+	      ÆÆÖÖÖþl         Æl888lÆ         ÆÆÆÆÆÆ~"
   2643		  60 F0	00 00 00 00 00+
   2644		  00 00	00 00 7C C6 60+
   2645		  38 0C	C6 7C 00 00 00+
   2646		  00 00	00 10 30 30 FC+
   2647		  30 30	30 30 36 1C 00+
   2648		  00 00	00 00 00 00 00+
   2649		  00 CC	CC CC CC CC CC+
   2650		  76 00	00 00 00 00 00+
   2651		  00 00	00 CC CC CC CC+
   2652		  CC 78	30 00 00 00 00+
   2653		  00 00	00 00 00 C6 C6+
   2654		  D6 D6	D6 FE 6C 00 00+
   2655		  00 00	00 00 00 00 00+
   2656		  C6 6C	38 38 38 6C C6+
   2657		  00 00	00 00 00 00 00+
   2658		  00 00	C6 C6 C6 C6 C6+
   2659		  C6 7E	06 0C
1  2660	    19CE  F8 00	00 00 00 00 00+			 db									    +
   2661		  FE CC	18 30 60 C6 FE+	 "ø      þÌ0`Æþ      p             pp      vÜ                8lÆÆ
   2662		  00 00	00 00 00 00 0E+	 Æþ       <fÂÀÀÀÀÂf<|   Ì  ÌÌÌÌÌÌv     0 |Æ"
   2663		  18 18	18 70 18 18 18+
   2664		  18 0E	00 00 00 00 00+
   2665		  00 18	18 18 18 00 18+
   2666		  18 18	18 18 00 00 00+
   2667		  00 00	00 70 18 18 18+
   2668		  0E 18	18 18 18 70 00+
   2669		  00 00	00 00 00 76 DC+
   2670		  00 00	00 00 00 00 00+
   2671		  00 00	00 00 00 00 00+
   2672		  00 00	10 38 6C C6 C6+
   2673		  C6 FE	00 00 00 00 00+
   2674		  00 00	3C 66 C2 C0 C0+
   2675		  C0 C0	C2 66 3C 0C 06+
   2676		  7C 00	00 00 CC 00 00+
   2677		  CC CC	CC CC CC CC 76+
   2678		  00 00	00 00 00 0C 18+
   2679		  30 00	7C C6
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 48
setup.asm



1  2680	    1A57  FE C0	C0 C6 7C 00 00+			 db									    +
   2681		  00 00	00 10 38 6C 00+	 "þÀÀÆ|     8l x|ÌÌÌv      Ì  x|ÌÌÌv     xÌx ÌÌÌÌÌÌv     0 |ÆÀÀÀÆ|         |ÆÀÀÀÆ|x   
   2682		  78 0C	7C CC CC CC 76+	 88xX<      Æ  |ÆþÀÀÆ|    6l |ÆÆÆÆÆÆÆ|    "
   2683		  00 00	00 00 00 00 CC+
   2684		  00 00	78 0C 7C CC CC+
   2685		  CC 76	00 00 00 00 00+
   2686		  78 CC	78 00 CC CC CC+
   2687		  CC CC	CC 76 00 00 00+
   2688		  00 00	0C 18 30 00 7C+
   2689		  C6 C0	C0 C0 C6 7C 00+
   2690		  00 00	00 00 00 00 00+
   2691		  00 7C	C6 C0 C0 C0 C6+
   2692		  7C 18	0C 78 00 00 00+
   2693		  38 1A	1E 1C 18 38 78+
   2694		  58 18	3C 00 00 00 00+
   2695		  00 00	C6 00 00 7C C6+
   2696		  FE C0	C0 C6 7C 00 00+
   2697		  00 00	36 6C 00 7C C6+
   2698		  C6 C6	C6 C6 C6 C6 7C+
   2699		  00 00	00 00
1  2700	    1AE0  00 00	36 6C 00 7C C6+			 db									    +
   2701		  C6 C6	C6 C6 7C 00 00+	 "  6l |ÆÆÆÆÆ|     <f 8<    0 þ†0`ÂÆþ     Æ8lÆÆþÆÆÆÆ     <fÂÀÀÀÂf<    0` þf`x`bf
   2702		  00 00	00 18 3C 66 00+	 þ    0` ð`````bfþ    0` à```````ð     8l |ÆÆÆ"
   2703		  38 18	18 18 18 18 3C+
   2704		  00 00	00 00 18 30 00+
   2705		  FE 86	0C 18 30 60 C2+
   2706		  C6 FE	00 00 00 00 00+
   2707		  C6 10	38 6C C6 C6 FE+
   2708		  C6 C6	C6 C6 00 00 00+
   2709		  00 0C	18 00 3C 66 C2+
   2710		  C0 C0	C0 C2 66 3C 00+
   2711		  00 00	00 18 30 60 00+
   2712		  FE 66	60 78 60 62 66+
   2713		  FE 00	00 00 00 30 60+
   2714		  00 F0	60 60 60 60 60+
   2715		  62 66	FE 00 00 00 00+
   2716		  30 60	00 E0 60 60 60+
   2717		  60 60	60 60 F0 00 00+
   2718		  00 00	00 10 38 6C 00+
   2719		  7C C6	C6 C6
1  2720	    1B69  C6 C6	7C 00 00 00 00+			 db									    +
   2721		  00 00	C6 00 00 7C C6+	 "ÆÆ|      Æ  |ÆÆÆÆÆ|      öbd````bfþ      ìdh``````ð    0 |ÆÆ`8ÆÆ|       |Æ`8Æ|     Æ |
   2722		  C6 C6	C6 C6 7C 00 00+	 ÆÆÆÆÆÆÆ|     Æ ÆÆÆÆÆÆÆÆ|    f< ~~Z<     "
   2723		  00 00	00 00 F6 62 64+
   2724		  60 60	60 60 62 66 FE+
   2725		  00 00	00 00 00 00 EC+
   2726		  64 68	60 60 60 60 60+
   2727		  60 F0	00 00 00 00 18+
   2728		  30 00	7C C6 C6 60 38+
   2729		  0C C6	C6 7C 00 00 00+
   2730		  00 00	00 0C 18 00 7C+
   2731		  C6 60	38 0C C6 7C 00+
   2732		  00 00	00 00 C6 00 7C+
   2733		  C6 C6	C6 C6 C6 C6 C6+
   2734		  7C 00	00 00 00 00 C6+
   2735		  00 C6	C6 C6 C6 C6 C6+
   2736		  C6 C6	7C 00 00 00 00+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 49
setup.asm



   2737		  66 3C	00 7E 7E 5A 18+
   2738		  18 18	18 18 3C 00 00+
   2739		  00 00	00 06
1  2740	    1BF2  12 34	30 FC 30 30 30+			 db									    +
   2741		  30 36	1C 00 00 00 00+	 "40ü00006      ðdlxpààbfþ          Æl8lÆ       l8 |ÆÀÀÀÆ|     0` x|ÌÌÌv     0 8< 
   2742		  00 00	F0 64 6C 78 70+	     0` |ÆÆÆÆÆ|     0` ÌÌÌÌÌÌv      8lÆÆþÆÆÆ"
   2743		  E0 E0	62 66 FE 00 00+
   2744		  00 00	00 00 00 00 00+
   2745		  00 C6	6C 38 6C C6 00+
   2746		  00 00	00 00 00 00 6C+
   2747		  38 00	7C C6 C0 C0 C0+
   2748		  C6 7C	00 00 00 00 00+
   2749		  18 30	60 00 78 0C 7C+
   2750		  CC CC	CC 76 00 00 00+
   2751		  00 00	0C 18 30 00 38+
   2752		  18 18	18 18 18 3C 00+
   2753		  00 00	00 00 18 30 60+
   2754		  00 7C	C6 C6 C6 C6 C6+
   2755		  7C 00	00 00 00 00 18+
   2756		  30 60	00 CC CC CC CC+
   2757		  CC CC	76 00 00 00 00+
   2758		  00 00	10 38 6C C6 C6+
   2759		  FE C6	C6 C6
1  2760	    1C7B  C6 18	30 1E 00 00 00+			 db									    +
   2761		  00 00	00 78 0C 7C CC+	 "Æ0      x|ÌÌÌv0 l8 þÆŒ0`ÂÆþ      l8 þÌ0`Æþ      þfbhxh`bfþ0      |ÆþÀÀÆ|0`<       
   2762		  CC CC	76 18 30 1E 00+	            0 þÌ0`Æþ    f< <fÂÀÀÀÂf<        "
   2763		  6C 38	00 FE C6 8C 18+
   2764		  30 60	C2 C6 FE 00 00+
   2765		  00 00	00 00 6C 38 00+
   2766		  FE CC	18 30 60 C6 FE+
   2767		  00 00	00 00 00 00 FE+
   2768		  66 62	68 78 68 60 62+
   2769		  66 FE	18 30 1E 00 00+
   2770		  00 00	00 00 7C C6 FE+
   2771		  C0 C0	C6 7C 30 60 3C+
   2772		  00 00	00 00 00 00 00+
   2773		  00 00	00 00 00 00 00+
   2774		  00 00	00 00 0C 18 30+
   2775		  00 FE	CC 18 30 60 C6+
   2776		  FE 00	00 00 00 66 3C+
   2777		  00 3C	66 C2 C0 C0 C0+
   2778		  C2 66	3C 00 00 00 00+
   2779		  00 00	00 00
1  2780	    1D04  00 7C	C6 60 38 0C C6+			 db									    +
   2781		  7C 18	0C 78 00 00 00+	 " |Æ`8Æ|x      6lØl6           l66l      DDDDDDDDUªUªUªUªUªUªUªUªÝwÝwÝwÝwÝwÝwÝwÝ
   2782		  00 00	00 36 6C D8 6C+	 wø0 8lÆÆþÆÆÆ "
   2783		  36 00	00 00 00 00 00+
   2784		  00 00	00 00 00 6C 36+
   2785		  1B 36	6C 00 00 00 00+
   2786		  00 00	11 44 11 44 11+
   2787		  44 11	44 11 44 11 44+
   2788		  11 44	11 44 55 AA 55+
   2789		  AA 55	AA 55 AA 55 AA+
   2790		  55 AA	55 AA 55 AA DD+
   2791		  77 DD	77 DD 77 DD 77+
   2792		  DD 77	DD 77 DD 77 DD+
   2793		  77 18	18 18 18 18 18+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 50
setup.asm



   2794		  18 18	18 18 18 18 18+
   2795		  18 18	18 18 18 18 18+
   2796		  18 18	18 F8 18 18 18+
   2797		  18 18	18 18 18 18 30+
   2798		  00 10	38 6C C6 C6 FE+
   2799		  C6 C6	C6 00
1  2800	    1D8D  00 00	00 38 6C 00 10+			 db									    +
   2801		  38 6C	C6 C6 FE C6 C6+	 "   8l 8lÆÆþÆÆÆ    l8 þfbhxhbfþ      |ÆÆ`8ÆÆ|x 66666öö666666666666666666666666     þö
   2802		  C6 00	00 00 00 6C 38+	 6666666666666öþ         þ†0`ÂÆþ       þ"
   2803		  00 FE	66 62 68 78 68+
   2804		  62 66	FE 00 00 00 00+
   2805		  00 00	7C C6 C6 60 38+
   2806		  0C 06	C6 C6 7C 18 0C+
   2807		  78 00	36 36 36 36 36+
   2808		  F6 06	F6 36 36 36 36+
   2809		  36 36	36 36 36 36 36+
   2810		  36 36	36 36 36 36 36+
   2811		  36 36	36 36 36 36 00+
   2812		  00 00	00 00 FE 06 F6+
   2813		  36 36	36 36 36 36 36+
   2814		  36 36	36 36 36 36 F6+
   2815		  06 FE	00 00 00 00 00+
   2816		  00 00	00 18 18 00 FE+
   2817		  86 0C	18 30 60 C2 C6+
   2818		  FE 00	00 00 00 00 00+
   2819		  18 18	00 FE
1  2820	    1E16  CC 18	30 60 C6 FE 00+			 db									    +
   2821		  00 00	00 00 00 00 00+	 "Ì0`Æþ           ø        ÿ               ÿ 
   2822		  00 00	00 F8 18 18 18+	       ÿ        ÿÆ| 8lÆÆþÆÆÆ   "
   2823		  18 18	18 18 18 18 18+
   2824		  18 18	18 18 18 1F 00+
   2825		  00 00	00 00 00 00 00+
   2826		  18 18	18 18 18 18 18+
   2827		  FF 00	00 00 00 00 00+
   2828		  00 00	00 00 00 00 00+
   2829		  00 00	FF 18 18 18 18+
   2830		  18 18	18 18 18 18 18+
   2831		  18 18	18 18 1F 18 18+
   2832		  18 18	18 18 18 18 00+
   2833		  00 00	00 00 00 00 FF+
   2834		  00 00	00 00 00 00 00+
   2835		  00 18	18 18 18 18 18+
   2836		  18 FF	18 18 18 18 18+
   2837		  18 18	18 C6 7C 00 10+
   2838		  38 6C	C6 C6 FE C6 C6+
   2839		  C6 00	00 00
1  2840	    1E9F  00 00	00 C6 7C 00 78+			 db									    +
   2841		  0C 7C	CC CC CC 76 00+	 "   Æ| x|ÌÌÌv    6666670?             ?076666666666666÷ ÿ             ÿ ÷666666666666670766
   2842		  00 00	00 36 36 36 36+	 666666     ÿ ÿ        66666÷ ÷66666666     Æ|Æ"
   2843		  36 37	30 3F 00 00 00+
   2844		  00 00	00 00 00 00 00+
   2845		  00 00	00 3F 30 37 36+
   2846		  36 36	36 36 36 36 36+
   2847		  36 36	36 36 36 F7 00+
   2848		  FF 00	00 00 00 00 00+
   2849		  00 00	00 00 00 00 00+
   2850		  FF 00	F7 36 36 36 36+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 51
setup.asm



   2851		  36 36	36 36 36 36 36+
   2852		  36 36	37 30 37 36 36+
   2853		  36 36	36 36 36 36 00+
   2854		  00 00	00 00 FF 00 FF+
   2855		  00 00	00 00 00 00 00+
   2856		  00 36	36 36 36 36 F7+
   2857		  00 F7	36 36 36 36 36+
   2858		  36 36	36 00 00 00 00+
   2859		  00 C6	7C C6
1  2860	    1F28  C6 C6	7C C6 00 00 00+			 db									    +
   2861		  00 00	00 0C 0C 7E 0C+	 "ÆÆ|Æ      ~<lÌÌÌv      ølfföffflø    l8 ølffffflø    l  þfbhxhbfþ      
   2862		  3C 6C	CC CC CC 76 00+
   2863		  00 00	00 00 00 F8 6C+
   2864		  66 66	F6 66 66 66 6C+
   2865		  F8 00	00 00 00 6C 38+
   2866		  00 F8	6C 66 66 66 66+
   2867		  66 6C	F8 00 00 00 00+
   2868		  6C 00	00 FE 66 62 68+
   2869		  78 68	62 66 FE 00 00+
   2870		  00 00	00 00 1D
*Warning* .\EGA.852(26)	Missing	end quote
1  2871	    1F73  00 66	3C 00 7C C6 FE+			 db									    +
   2872		  C0 C0	C6 7C 00 00 00+	 " f< |ÆþÀÀÆ|    ø               ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ       ÿÿÿÿÿÿÿÿÿ  ~~Z<
   2873		  00 18	18 18 18 18 18+	 x 8l8 ÆÆÆÆÆÆÆ|    ÿÿÿÿÿÿÿ          |ÆÆÆÆÆÆ"
   2874		  18 F8	00 00 00 00 00+
   2875		  00 00	00 00 00 00 00+
   2876		  00 00	00 1F 18 18 18+
   2877		  18 18	18 18 18 FF FF+
   2878		  FF FF	FF FF FF FF FF+
   2879		  FF FF	FF FF FF FF FF+
   2880		  00 00	00 00 00 00 00+
   2881		  FF FF	FF FF FF FF FF+
   2882		  FF FF	00 00 7E 7E 5A+
   2883		  18 18	18 18 18 18 3C+
   2884		  18 0C	78 00 38 6C 38+
   2885		  00 C6	C6 C6 C6 C6 C6+
   2886		  C6 7C	00 00 00 00 FF+
   2887		  FF FF	FF FF FF FF 00+
   2888		  00 00	00 00 00 00 00+
   2889		  00 0C	18 00 7C C6 C6+
   2890		  C6 C6	C6 C6
1  2891	    1FFC  C6 7C	00 00 00 00 00+			 db									    +
   2892		  00 78	CC CC CC D8 CC+	 "Æ|      xÌÌÌØÌÆÆÆÌ    8l |ÆÆÆÆÆÆÆ|     ÆæöþÞÎÆÆÆ     0 Üffffff      l8 Üffffff    l8 |Æ
   2893		  C6 C6	C6 CC 00 00 00+	 À`8Æ|      l8 |Æ`8Æ|    0 üfff|lffö    0 "
   2894		  00 38	6C 00 7C C6 C6+
   2895		  C6 C6	C6 C6 C6 7C 00+
   2896		  00 00	00 0C 18 00 C6+
   2897		  E6 F6	FE DE CE C6 C6+
   2898		  C6 00	00 00 00 00 0C+
   2899		  18 30	00 DC 66 66 66+
   2900		  66 66	66 00 00 00 00+
   2901		  00 00	6C 38 00 DC 66+
   2902		  66 66	66 66 66 00 00+
   2903		  00 00	6C 38 00 7C C6+
   2904		  C0 60	38 0C 06 C6 7C+
   2905		  00 00	00 00 00 00 6C+
   2906		  38 00	7C C6 60 38 0C+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 52
setup.asm



   2907		  C6 7C	00 00 00 00 18+
   2908		  30 00	FC 66 66 66 7C+
   2909		  6C 66	66 F6 00 00 00+
   2910		  00 18	30 00
1  2911	    2085  C6 C6	C6 C6 C6 C6 C6+			 db									    +
   2912		  C6 7C	00 00 00 00 00+	 "ÆÆÆÆÆÆÆÆ|     0 Üvf```ð    6l ÆÆÆÆÆÆÆÆ|     0 ÆÆÆÆÆÆ~ø  ffff<<      00ü00006
   2913		  0C 18	30 00 DC 76 66+	 x  0                   ~         6lØ        "
   2914		  60 60	60 F0 00 00 00+
   2915		  00 36	6C 00 C6 C6 C6+
   2916		  C6 C6	C6 C6 C6 7C 00+
   2917		  00 00	00 00 0C 18 30+
   2918		  00 C6	C6 C6 C6 C6 C6+
   2919		  7E 06	0C F8 00 0C 18+
   2920		  00 66	66 66 66 3C 18+
   2921		  18 18	3C 00 00 00 00+
   2922		  00 00	10 30 30 FC 30+
   2923		  30 30	30 36 1C 18 0C+
   2924		  78 00	00 0C 18 30 00+
   2925		  00 00	00 00 00 00 00+
   2926		  00 00	00 00 00 00 00+
   2927		  00 00	00 00 7E 00 00+
   2928		  00 00	00 00 00 00 00+
   2929		  36 6C	D8 00 00 00 00+
   2930		  00 00	00 00
1  2931	    210E  00 00	00 00 00 00 00+			 db									    +
   2932		  00 00	00 00 00 00 00+	 "                0`<  l8              Æ|              |Æ`8lÆÆl8Æ|        ~             
   2933		  00 00	30 60 3C 00 00+	      x  8ll8            ll                "
   2934		  6C 38	00 00 00 00 00+
   2935		  00 00	00 00 00 00 00+
   2936		  00 00	C6 7C 00 00 00+
   2937		  00 00	00 00 00 00 00+
   2938		  00 00	00 00 7C C6 60+
   2939		  38 6C	C6 C6 6C 38 0C+
   2940		  C6 7C	00 00 00 00 00+
   2941		  00 00	18 18 00 7E 00+
   2942		  18 18	00 00 00 00 00+
   2943		  00 00	00 00 00 00 00+
   2944		  00 00	00 00 00 18 0C+
   2945		  78 00	00 38 6C 6C 38+
   2946		  00 00	00 00 00 00 00+
   2947		  00 00	00 00 00 6C 6C+
   2948		  00 00	00 00 00 00 00+
   2949		  00 00	00 00 00 00 00+
   2950		  18 18	00 00
1  2951	    2197  00 00	00 00 00 00 00+			 db									    +
   2952		  00 00	00 00 00 00 36+	 "             6l ÌÌÌÌÌÌv    l8 üfff|lffö      l8 Üvf```ð        |||||||                    "
   2953		  6C 00	CC CC CC CC CC+
   2954		  CC 76	00 00 00 00 6C+
   2955		  38 00	FC 66 66 66 7C+
   2956		  6C 66	66 F6 00 00 00+
   2957		  00 00	00 6C 38 00 DC+
   2958		  76 66	60 60 60 F0 00+
   2959		  00 00	00 00 00 00 00+
   2960		  7C 7C	7C 7C 7C 7C 7C+
   2961		  00 00	00 00 00 00 00+
   2962		  00 00	00 00 00 00 00+
   2963		  00 00	00 00 00 00
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 53
setup.asm



1  2964
   2965					 include .\types.asm
1  2966					 include .\DiskCnst.asm
2  2967	    21F1  50 72	6F 67 72 61 6D+	 INT00Err:	 db	 "Program se pokusil pýi vykon n¡ aritmetick‚ operace o	dØlØn¡	    +
   2968		  20 73	65 20 70 6F 6B+	 nulou.",0
   2969		  75 73	69 6C 20 70 FD+
   2970		  69 20	76 79 6B 6F 6E+
   2971		  A0 6E	A1 20 61 72 69+
   2972		  74 6D	65 74 69 63 6B+
   2973		  82 20	6F 70 65 72 61+
   2974		  63 65	20 6F 20 64 D8+
   2975		  6C D8	6E A1 20 6E 75+
   2976		  6C 6F	75 2E 00
2  2977	    2235  50 FD	69 20 76 6F 6C+	 ErrA1:		 db	 "Pýi vol n¡ funkce % programem	% doçlo	k chybØ:",0
   2978		  A0 6E	A1 20 66 75 6E+
   2979		  6B 63	65 20 25 20 70+
   2980		  72 6F	67 72 61 6D 65+
   2981		  6D 20	25 20 64 6F E7+
   2982		  6C 6F	20 6B 20 63 68+
   2983		  79 62	D8 3A 00
2  2984	    2264  50 FD	69 20 70 72 A0+	 ErrA2:		 db	 "Pýi pr ci syst‚mu ATREX doçlo	k vnitýn¡ chybØ:",0
   2985		  63 69	20 73 79 73 74+
   2986		  82 6D	75 20 41 54 52+
   2987		  45 58	20 64 6F E7 6C+
   2988		  6F 20	6B 20 76 6E 69+
   2989		  74 FD	6E A1 20 63 68+
   2990		  79 62	D8 3A 00
2  2991	    2293  43 68	79 62 61 20 76+	 ErrB1:		 db	 "Chyba	v pý¡stupu na zaý¡zen¡ %",0
   2992		  20 70	FD A1 73 74 75+
   2993		  70 75	20 6E 61 20 7A+
   2994		  61 FD	A1 7A 65 6E A1+
   2995		  20 25	00
2  2996	    22B2  54 69	73 6B A0 72 6E+	 ErrB2:		 db	 "Tisk rna na LPT% nem 	pap¡r",0
   2997		  61 20	6E 61 20 4C 50+
   2998		  54 25	20 6E 65 6D A0+
   2999		  20 70	61 70 A1 72 00
2  3000	    22CE  50 FD	69 20 64 D8 6C+	 ErrB3:		 db	 "Pýi dØlen¡ byl zaznamen n dØlitel roven Ÿ¡slu	nula",0
   3001		  65 6E	A1 20 62 79 6C+
   3002		  20 7A	61 7A 6E 61 6D+
   3003		  65 6E	A0 6E 20 64 D8+
   3004		  6C 69	74 65 6C 20 72+
   3005		  6F 76	65 6E 20 9F A1+
   3006		  73 6C	75 20 6E 75 6C+
   3007		  61 00
2  3008	    2301  20 20	20 53 74 69 73+	 ErrK1:		 db	 "   StisknØte ",0
   3009		  6B 6E	D8 74 65 20 00
2  3010	    230F  20 45	6E 74 65 72 2D+	 ErrK2:		 db	 " Enter-zruçit	",0
   3011		  7A 72	75 E7 69 74 20+
   3012		  00
2  3013	    231E  20 45	73 63 2D 6F 70+	 ErrK3:		 db	 " Esc-opakovat	",0
   3014		  61 6B	6F 76 61 74 20+
   3015		  00
2  3016	    232D  20 45	73 63 2D 7A 72+	 ErrK4:		 db	 " Esc-zruçit ",0
   3017		  75 E7	69 74 20 00
2  3018	    233A  20 45	6E 74 65 72 2D+	 ErrK5:		 db	 " Enter-opakovat ",0
   3019		  6F 70	61 6B 6F 76 61+
   3020		  74 20	00
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 54
setup.asm



2  3021	    234B  20 72	2D 72 65 67 69+	 ErrK6:		 db	 " r-registry ",0
   3022		  73 74	72 79 20 00
2  3023	    2358  20 68	2D FD 65 E7 65+	 ErrK7:		 db	 " h-ýeçen¡ ",0
   3024		  6E A1	20 00
2  3025	    2363  0D 0A	00		 ErrX0:		 db	 13,10,0
2  3026	    2366  20 6E	65 6C 7A 65 20+	 ErrH0:		 db	 " nelze nal‚zt	§ dn‚ ýeçen¡ odpov¡daj¡c¡ho probl‚mu",0
   3027		  6E 61	6C 82 7A 74 20+
   3028		  A7 A0	64 6E 82 20 FD+
   3029		  65 E7	65 6E A1 20 6F+
   3030		  64 70	6F 76 A1 64 61+
   3031		  6A A1	63 A1 68 6F 20+
   3032		  70 72	6F 62 6C 82 6D+
   3033		  75 00
2  3034	    2399  20 56	79 9F 69 73 74+	 ErrH1:		 db	 " VyŸistØte disketovou	mechaniku",0
   3035		  D8 74	65 20 64 69 73+
   3036		  6B 65	74 6F 76 6F 75+
   3037		  20 6D	65 63 68 61 6E+
   3038		  69 6B	75 00
2  3039	    23B9  20 56	79 70 6E D8 74+	 ErrH2:		 db	 " VypnØte poŸ¡taŸ, vypojte pý¡vodn¡ kabely a opØt je zapojte",13,  +
   3040		  65 20	70 6F 9F A1 74+	 10," na sv‚ m¡sto",0
   3041		  61 9F	2C 20 76 79 70+
   3042		  6F 6A	74 65 20 70 FD+
   3043		  A1 76	6F 64 6E A1 20+
   3044		  6B 61	62 65 6C 79 20+
   3045		  61 20	6F 70 D8 74 20+
   3046		  6A 65	20 7A 61 70 6F+
   3047		  6A 74	65 0D 0A 20 6E+
   3048		  61 20	73 76 82 20 6D+
   3049		  A1 73	74 6F 00
2  3050	    2404  20 56	68 6F 64 6E EC+	 ErrH3:		 db	 " Vhodnìm programem proveÔte kontrolu povrchu na disku",0
   3051		  6D 20	70 72 6F 67 72+
   3052		  61 6D	65 6D 20 70 72+
   3053		  6F 76	65 D4 74 65 20+
   3054		  6B 6F	6E 74 72 6F 6C+
   3055		  75 20	70 6F 76 72 63+
   3056		  68 75	20 6E 61 20 64+
   3057		  69 73	6B 75 00
2  3058	    243A  20 5A	6B 75 73 74 65+	 ErrH4:		 db	 " Zkuste znovu",0
   3059		  20 7A	6E 6F 76 75 00
2  3060	    2448  20 56	6C 6F A7 74 65+	 ErrH5:		 db	 " Vlo§te pap¡r	do tisk rny a zkuste znovu",0
   3061		  20 70	61 70 A1 72 20+
   3062		  64 6F	20 74 69 73 6B+
   3063		  A0 72	6E 79 20 61 20+
   3064		  7A 6B	75 73 74 65 20+
   3065		  7A 6E	6F 76 75 00
2  3066
2  3067	    2471  3F 3F	3F 3F 3F 3F 3F+	 DiskFunc_??	 db	 "??????????", 0
   3068		  3F 3F	3F 00
2  3069	    247C  52 65	73 65 74 20 64+	 DiskFunc_00	 db	 "Reset	disku a	rekalibrace ýadiŸe", 0
   3070		  69 73	6B 75 20 61 20+
   3071		  72 65	6B 61 6C 69 62+
   3072		  72 61	63 65 20 FD 61+
   3073		  64 69	9F 65 00
2  3074	    249D  56 72	61 9C 20 73 74+	 DiskFunc_01	 db	 "Vraœ stav posledn¡ operace", 0
   3075		  61 76	20 70 6F 73 6C+
   3076		  65 64	6E A1 20 6F 70+
   3077		  65 72	61 63 65 00
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 55
setup.asm



2  3078	    24B8  AC 74	69 20 73 65 6B+	 DiskFunc_02	 db	 "¬ti sektory",	0
   3079		  74 6F	72 79 00
2  3080	    24C4  5A 61	70 69 E7 20 73+	 DiskFunc_03	 db	 "Zapiç	sektory", 0
   3081		  65 6B	74 6F 72 79 00
2  3082	    24D2  54 65	73 74 75 6A 20+	 DiskFunc_04	 db	 "Testuj sektory (veryfikace)",	0
   3083		  73 65	6B 74 6F 72 79+
   3084		  20 28	76 65 72 79 66+
   3085		  69 6B	61 63 65 29 00
2  3086	    24EE  46 6F	72 6D A0 74 75+	 DiskFunc_05	 db	 "Form tuj stopu", 0
   3087		  6A 20	73 74 6F 70 75+
   3088		  00
2  3089	    24FD  46 6F	72 6D A0 74 75+	 DiskFunc_06	 db	 "Form tuj stopu a nastav pý¡znak vadnìch sektor…", 0
   3090		  6A 20	73 74 6F 70 75+
   3091		  20 61	20 6E 61 73 74+
   3092		  61 76	20 70 FD A1 7A+
   3093		  6E 61	6B 20 76 61 64+
   3094		  6E EC	63 68 20 73 65+
   3095		  6B 74	6F 72 85 00
2  3096	    252D  46 6F	72 6D A0 74 75+	 DiskFunc_07	 db	 "Form tuj disk	poŸ¡naje zadanou stopou", 0
   3097		  6A 20	64 69 73 6B 20+
   3098		  70 6F	9F A1 6E 61 6A+
   3099		  65 20	7A 61 64 61 6E+
   3100		  6F 75	20 73 74 6F 70+
   3101		  6F 75	00
2  3102	    2553  56 72	61 9C 20 69 6E+	 DiskFunc_08	 db	 "Vraœ informace o disku", 0
   3103		  66 6F	72 6D 61 63 65+
   3104		  20 6F	20 64 69 73 6B+
   3105		  75 00
2  3106	    256A  49 6E	69 63 69 61 6C+	 DiskFunc_09	 db	 "Inicializace tabulky diskovìch parametr…", 0
   3107		  69 7A	61 63 65 20 74+
   3108		  61 62	75 6C 6B 79 20+
   3109		  64 69	73 6B 6F 76 EC+
   3110		  63 68	20 70 61 72 61+
   3111		  6D 65	74 72 85 00
2  3112	    2593  44 6C	6F 75 68 82 20+	 DiskFunc_0a	 db	 "Dlouh‚ Ÿten¡", 0
   3113		  9F 74	65 6E A1 00
2  3114	    25A0  44 6C	6F 75 68 EC 20+	 DiskFunc_0b	 db	 "Dlouhì z pis", 0
   3115		  7A A0	70 69 73 00
2  3116	    25AD  56 79	73 74 61 76 65+	 DiskFunc_0c	 db	 "Vystaven¡ hlaviŸek na	stopu",	0
   3117		  6E A1	20 68 6C 61 76+
   3118		  69 9F	65 6B 20 6E 61+
   3119		  20 73	74 6F 70 75 00
2  3120	    25C9  41 6C	74 65 72 6E 61+	 DiskFunc_0d	 db	 "Alternativn¡ reset disku", 0
   3121		  74 69	76 6E A1 20 72+
   3122		  65 73	65 74 20 64 69+
   3123		  73 6B	75 00
2  3124	    25E2  44 69	61 67 6E 6F 73+	 DiskFunc_0e	 db	 "Diagnostika disku pro	PS/2 nebo Ÿten¡	z vyrovn vac¡ pamØti	    +
   3125		  74 69	6B 61 20 64 69+	 ýadiŸe", 0
   3126		  73 6B	75 20 70 72 6F+
   3127		  20 50	53 2F 32 20 6E+
   3128		  65 62	6F 20 9F 74 65+
   3129		  6E A1	20 7A 20 76 79+
   3130		  72 6F	76 6E A0 76 61+
   3131		  63 A1	20 70 61 6D D8+
   3132		  74 69	20 FD 61 64 69+
   3133		  9F 65	00
2  3134	    2624  44 69	61 67 6E 6F 73+	 DiskFunc_0f	 db	 "Diagnostika disku pro	PS/2 nebo z pis	do vyrovn vac¡ pamØti	    +
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 56
setup.asm



   3135		  74 69	6B 61 20 64 69+	 ýadiŸe", 0
   3136		  73 6B	75 20 70 72 6F+
   3137		  20 50	53 2F 32 20 6E+
   3138		  65 62	6F 20 7A A0 70+
   3139		  69 73	20 64 6F 20 76+
   3140		  79 72	6F 76 6E A0 76+
   3141		  61 63	A1 20 70 61 6D+
   3142		  D8 74	69 20 FD 61 64+
   3143		  69 9F	65 00
2  3144	    2667  54 65	73 74 20 70 FD+	 DiskFunc_10	 db	 "Test pýipravenosti disku", 0
   3145		  69 70	72 61 76 65 6E+
   3146		  6F 73	74 69 20 64 69+
   3147		  73 6B	75 00
2  3148	    2680  52 65	6B 61 6C 69 62+	 DiskFunc_11	 db	 "Rekalibrace disku", 0
   3149		  72 61	63 65 20 64 69+
   3150		  73 6B	75 00
2  3151	    2692  44 69	61 67 6E 6F 73+	 DiskFunc_12	 db	 "Diagnostika",	0
   3152		  74 69	6B 61 00
2  3153	    269E  44 69	61 67 6E 6F 73+	 DiskFunc_13	 db	 "Diagnostika disku", 0
   3154		  74 69	6B 61 20 64 69+
   3155		  73 6B	75 00
2  3156	    26B0  44 69	61 67 6E 6F 73+	 DiskFunc_14	 db	 "Diagnostika ýadiŸe", 0
   3157		  74 69	6B 61 20 FD 61+
   3158		  64 69	9F 65 00
2  3159	    26C3  56 72	61 9C 20 74 79+	 DiskFunc_15	 db	 "Vraœ typ disku", 0
   3160		  70 20	64 69 73 6B 75+
   3161		  00
2  3162	    26D2  56 72	61 9C 20 73 74+	 DiskFunc_16	 db	 "Vraœ stav vìmØny", 0
   3163		  61 76	20 76 EC 6D D8+
   3164		  6E 79	00
2  3165	    26E3  4E 61	73 74 61 76 20+	 DiskFunc_17	 db	 "Nastav typ disku", 0
   3166		  74 79	70 20 64 69 73+
   3167		  6B 75	00
2  3168	    26F4  4E 61	73 74 61 76 20+	 DiskFunc_18	 db	 "Nastav typ m‚dia pro form tov n¡", 0
   3169		  74 79	70 20 6D 82 64+
   3170		  69 61	20 70 72 6F 20+
   3171		  66 6F	72 6D A0 74 6F+
   3172		  76 A0	6E A1 00
2  3173	    2715  5A 61	70 61 72 6B 75+	 DiskFunc_19	 db	 "Zaparkuj hlavy", 0
   3174		  6A 20	68 6C 61 76 79+
   3175		  00
2  3176	    2724  46 6F	72 6D A0 74 75+	 DiskFunc_1a	 db	 "Form tuj jednotku", 0
   3177		  6A 20	6A 65 64 6E 6F+
   3178		  74 6B	75 00
2  3179	    2736  56 72	61 9C 20 68 6C+	 DiskFunc_1b	 db	 "Vraœ hlaviŸku	z vìroby", 0
   3180		  61 76	69 9F 6B 75 20+
   3181		  7A 20	76 EC 72 6F 62+
   3182		  79 00
2  3183	    274D  56 72	61 9C 20 6B 6F+	 DiskFunc_1c0A	 db	 "Vraœ konfiguraci zaý¡zen¡", 0
   3184		  6E 66	69 67 75 72 61+
   3185		  63 69	20 7A 61 FD A1+
   3186		  7A 65	6E A1 00
2  3187	    2767  56 72	61 9C 20 6B 6F+	 DiskFunc_1c0B	 db	 "Vraœ konfiguraci ýadiŸe", 0
   3188		  6E 66	69 67 75 72 61+
   3189		  63 69	20 FD 61 64 69+
   3190		  9F 65	00
2  3191	    277F  56 72	61 9C 20 69 6E+	 DiskFunc_1c0C	 db	 "Vraœ informaci o POS", 0
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 57
setup.asm



   3192		  66 6F	72 6D 61 63 69+
   3193		  20 6F	20 50 4F 53 00
2  3194	    2794  54 72	61 6E 73 66 6F+	 DiskFunc_1c0E	 db	 "Transformuj RBA na ABA", 0
   3195		  72 6D	75 6A 20 52 42+
   3196		  41 20	6E 61 20 41 42+
   3197		  41 00
2  3198
2  3199	    27AB  4E 65	64 6F E7 6C 6F+	 DiskError_00	 db	 "Nedoçlo k § dn‚ chybØ",0
   3200		  20 6B	20 A7 A0 64 6E+
   3201		  82 20	63 68 79 62 D8+
   3202		  00
2  3203	    27C1  4E 65	70 6C 61 74 6E+	 DiskError_01	 db	 "Neplatnì po§adavek na	ýadiŸ %",0
   3204		  EC 20	70 6F A7 61 64+
   3205		  61 76	65 6B 20 6E 61+
   3206		  20 FD	61 64 69 9F 20+
   3207		  25 00
2  3208	    27DF  43 68	79 62 6E A0 20+	 DiskError_02	 db	 "Chybn  adresov  znaŸka sektoru disku %",0
   3209		  61 64	72 65 73 6F 76+
   3210		  A0 20	7A 6E 61 9F 6B+
   3211		  61 20	73 65 6B 74 6F+
   3212		  72 75	20 64 69 73 6B+
   3213		  75 20	25 00
2  3214	    2806  50 6F	6B 75 73 20 6F+	 DiskError_03	 db	 "Pokus	o z pis	na disk	% chr nØnì proti z pisu",0
   3215		  20 7A	A0 70 69 73 20+
   3216		  6E 61	20 64 69 73 6B+
   3217		  20 25	20 63 68 72 A0+
   3218		  6E D8	6E EC 20 70 72+
   3219		  6F 74	69 20 7A A0 70+
   3220		  69 73	75 00
2  3221	    2834  53 65	6B 74 6F 72 20+	 DiskError_04	 db	 "Sektor na disku % nenalezen",0
   3222		  6E 61	20 64 69 73 6B+
   3223		  75 20	25 20 6E 65 6E+
   3224		  61 6C	65 7A 65 6E 00
2  3225	    2850  43 68	79 62 61 20 70+	 DiskError_05	 db	 "Chyba	pýi resetov n¡ ýadiŸe %",0
   3226		  FD 69	20 72 65 73 65+
   3227		  74 6F	76 A0 6E A1 20+
   3228		  FD 61	64 69 9F 65 20+
   3229		  25 00
2  3230	    286E  44 69	73 6B 20 25 20+	 DiskError_06	 db	 "Disk % byl vymØnØn",0
   3231		  62 79	6C 20 76 79 6D+
   3232		  D8 6E	D8 6E 00
2  3233	    2881  43 68	79 62 6E EC 20+	 DiskError_07	 db	 "Chybnì parametr pýi pr ci s diskem %",0
   3234		  70 61	72 61 6D 65 74+
   3235		  72 20	70 FD 69 20 70+
   3236		  72 A0	63 69 20 73 20+
   3237		  64 69	73 6B 65 6D 20+
   3238		  25 00
2  3239	    28A6  43 68	79 62 61 20 44+	 DiskError_08	 db	 "Chyba	DMA (overrun)na	disku %",0
   3240		  4D 41	20 28 6F 76 65+
   3241		  72 72	75 6E 29 6E 61+
   3242		  20 64	69 73 6B 75 20+
   3243		  25 00
2  3244	    28C4  50 FD	65 74 65 9F 65+	 DiskError_09	 db	 "PýeteŸen¡ DMA	pýes 64KB pýi pr ci s diskem %",0
   3245		  6E A1	20 44 4D 41 20+
   3246		  70 FD	65 73 20 36 34+
   3247		  4B 42	20 70 FD 69 20+
   3248		  70 72	A0 63 69 20 73+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 58
setup.asm



   3249		  20 64	69 73 6B 65 6D+
   3250		  20 25	00
2  3251	    28F1  55 20	70 65 76 6E 82+	 DiskError_0A	 db	 "U pevn‚ho disku % detekov n chybnì sektor",0
   3252		  68 6F	20 64 69 73 6B+
   3253		  75 20	25 20 64 65 74+
   3254		  65 6B	6F 76 A0 6E 20+
   3255		  63 68	79 62 6E EC 20+
   3256		  73 65	6B 74 6F 72 00
2  3257	    291B  55 20	70 65 76 6E 82+	 DiskError_0B	 db	 "U pevn‚ho disku % detekov na chybn  stopa",0
   3258		  68 6F	20 64 69 73 6B+
   3259		  75 20	25 20 64 65 74+
   3260		  65 6B	6F 76 A0 6E 61+
   3261		  20 63	68 79 62 6E A0+
   3262		  20 73	74 6F 70 61 00
2  3263	    2945  4E 65	70 6F 64 70 6F+	 DiskError_0C	 db	 "Nepodporovan 	stopa na disku %",0
   3264		  72 6F	76 61 6E A0 20+
   3265		  73 74	6F 70 61 20 6E+
   3266		  61 20	64 69 73 6B 75+
   3267		  20 25	00
2  3268	    2964  43 68	79 62 6E EC 20+	 DiskError_0D	 db	 "Chybnì poŸet sektor… pýi form tov n¡ pevn‚ho disku %",0
   3269		  70 6F	9F 65 74 20 73+
   3270		  65 6B	74 6F 72 85 20+
   3271		  70 FD	69 20 66 6F 72+
   3272		  6D A0	74 6F 76 A0 6E+
   3273		  A1 20	70 65 76 6E 82+
   3274		  68 6F	20 64 69 73 6B+
   3275		  75 20	25 00
2  3276	    2999  55 20	70 65 76 6E 82+	 DiskError_0E	 db	 "U pevn‚ho disku % detekov na adresov 	znaŸka kontroln¡ch dat",0
   3277		  68 6F	20 64 69 73 6B+
   3278		  75 20	25 20 64 65 74+
   3279		  65 6B	6F 76 A0 6E 61+
   3280		  20 61	64 72 65 73 6F+
   3281		  76 A0	20 7A 6E 61 9F+
   3282		  6B 61	20 6B 6F 6E 74+
   3283		  72 6F	6C 6E A1 63 68+
   3284		  20 64	61 74 00
2  3285	    29D6  55 20	70 65 76 6E 82+	 DiskError_0F	 db	 "U pevn‚ho disku % doçlo k chybØ v rozhodov n¡	DMA",0
   3286		  68 6F	20 64 69 73 6B+
   3287		  75 20	25 20 64 6F E7+
   3288		  6C 6F	20 6B 20 63 68+
   3289		  79 62	D8 20 76 20 72+
   3290		  6F 7A	68 6F 64 6F 76+
   3291		  A0 6E	A1 20 44 4D 41+
   3292		  00
2  3293	    2A08  E6 70	61 74 6E A0 20+	 DiskError_10	 db	 "æpatn  parita	CRC/ECC	na disku %",0
   3294		  70 61	72 69 74 61 20+
   3295		  43 52	43 2F 45 43 43+
   3296		  20 6E	61 20 64 69 73+
   3297		  6B 75	20 25 00
2  3298	    2A29  43 68	79 62 6E A0 20+	 DiskError_11	 db	 "Chybn  data byla u pevn‚ho disku % opravena pomoc¡ ECC",0
   3299		  64 61	74 61 20 62 79+
   3300		  6C 61	20 75 20 70 65+
   3301		  76 6E	82 68 6F 20 64+
   3302		  69 73	6B 75 20 25 20+
   3303		  6F 70	72 61 76 65 6E+
   3304		  61 20	70 6F 6D 6F 63+
   3305		  A1 20	45 43 43 00
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 59
setup.asm



2  3306	    2A60  43 68	79 62 61 20 FD+	 DiskError_20	 db	 "Chyba	ýadiŸe %",0
   3307		  61 64	69 9F 65 20 25+
   3308		  00
2  3309	    2A6F  43 68	79 62 6E EC 20+	 DiskError_40	 db	 "Chybnì seek (chyba pýi vystavov n¡ hlaviŸek) na disku	%",0
   3310		  73 65	65 6B 20 28 63+
   3311		  68 79	62 61 20 70 FD+
   3312		  69 20	76 79 73 74 61+
   3313		  76 6F	76 A0 6E A1 20+
   3314		  68 6C	61 76 69 9F 65+
   3315		  6B 29	20 6E 61 20 64+
   3316		  69 73	6B 75 20 25 00
2  3317	    2AA7  44 69	73 6B 20 25 20+	 DiskError_80	 db	 "Disk % nen¡ pýipraven",0
   3318		  6E 65	6E A1 20 70 FD+
   3319		  69 70	72 61 76 65 6E+
   3320		  00
2  3321	    2ABD  50 65	76 6E EC 20 25+	 DiskError_0AA	 db	 "Pevnì	% disk nen¡ pýipraven",0
   3322		  20 64	69 73 6B 20 6E+
   3323		  65 6E	A1 20 70 FD 69+
   3324		  70 72	61 76 65 6E 00
2  3325	    2AD9  4E 65	7A 6E A0 6D A0+	 DiskError_0BB	 db	 "Nezn m  diskov  chyba	pýi pr ci s pevnìm diskem %",0
   3326		  20 64	69 73 6B 6F 76+
   3327		  A0 20	63 68 79 62 61+
   3328		  20 70	FD 69 20 70 72+
   3329		  A0 63	69 20 73 20 70+
   3330		  65 76	6E EC 6D 20 64+
   3331		  69 73	6B 65 6D 20 25+
   3332		  00
2  3333	    2B0B  55 20	70 65 76 6E 82+	 DiskError_0CC	 db	 "U pevn‚ho disku % doçlo k chybØ z pisu",0
   3334		  68 6F	20 64 69 73 6B+
   3335		  75 20	25 20 64 6F E7+
   3336		  6C 6F	20 6B 20 63 68+
   3337		  79 62	D8 20 7A A0 70+
   3338		  69 73	75 00
2  3339	    2B32  55 20	70 65 76 6E 82+	 DiskError_0E0	 db	 "U pevn‚ho disku % doçlo k chybØ stavov‚ho registru",0
   3340		  68 6F	20 64 69 73 6B+
   3341		  75 20	25 20 64 6F E7+
   3342		  6C 6F	20 6B 20 63 68+
   3343		  79 62	D8 20 73 74 61+
   3344		  76 6F	76 82 68 6F 20+
   3345		  72 65	67 69 73 74 72+
   3346		  75 00
2  3347	    2B65  55 20	70 65 76 6E 82+	 DiskError_0FF	 db	 "U pevn‚ho disku % byl	pou§it chybnì vìznam operace",0
   3348		  68 6F	20 64 69 73 6B+
   3349		  75 20	25 20 62 79 6C+
   3350		  20 70	6F 75 A7 69 74+
   3351		  20 63	68 79 62 6E EC+
   3352		  20 76	EC 7A 6E 61 6D+
   3353		  20 6F	70 65 72 61 63+
   3354		  65 00
2  3355	    2B98  50 FD	69 20 70 72 A0+	 DiskError_N	 db	 "Pýi pr ci s diskem % vznikl nezn mì chybovì k¢d %%",0
   3356		  63 69	20 73 20 64 69+
   3357		  73 6B	65 6D 20 25 20+
   3358		  76 7A	6E 69 6B 6C 20+
   3359		  6E 65	7A 6E A0 6D EC+
   3360		  20 63	68 79 62 6F 76+
   3361		  EC 20	6B A2 64 20 25+
   3362		  25 00
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 60
setup.asm



2  3363	    2BCB			 Bios_Disk_Func	 Label	 Word
2  3364	    2BCB  247Cr					 dw	 offset	DiskFunc_00
2  3365	    2BCD  249Dr					 dw	 offset	DiskFunc_01
2  3366	    2BCF  24B8r					 dw	 offset	DiskFunc_02
2  3367	    2BD1  24C4r					 dw	 offset	DiskFunc_03
2  3368	    2BD3  24D2r					 dw	 offset	DiskFunc_04
2  3369	    2BD5  24EEr					 dw	 offset	DiskFunc_05
2  3370	    2BD7  24FDr					 dw	 offset	DiskFunc_06
2  3371	    2BD9  252Dr					 dw	 offset	DiskFunc_07
2  3372	    2BDB  2553r					 dw	 offset	DiskFunc_08
2  3373	    2BDD  256Ar					 dw	 offset	DiskFunc_09
2  3374	    2BDF  2593r					 dw	 offset	DiskFunc_0a
2  3375	    2BE1  25A0r					 dw	 offset	DiskFunc_0b
2  3376	    2BE3  25ADr					 dw	 offset	DiskFunc_0c
2  3377	    2BE5  25C9r					 dw	 offset	DiskFunc_0d
2  3378	    2BE7  25E2r					 dw	 offset	DiskFunc_0e
2  3379	    2BE9  2624r					 dw	 offset	DiskFunc_0f
2  3380	    2BEB  2667r					 dw	 offset	DiskFunc_10
2  3381	    2BED  2680r					 dw	 offset	DiskFunc_11
2  3382	    2BEF  2692r					 dw	 offset	DiskFunc_12
2  3383	    2BF1  269Er					 dw	 offset	DiskFunc_13
2  3384	    2BF3  26B0r					 dw	 offset	DiskFunc_14
2  3385	    2BF5  26C3r					 dw	 offset	DiskFunc_15
2  3386	    2BF7  26D2r					 dw	 offset	DiskFunc_16
2  3387	    2BF9  26E3r					 dw	 offset	DiskFunc_17
2  3388	    2BFB  26F4r					 dw	 offset	DiskFunc_18
2  3389	    2BFD  2715r					 dw	 offset	DiskFunc_19
2  3390	    2BFF  2724r					 dw	 offset	DiskFunc_1a
2  3391	    2C01  2736r					 dw	 offset	DiskFunc_1b
2  3392	    2C03  274Dr					 dw	 offset	DiskFunc_1c0A
2  3393	    2C05  2767r					 dw	 offset	DiskFunc_1c0B
2  3394	    2C07  277Fr					 dw	 offset	DiskFunc_1c0C
2  3395	    2C09  2794r					 dw	 offset	DiskFunc_1c0E
2  3396	    2C0B			 Bios_Disk_Error Label	 Word
2  3397	    2C0B  27ABr					 dw	 offset	DiskError_00
2  3398	    2C0D  27C1r					 dw	 offset	DiskError_01
2  3399	    2C0F  27DFr					 dw	 offset	DiskError_02
2  3400	    2C11  2806r					 dw	 offset	DiskError_03
2  3401	    2C13  2834r					 dw	 offset	DiskError_04
2  3402	    2C15  2850r					 dw	 offset	DiskError_05
2  3403	    2C17  286Er					 dw	 offset	DiskError_06
2  3404	    2C19  2881r					 dw	 offset	DiskError_07
2  3405	    2C1B  28A6r					 dw	 offset	DiskError_08
2  3406	    2C1D  28C4r					 dw	 offset	DiskError_09
2  3407	    2C1F  28F1r					 dw	 offset	DiskError_0a
2  3408	    2C21  291Br					 dw	 offset	DiskError_0b
2  3409	    2C23  2945r					 dw	 offset	DiskError_0c
2  3410	    2C25  2964r					 dw	 offset	DiskError_0d
2  3411	    2C27  2999r					 dw	 offset	DiskError_0e
2  3412	    2C29  29D6r					 dw	 offset	DiskError_0f
2  3413	    2C2B  2A08r					 dw	 offset	DiskError_10
2  3414	    2C2D  2A29r					 dw	 offset	DiskError_11
2  3415	    2C2F  2A60r					 dw	 offset	DiskError_20
2  3416	    2C31  2A6Fr					 dw	 offset	DiskError_40
2  3417	    2C33  2AA7r					 dw	 offset	DiskError_80
2  3418	    2C35  2ABDr					 dw	 offset	DiskError_0AA
2  3419	    2C37  2AD9r					 dw	 offset	DiskError_0BB
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 61
setup.asm



2  3420	    2C39  2B0Br					 dw	 offset	DiskError_0CC
2  3421	    2C3B  2B32r					 dw	 offset	DiskError_0E0
2  3422	    2C3D  2B65r					 dw	 offset	DiskError_0FF
2  3423
2  3424					 ;8:5
2  3425	    2C3F  C9 CD	CD CD CD CD CD+	 PrintDiskError	 db									    +
   3426		  CD CD	CD CD CD CD CD+	 "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»", 0Dh, 0Ah
   3427		  CD CD	CD CD CD CD CD+
   3428		  CD CD	CD CD CD CD CD+
   3429		  CD CD	CD CD CD CD CD+
   3430		  CD CD	CD CD CD CD CD+
   3431		  CD CD	CD CD CD CD CD+
   3432		  CD CD	CD CD CD CD CD+
   3433		  CD CD	CD CD CD CD CD+
   3434		  CD CD	BB 0D 0A
2  3435	    2C83  20 20	20 20 20 20 20+			 db	 "	 ºPýi vol n¡ funkce					    +
   3436		  BA 50	FD 69 20 76 6F+	 º", 0Dh, 0Ah
   3437		  6C A0	6E A1 20 66 75+
   3438		  6E 6B	63 65 20 20 20+
   3439		  20 20	20 20 20 20 20+
   3440		  20 20	20 20 20 20 20+
   3441		  20 20	20 20 20 20 20+
   3442		  20 20	20 20 20 20 20+
   3443		  20 20	20 20 20 20 20+
   3444		  20 20	20 20 20 20 20+
   3445		  20 20	BA 0D 0A
2  3446	    2CCE  20 20	20 20 20 20 20+			 db	 "	 ºDoçlo	k chybØ						    +
   3447		  BA 44	6F E7 6C 6F 20+	 º", 0Dh, 0Ah
   3448		  6B 20	63 68 79 62 D8+
   3449		  20 20	20 20 20 20 20+
   3450		  20 20	20 20 20 20 20+
   3451		  20 20	20 20 20 20 20+
   3452		  20 20	20 20 20 20 20+
   3453		  20 20	20 20 20 20 20+
   3454		  20 20	20 20 20 20 20+
   3455		  20 20	20 20 20 20 20+
   3456		  20 20	BA 0D 0A
2  3457	    2D19  20 20	20 20 20 20 20+			 db	 "								    +
   3458		  BA C4	C4 C4 C4 C4 C4+	 ºÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄº", 0Dh, 0Ah
   3459		  C4 C4	C4 C4 C4 C4 C4+
   3460		  C4 C4	C4 C4 C4 C4 C4+
   3461		  C4 C4	C4 C4 C4 C4 C4+
   3462		  C4 C4	C4 C2 C4 C4 C4+
   3463		  C4 C4	C4 C4 C4 C4 C4+
   3464		  C4 C4	C4 C4 C4 C4 C4+
   3465		  C4 C4	C4 C4 C4 C4 C4+
   3466		  C4 C4	C4 C4 C4 C4 C4+
   3467		  C4 C4	BA 0D 0A
2  3468	    2D64  20 20	20 20 20 20 20+			 db	 "	 º Chybuj¡c¡ oblast:		³ Registry:		    +
   3469		  BA 20	43 68 79 62 75+	 º", 0Dh, 0Ah
   3470		  6A A1	63 A1 20 6F 62+
   3471		  6C 61	73 74 3A 20 20+
   3472		  20 20	20 20 20 20 20+
   3473		  20 20	20 B3 20 52 65+
   3474		  67 69	73 74 72 79 3A+
   3475		  20 20	20 20 20 20 20+
   3476		  20 20	20 20 20 20 20+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 62
setup.asm



   3477		  20 20	20 20 20 20 20+
   3478		  20 20	BA 0D 0A
2  3479	    2DAF  20 20	20 20 20 20 20+			 db	 "	 º     Disk....:		³     AX..:	   DI.....: +
   3480		  BA 20	20 20 20 20 44+	 º", 0Dh, 0Ah
   3481		  69 73	6B 2E 2E 2E 2E+
   3482		  3A 20	20 20 20 20 20+
   3483		  20 20	20 20 20 20 20+
   3484		  20 20	20 B3 20 20 20+
   3485		  20 20	41 58 2E 2E 3A+
   3486		  20 20	20 20 20 20 20+
   3487		  20 44	49 2E 2E 2E 2E+
   3488		  2E 3A	20 20 20 20 20+
   3489		  20 20	BA 0D 0A
2  3490	    2DFA  20 20	20 20 20 20 20+			 db	 "	 º     Stopa...:		³     BX..:	   DS.....: +
   3491		  BA 20	20 20 20 20 53+	 º", 0Dh, 0Ah
   3492		  74 6F	70 61 2E 2E 2E+
   3493		  3A 20	20 20 20 20 20+
   3494		  20 20	20 20 20 20 20+
   3495		  20 20	20 B3 20 20 20+
   3496		  20 20	42 58 2E 2E 3A+
   3497		  20 20	20 20 20 20 20+
   3498		  20 44	53 2E 2E 2E 2E+
   3499		  2E 3A	20 20 20 20 20+
   3500		  20 20	BA 0D 0A
2  3501	    2E45  20 20	20 20 20 20 20+			 db	 "	 º     Sektor..:		³     CX..:	   ES.....: +
   3502		  BA 20	20 20 20 20 53+	 º", 0Dh, 0Ah
   3503		  65 6B	74 6F 72 2E 2E+
   3504		  3A 20	20 20 20 20 20+
   3505		  20 20	20 20 20 20 20+
   3506		  20 20	20 B3 20 20 20+
   3507		  20 20	43 58 2E 2E 3A+
   3508		  20 20	20 20 20 20 20+
   3509		  20 45	53 2E 2E 2E 2E+
   3510		  2E 3A	20 20 20 20 20+
   3511		  20 20	BA 0D 0A
2  3512	    2E90  20 20	20 20 20 20 20+			 db	 "	 º     Povrch..:		³     DX..:	   Flags..: +
   3513		  BA 20	20 20 20 20 50+	 º", 0Dh, 0Ah
   3514		  6F 76	72 63 68 2E 2E+
   3515		  3A 20	20 20 20 20 20+
   3516		  20 20	20 20 20 20 20+
   3517		  20 20	20 B3 20 20 20+
   3518		  20 20	44 58 2E 2E 3A+
   3519		  20 20	20 20 20 20 20+
   3520		  20 46	6C 61 67 73 2E+
   3521		  2E 3A	20 20 20 20 20+
   3522		  20 20	BA 0D 0A
2  3523	    2EDB  20 20	20 20 20 20 20+			 db	 "	 º     Sektor….:		³     BP..:		    +
   3524		  BA 20	20 20 20 20 53+	 º", 0Dh, 0Ah
   3525		  65 6B	74 6F 72 85 2E+
   3526		  3A 20	20 20 20 20 20+
   3527		  20 20	20 20 20 20 20+
   3528		  20 20	20 B3 20 20 20+
   3529		  20 20	42 50 2E 2E 3A+
   3530		  20 20	20 20 20 20 20+
   3531		  20 20	20 20 20 20 20+
   3532		  20 20	20 20 20 20 20+
   3533		  20 20	BA 0D 0A
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 63
setup.asm



2  3534	    2F26  20 20	20 20 20 20 20+			 db	 "	 º     Funkce..:		³     SI..:		    +
   3535		  BA 20	20 20 20 20 46+	 º", 0Dh, 0Ah
   3536		  75 6E	6B 63 65 2E 2E+
   3537		  3A 20	20 20 20 20 20+
   3538		  20 20	20 20 20 20 20+
   3539		  20 20	20 B3 20 20 20+
   3540		  20 20	53 49 2E 2E 3A+
   3541		  20 20	20 20 20 20 20+
   3542		  20 20	20 20 20 20 20+
   3543		  20 20	20 20 20 20 20+
   3544		  20 20	BA 0D 0A
2  3545	    2F71  20 20	20 20 20 20 20+			 db	 "								    +
   3546		  BA C4	C4 C4 C4 C4 C4+	 ºÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄº", 0Dh, 0Ah
   3547		  C4 C4	C4 C4 C4 C4 C4+
   3548		  C4 C4	C4 C4 C4 C4 C4+
   3549		  C4 C4	C4 C4 C4 C4 C4+
   3550		  C4 C4	C4 C1 C4 C4 C4+
   3551		  C4 C4	C4 C4 C4 C4 C4+
   3552		  C4 C4	C4 C4 C4 C4 C4+
   3553		  C4 C4	C4 C4 C4 C4 C4+
   3554		  C4 C4	C4 C4 C4 C4 C4+
   3555		  C4 C4	BA 0D 0A
2  3556	    2FBC  20 20	20 20 20 20 20+			 db	 "	 º	  Zkusit znovu / Konec s chybou	/ konec	Bez chyby   +
   3557		  BA 20	20 20 20 20 20+	 º", 0Dh, 0Ah
   3558		  20 20	5A 6B 75 73 69+
   3559		  74 20	7A 6E 6F 76 75+
   3560		  20 2F	20 4B 6F 6E 65+
   3561		  63 20	73 20 63 68 79+
   3562		  62 6F	75 20 2F 20 6B+
   3563		  6F 6E	65 63 20 42 65+
   3564		  7A 20	63 68 79 62 79+
   3565		  20 20	20 20 20 20 20+
   3566		  20 20	BA 0D 0A
2  3567	    3007  20 20	20 20 20 20 20+			 db	 "								    +
   3568		  C8 CD	CD CD CD CD CD+	 ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼", 00h
   3569		  CD CD	CD CD CD CD CD+
   3570		  CD CD	CD CD CD CD CD+
   3571		  CD CD	CD CD CD CD CD+
   3572		  CD CD	CD CD CD CD CD+
   3573		  CD CD	CD CD CD CD CD+
   3574		  CD CD	CD CD CD CD CD+
   3575		  CD CD	CD CD CD CD CD+
   3576		  CD CD	CD CD CD CD CD+
   3577		  CD CD	BC 00
2  3578
2  3579	    3051  C9 CD	CD CD CD CD CD+	 PrintPartition	 db	 "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»", 0Dh, 0Ah
   3580		  CD CD	CD CD CD CD CD+
   3581		  CD CD	CD CD CD CD CD+
   3582		  CD CD	CD CD CD CD CD+
   3583		  CD CD	CD CD CD CD CD+
   3584		  CD CD	CD CD CD BB 0D+
   3585		  0A
2  3586	    307C  BA 44	69 73 6B 3A 20+			 db	 "ºDisk:     Cyl:     Pov:     Sektor:	  º", 0Dh, 0Ah
   3587		  20 20	20 20 43 79 6C+
   3588		  3A 20	20 20 20 20 50+
   3589		  6F 76	3A 20 20 20 20+
   3590		  20 53	65 6B 74 6F 72+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 64
setup.asm



   3591		  3A 20	20 20 20 BA 0D+
   3592		  0A
2  3593	    30A7  CC CD	CD CD CD CD CD+			 db									    +
   3594		  CD CD	CD CD CD CD CD+	 "ÌÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»", 0Dh, 0Ah
   3595		  CD CD	CD CD CD CD CD+
   3596		  CD CD	CD CD CD CD CD+
   3597		  CD CD	CD CD CD CD CD+
   3598		  CD CD	CD CD CD CA CD+
   3599		  CD CD	CD CD CD CD CD+
   3600		  CD CD	CD CD CD CD CD+
   3601		  CD CD	CD CD CD CD CD+
   3602		  CD CD	CD CD CD BB 0D+
   3603		  0A
2  3604	    30EE  BA 20	20 20 20 20 20+			 db	 "º	 ³    ³	 PoŸ. pozice  ³	Konc. pozice  ³Sektor…		    +
   3605		  B3 20	20 20 20 B3 20+	 pýed³Obsazenìchº", 0Dh, 0Ah
   3606		  20 50	6F 9F 2E 20 70+
   3607		  6F 7A	69 63 65 20 20+
   3608		  B3 20	4B 6F 6E 63 2E+
   3609		  20 70	6F 7A 69 63 65+
   3610		  20 20	B3 53 65 6B 74+
   3611		  6F 72	85 20 70 FD 65+
   3612		  64 B3	4F 62 73 61 7A+
   3613		  65 6E	EC 63 68 BA 0D+
   3614		  0A
2  3615	    3135  BA 53	79 73 74 65 6D+			 db	 "ºSystem³Boot³Pov. Cyl. Sekt.³Pov. Cyl. Sekt.³	 oblast¡   ³ sektor…+
   3616		  B3 42	6F 6F 74 B3 50+	 º", 0Dh, 0Ah
   3617		  6F 76	2E 20 43 79 6C+
   3618		  2E 20	53 65 6B 74 2E+
   3619		  B3 50	6F 76 2E 20 43+
   3620		  79 6C	2E 20 53 65 6B+
   3621		  74 2E	B3 20 20 6F 62+
   3622		  6C 61	73 74 A1 20 20+
   3623		  20 B3	20 73 65 6B 74+
   3624		  6F 72	85 20 20 BA 0D+
   3625		  0A
2  3626	    317C  BA C4	C4 C4 C4 C4 C4+			 db									    +
   3627		  C5 C4	C4 C4 C4 C5 C4+	 "ºÄÄÄÄÄÄÅÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄº", 0Dh, 0Ah
   3628		  C4 C4	C4 C4 C4 C4 C4+
   3629		  C4 C4	C4 C4 C4 C4 C4+
   3630		  C5 C4	C4 C4 C4 C4 C4+
   3631		  C4 C4	C4 C4 C4 C4 C4+
   3632		  C4 C4	C5 C4 C4 C4 C4+
   3633		  C4 C4	C4 C4 C4 C4 C4+
   3634		  C4 C5	C4 C4 C4 C4 C4+
   3635		  C4 C4	C4 C4 C4 BA 0D+
   3636		  0A
2  3637	    31C3  BA 20	20 20 20 20 20+			 db	 "º	 ³    ³		      ³		      ³		   ³	    +
   3638		  B3 20	20 20 20 B3 20+	 º", 0Dh, 0Ah
   3639		  20 20	20 20 20 20 20+
   3640		  20 20	20 20 20 20 20+
   3641		  B3 20	20 20 20 20 20+
   3642		  20 20	20 20 20 20 20+
   3643		  20 20	B3 20 20 20 20+
   3644		  20 20	20 20 20 20 20+
   3645		  20 B3	20 20 20 20 20+
   3646		  20 20	20 20 20 BA 0D+
   3647		  0A
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 65
setup.asm



2  3648	    320A  BA 20	20 20 20 20 20+			 db	 "º	 ³    ³		      ³		      ³		   ³	    +
   3649		  B3 20	20 20 20 B3 20+	 º", 0Dh, 0Ah
   3650		  20 20	20 20 20 20 20+
   3651		  20 20	20 20 20 20 20+
   3652		  B3 20	20 20 20 20 20+
   3653		  20 20	20 20 20 20 20+
   3654		  20 20	B3 20 20 20 20+
   3655		  20 20	20 20 20 20 20+
   3656		  20 B3	20 20 20 20 20+
   3657		  20 20	20 20 20 BA 0D+
   3658		  0A
2  3659	    3251  BA 20	20 20 20 20 20+			 db	 "º	 ³    ³		      ³		      ³		   ³	    +
   3660		  B3 20	20 20 20 B3 20+	 º", 0Dh, 0Ah
   3661		  20 20	20 20 20 20 20+
   3662		  20 20	20 20 20 20 20+
   3663		  B3 20	20 20 20 20 20+
   3664		  20 20	20 20 20 20 20+
   3665		  20 20	B3 20 20 20 20+
   3666		  20 20	20 20 20 20 20+
   3667		  20 B3	20 20 20 20 20+
   3668		  20 20	20 20 20 BA 0D+
   3669		  0A
2  3670	    3298  BA 20	20 20 20 20 20+			 db	 "º	 ³    ³		      ³		      ³		   ³	    +
   3671		  B3 20	20 20 20 B3 20+	 º", 0Dh, 0Ah
   3672		  20 20	20 20 20 20 20+
   3673		  20 20	20 20 20 20 20+
   3674		  B3 20	20 20 20 20 20+
   3675		  20 20	20 20 20 20 20+
   3676		  20 20	B3 20 20 20 20+
   3677		  20 20	20 20 20 20 20+
   3678		  20 B3	20 20 20 20 20+
   3679		  20 20	20 20 20 BA 0D+
   3680		  0A
2  3681	    32DF  C8 CD	CD CD CD CD CD+			 db									    +
   3682		  CD CD	CD CD CD CD CD+	 "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼", 00h
   3683		  CD CD	CD CD CD CD CD+
   3684		  CD CD	CD CD CD CD CD+
   3685		  CD CD	CD CD CD CD CD+
   3686		  CD CD	CD CD CD CD CD+
   3687		  CD CD	CD CD CD CD CD+
   3688		  CD CD	CD CD CD CD CD+
   3689		  CD CD	CD CD CD CD CD+
   3690		  CD CD	CD CD CD BC 00
2  3691
2  3692	    3325  20 20	20 20 20 20 20+	 PrintSystemError	 db	 "							    +
   3693		  C9 CD	CD CD CD CD CD+	 ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»",	0Dh, 0Ah
   3694		  CD CD	CD CD CD CD CD+
   3695		  CD CD	CD CD CD CD CD+
   3696		  CD CD	CD CD CD CD CD+
   3697		  CD CD	CD CD CD CD CD+
   3698		  CD CD	CD CD CD CD CD+
   3699		  CD CD	CD CD CD CD CD+
   3700		  CD CD	CD CD CD CD CD+
   3701		  CD CD	CD CD CD CD CD+
   3702		  CD CD	CD CD BB 0D 0A
2  3703	    3372  20 20	20 20 20 20 20+			 db	 "	 º							    +
   3704		  BA 20	20 20 20 20 20+	 º", 0Dh, 0Ah
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 66
setup.asm



   3705		  20 20	20 20 20 20 20+
   3706		  20 20	20 20 20 20 20+
   3707		  20 20	20 20 20 20 20+
   3708		  20 20	20 20 20 20 20+
   3709		  20 20	20 20 20 20 20+
   3710		  20 20	20 20 20 20 20+
   3711		  20 20	20 20 20 20 20+
   3712		  20 20	20 20 20 20 20+
   3713		  20 20	20 20 BA 0D 0A
2  3714	    33BF  20 20	20 20 20 20 20+			 db	 "	 º							    +
   3715		  BA 20	20 20 20 20 20+	 º", 0Dh, 0Ah
   3716		  20 20	20 20 20 20 20+
   3717		  20 20	20 20 20 20 20+
   3718		  20 20	20 20 20 20 20+
   3719		  20 20	20 20 20 20 20+
   3720		  20 20	20 20 20 20 20+
   3721		  20 20	20 20 20 20 20+
   3722		  20 20	20 20 20 20 20+
   3723		  20 20	20 20 20 20 20+
   3724		  20 20	20 20 BA 0D 0A
2  3725	    340C  20 20	20 20 20 20 20+			 db	 "								    +
   3726		  BA C4	C4 C4 C4 C4 C4+	 ºÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄº",	0Dh, 0Ah
   3727		  C4 C4	C4 C4 C4 C4 C4+
   3728		  C4 C4	C4 C4 C4 C4 C4+
   3729		  C4 C4	C4 C4 C4 C4 C4+
   3730		  C4 C4	C4 C4 C4 C4 C4+
   3731		  C4 C4	C4 C4 C4 C4 C4+
   3732		  C4 C4	C4 C4 C4 C4 C4+
   3733		  C4 C4	C4 C4 C4 C4 C4+
   3734		  C4 C4	C4 C4 C4 C4 C4+
   3735		  C4 C4	C4 C4 BA 0D 0A
2  3736	    3459  20 20	20 20 20 20 20+			 db	 "	 º Registry:						    +
   3737		  BA 20	52 65 67 69 73+	 º", 0Dh, 0Ah
   3738		  74 72	79 3A 20 20 20+
   3739		  20 20	20 20 20 20 20+
   3740		  20 20	20 20 20 20 20+
   3741		  20 20	20 20 20 20 20+
   3742		  20 20	20 20 20 20 20+
   3743		  20 20	20 20 20 20 20+
   3744		  20 20	20 20 20 20 20+
   3745		  20 20	20 20 20 20 20+
   3746		  20 20	20 20 BA 0D 0A
2  3747	    34A6  20 20	20 20 20 20 20+			 db	 "	 º     EAX..:		DS..:				    +
   3748		  BA 20	20 20 20 20 45+	 º", 0Dh, 0Ah
   3749		  41 58	2E 2E 3A 20 20+
   3750		  20 20	20 20 20 20 20+
   3751		  20 20	44 53 2E 2E 3A+
   3752		  20 20	20 20 20 20 20+
   3753		  20 20	20 20 20 20 20+
   3754		  20 20	20 20 20 20 20+
   3755		  20 20	20 20 20 20 20+
   3756		  20 20	20 20 20 20 20+
   3757		  20 20	20 20 BA 0D 0A
2  3758	    34F3  20 20	20 20 20 20 20+			 db	 "	 º     EBX..:		ES..:				    +
   3759		  BA 20	20 20 20 20 45+	 º", 0Dh, 0Ah
   3760		  42 58	2E 2E 3A 20 20+
   3761		  20 20	20 20 20 20 20+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 67
setup.asm



   3762		  20 20	45 53 2E 2E 3A+
   3763		  20 20	20 20 20 20 20+
   3764		  20 20	20 20 20 20 20+
   3765		  20 20	20 20 20 20 20+
   3766		  20 20	20 20 20 20 20+
   3767		  20 20	20 20 20 20 20+
   3768		  20 20	20 20 BA 0D 0A
2  3769	    3540  20 20	20 20 20 20 20+			 db	 "	 º     ECX..:		FS..:				    +
   3770		  BA 20	20 20 20 20 45+	 º", 0Dh, 0Ah
   3771		  43 58	2E 2E 3A 20 20+
   3772		  20 20	20 20 20 20 20+
   3773		  20 20	46 53 2E 2E 3A+
   3774		  20 20	20 20 20 20 20+
   3775		  20 20	20 20 20 20 20+
   3776		  20 20	20 20 20 20 20+
   3777		  20 20	20 20 20 20 20+
   3778		  20 20	20 20 20 20 20+
   3779		  20 20	20 20 BA 0D 0A
2  3780	    358D  20 20	20 20 20 20 20+			 db	 "	 º     EDX..:		GS..:				    +
   3781		  BA 20	20 20 20 20 45+	 º", 0Dh, 0Ah
   3782		  44 58	2E 2E 3A 20 20+
   3783		  20 20	20 20 20 20 20+
   3784		  20 20	47 53 2E 2E 3A+
   3785		  20 20	20 20 20 20 20+
   3786		  20 20	20 20 20 20 20+
   3787		  20 20	20 20 20 20 20+
   3788		  20 20	20 20 20 20 20+
   3789		  20 20	20 20 20 20 20+
   3790		  20 20	20 20 BA 0D 0A
2  3791	    35DA  20 20	20 20 20 20 20+			 db	 "	 º     ESI..:		SS..:				    +
   3792		  BA 20	20 20 20 20 45+	 º", 0Dh, 0Ah
   3793		  53 49	2E 2E 3A 20 20+
   3794		  20 20	20 20 20 20 20+
   3795		  20 20	53 53 2E 2E 3A+
   3796		  20 20	20 20 20 20 20+
   3797		  20 20	20 20 20 20 20+
   3798		  20 20	20 20 20 20 20+
   3799		  20 20	20 20 20 20 20+
   3800		  20 20	20 20 20 20 20+
   3801		  20 20	20 20 BA 0D 0A
2  3802	    3627  20 20	20 20 20 20 20+			 db	 "	 º     EDI..:		CS..:				    +
   3803		  BA 20	20 20 20 20 45+	 º", 0Dh, 0Ah
   3804		  44 49	2E 2E 3A 20 20+
   3805		  20 20	20 20 20 20 20+
   3806		  20 20	43 53 2E 2E 3A+
   3807		  20 20	20 20 20 20 20+
   3808		  20 20	20 20 20 20 20+
   3809		  20 20	20 20 20 20 20+
   3810		  20 20	20 20 20 20 20+
   3811		  20 20	20 20 20 20 20+
   3812		  20 20	20 20 BA 0D 0A
2  3813	    3674  20 20	20 20 20 20 20+			 db	 "	 º     EBP..:		CR0.:	       PG CD NW	AM WP NE TS +
   3814		  BA 20	20 20 20 20 45+	 EM MP PEº", 0Dh, 0Ah
   3815		  42 50	2E 2E 3A 20 20+
   3816		  20 20	20 20 20 20 20+
   3817		  20 20	43 52 30 2E 3A+
   3818		  20 20	20 20 20 20 20+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 68
setup.asm



   3819		  20 20	20 50 47 20 43+
   3820		  44 20	4E 57 20 41 4D+
   3821		  20 57	50 20 4E 45 20+
   3822		  54 53	20 45 4D 20 4D+
   3823		  50 20	50 45 BA 0D 0A
2  3824	    36C1  20 20	20 20 20 20 20+			 db	 "	 º     ESP..:		CR2.:				    +
   3825		  BA 20	20 20 20 20 45+	 º", 0Dh, 0Ah
   3826		  53 50	2E 2E 3A 20 20+
   3827		  20 20	20 20 20 20 20+
   3828		  20 20	43 52 32 2E 3A+
   3829		  20 20	20 20 20 20 20+
   3830		  20 20	20 20 20 20 20+
   3831		  20 20	20 20 20 20 20+
   3832		  20 20	20 20 20 20 20+
   3833		  20 20	20 20 20 20 20+
   3834		  20 20	20 20 BA 0D 0A
2  3835	    370E  20 20	20 20 20 20 20+			 db	 "	 º     EIP..:		CR3.:	       PC PW CR4.: -------- +
   3836		  BA 20	20 20 20 20 45+	 PS PV VMº", 0Dh, 0Ah
   3837		  49 50	2E 2E 3A 20 20+
   3838		  20 20	20 20 20 20 20+
   3839		  20 20	43 52 33 2E 3A+
   3840		  20 20	20 20 20 20 20+
   3841		  20 20	20 50 43 20 50+
   3842		  57 20	43 52 34 2E 3A+
   3843		  20 2D	2D 2D 2D 2D 2D+
   3844		  2D 2D	20 50 53 20 50+
   3845		  56 20	56 4D BA 0D 0A
2  3846	    375B  20 20	20 20 20 20 20+			 db	 "	 º  EFLAGS..:	       ID VIP VIF VM IOPL0 OF DF TF SF ZF AF+
   3847		  BA 20	20 45 46 4C 41+	 PF CF	º", 0Dh, 0Ah
   3848		  47 53	2E 2E 3A 20 20+
   3849		  20 20	20 20 20 20 20+
   3850		  20 49	44 20 56 49 50+
   3851		  20 56	49 46 20 56 4D+
   3852		  20 49	4F 50 4C 30 20+
   3853		  4F 46	20 44 46 20 54+
   3854		  46 20	53 46 20 5A 46+
   3855		  20 41	46 20 50 46 20+
   3856		  43 46	20 20 BA 0D 0A
2  3857	    37A8  20 20	20 20 20 20 20+			 db	 "								    +
   3858		  BA C4	C4 C4 C4 C4 C4+	 ºÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄº",	0Dh, 0Ah
   3859		  C4 C4	C4 C4 C4 C4 C4+
   3860		  C4 C4	C4 C4 C4 C4 C4+
   3861		  C4 C4	C4 C4 C4 C4 C4+
   3862		  C4 C4	C4 C4 C4 C4 C4+
   3863		  C4 C4	C4 C4 C4 C4 C4+
   3864		  C4 C4	C4 C4 C4 C4 C4+
   3865		  C4 C4	C4 C4 C4 C4 C4+
   3866		  C4 C4	C4 C4 C4 C4 C4+
   3867		  C4 C4	C4 C4 BA 0D 0A
2  3868	    37F5  20 20	20 20 20 20 20+			 db	 "	 º	  Zkusit znovu / Konec s chybou	/ konec	Bez chyby   +
   3869		  BA 20	20 20 20 20 20+	 º", 0Dh, 0Ah
   3870		  20 20	5A 6B 75 73 69+
   3871		  74 20	7A 6E 6F 76 75+
   3872		  20 2F	20 4B 6F 6E 65+
   3873		  63 20	73 20 63 68 79+
   3874		  62 6F	75 20 2F 20 6B+
   3875		  6F 6E	65 63 20 42 65+
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 69
setup.asm



   3876		  7A 20	63 68 79 62 79+
   3877		  20 20	20 20 20 20 20+
   3878		  20 20	20 20 BA 0D 0A
2  3879	    3842  20 20	20 20 20 20 20+			 db	 "								    +
   3880		  C8 CD	CD CD CD CD CD+	 ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼",	00h
   3881		  CD CD	CD CD CD CD CD+
   3882		  CD CD	CD CD CD CD CD+
   3883		  CD CD	CD CD CD CD CD+
   3884		  CD CD	CD CD CD CD CD+
   3885		  CD CD	CD CD CD CD CD+
   3886		  CD CD	CD CD CD CD CD+
   3887		  CD CD	CD CD CD CD CD+
   3888		  CD CD	CD CD CD CD CD+
   3889		  CD CD	CD CD BC 00
2  3890
2  3891	0000388E			 Err_	 struc
2  3892	00000000  01*(00000000)			 _EAX	 dd	 0
2  3893	00000004  01*(00000000)			 _EBX	 dd	 0
2  3894	00000008  01*(00000000)			 _ECX	 dd	 0
2  3895	0000000C  01*(00000000)			 _EDX	 dd	 0
2  3896	00000010  01*(00000000)			 _ESI	 dd	 0
2  3897	00000014  01*(00000000)			 _EDI	 dd	 0
2  3898	00000018  01*(00000000)			 _EBP	 dd	 0
2  3899	0000001C  01*(00000000)			 _ESP	 dd	 0
2  3900	00000020  01*(00000000)			 _EIP	 dd	 0
2  3901	00000024  01*(00000000)			 _EFLAGS dd	 0
2  3902	00000028  01*(0000)			 _CS	 dw	 0
2  3903	0000002A  01*(0000)			 _SS	 dw	 0
2  3904	0000002C  01*(0000)			 _DS	 dw	 0
2  3905	0000002E  01*(0000)			 _ES	 dw	 0
2  3906	00000030  01*(0000)			 _FS	 dw	 0
2  3907	00000032  01*(0000)			 _GS	 dw	 0
2  3908	00000034  01*(00000000)			 _CR0	 dd	 0
2  3909	00000038  01*(00000000)			 _CR2	 dd	 0
2  3910	0000003C  01*(00000000)			 _CR3	 dd	 0
2  3911	00000040  01*(00000000)			 _CR4	 dd	 0
2  3912	00000044  01*(0000)			 _OSS	 dw	 0
2  3913	00000046  01*(00000000)			 _OESP	 dd	 0
2  3914	0000004A			 Err_	 ends
2  3915	    388E  00000000 00000000   +	 OldErrReg	 Err_ <>
   3916		  00000000 00000000   +
   3917		  00000000 00000000   +
   3918		  00000000 00000000   +
   3919		  00000000 00000000   +
   3920		  0000 0000 0000 0000 +
   3921		  0000 0000 00000000  +
   3922		  00000000 00000000   +
   3923		  00000000 0000	      +
   3924		  00000000
2  3925
2  3926	    38D8  00			 TMP__1		 db	 0
2  3927	    38D9  00			 TMP__2		 db	 0
2  3928	    38DA  00			 TMP__3		 db	 0
2  3929	    38DB  49 44	00		 Err_Sh_ID	 db	 "ID",0
2  3930	    38DE  56 49	50 00		 Err_Sh_VIP	 db	 "VIP",0
2  3931	    38E2  56 49	46 00		 Err_Sh_VIF	 db	 "VIF",0
2  3932	    38E6  56 4D	00		 Err_Sh_VM	 db	 "VM",0
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 70
setup.asm



2  3933	    38E9  4F 46	00		 Err_Sh_OF	 db	 "OF",0
2  3934	    38EC  44 46	00		 Err_Sh_DF	 db	 "DF",0
2  3935	    38EF  54 46	00		 Err_Sh_TF	 db	 "TF",0
2  3936	    38F2  53 46	00		 Err_Sh_SF	 db	 "SF",0
2  3937	    38F5  5A 46	00		 Err_Sh_ZF	 db	 "ZF",0
2  3938	    38F8  41 46	00		 Err_Sh_AF	 db	 "AF",0
2  3939	    38FB  50 46	00		 Err_Sh_PF	 db	 "PF",0
2  3940	    38FE  43 46	00		 Err_Sh_CF	 db	 "CF",0
2  3941	    3901  50 47	00		 Err_Sh_PG	 db	 "PG",0
2  3942	    3904  43 44	00		 Err_Sh_CD	 db	 "CD",0
2  3943	    3907  4E 57	00		 Err_Sh_NW	 db	 "NW",0
2  3944	    390A  41 4D	00		 Err_Sh_AM	 db	 "AM",0
2  3945	    390D  57 50	00		 Err_Sh_WP	 db	 "WP",0
2  3946	    3910  4E 45	00		 Err_Sh_NE	 db	 "NE",0
2  3947	    3913  54 53	00		 Err_Sh_TS	 db	 "TS",0
2  3948	    3916  45 4D	00		 Err_Sh_EM	 db	 "EM",0
2  3949	    3919  4D 50	00		 Err_Sh_MP	 db	 "MP",0
2  3950	    391C  50 45	00		 Err_Sh_PE	 db	 "PE",0
2  3951	    391F  50 43	00		 Err_Sh_PCD	 db	 "PC",0
2  3952	    3922  50 57	00		 Err_Sh_PWT	 db	 "PW",0
2  3953	    3925  50 53	00		 Err_Sh_PSE	 db	 "PS",0
2  3954	    3928  50 56	00		 Err_Sh_PVI	 db	 "PV",0
2  3955	    392B  56 4D	00		 Err_Sh_VME	 db	 "VM",0
2  3956
1  3957	    392E  3C*(00)		 TMPString	 db	 60 dup(0)
1  3958
1  3959	    396A  ????			 fp_status	 dw	 ?
1  3960					 ;id_mess		 db	 "Tento	syst‚m obsahuje	",0
1  3961					 ;fp_8087		 db	 "a 8087 matematickì koprocesor",0
1  3962					 ;fp_80287	 db	 "a 80287 matematickì koprocesor",0
1  3963					 ;fp_80387	 db	 "a 80387 matematickì koprocesor",0
1  3964					 ;c8086		 db	 "n8086/8088 mikroprocesor",0
1  3965					 ;c286		 db	 "n80286 mikroprocesor",0
1  3966					 ;c386		 db	 "386 mikroprocesor",0
1  3967					 ;c486		 db	 "486 DX mikroprocesor /487 SX matematickì koprocesor",0
1  3968					 ;c486nfp		 db	 "486 SX mikroprocesor",0
1  3969					 ;period	 db	 ".",13,10,0
1  3970					 ;present_86	 dw	 0
1  3971					 ;present_286	 dw	 0
1  3972					 ;present_386	 dw	 0
1  3973					 ;present_486	 dw	 0
1  3974
1  3975	    396C  0000			 PAX		 dw	 0
1  3976	    396E  0000			 PCX		 dw	 0
1  3977	    3970  0000			 PBX		 dw	 0
1  3978	    3972  0000			 TMP		 dw	 0
1  3979
1  3980	    3974  00			 ScanCode	 db	 0
1  3981	    3975  00			 BreakFlag	 db	 0
1  3982	    3976  00000000		 Sektoru_TMP	 dd	 0
1  3983	    397A  3FF5FF972474538EF34D	 Konst_00195	 dt	 0.00195
1  3984	    3984  ????????		 SektoruNaFat_Tmp	 dd	 ?
1  3985
1  3986	    3988  00			 VideoStranka	 db	 0
1  3987	    3989  07			 VideoAtribut	 db	 7
1  3988
1  3989
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 71
setup.asm



1  3990	    398A  05*(00) 20 00	00	 RETEZEC	 DB	 5 dup(00h),20h,0,0
1  3991
1  3992	    3992			 INIT_MESS:
1  3993	    3992  53 74	61 72 74 75 6A+			 db	 "Startuje se syst‚m ATREX...",13,10,0
   3994		  65 20	73 65 20 73 79+
   3995		  73 74	82 6D 20 41 54+
   3996		  52 45	58 2E 2E 2E 0D+
   3997		  0A 00
1  3998	    39B0			 DiskIOErr:
1  3999	    39B0  4E 61	73 74 61 6C 61+			 db	 "Nastala chyba	pýi Ÿten¡ z disku ",0
   4000		  20 63	68 79 62 61 20+
   4001		  70 FD	69 20 9F 74 65+
   4002		  6E A1	20 7A 20 64 69+
   4003		  73 6B	75 20 00
1  4004	    39D1			 ReplaceDisk:
1  4005	    39D1  56 79	6D D8 E5 74 65+			 db	 "VymØåte jej !", 0Dh, 0Ah, 0
   4006		  20 6A	65 6A 20 21 0D+
   4007		  0A 00
1  4008	    39E1			 PressAnyK:
1  4009	    39E1  53 74	69 73 6B 6E D8+			 db	 "StisknØte jakoukoliv kl vesu pro pokraŸov n¡...",13,10,0
   4010		  74 65	20 6A 61 6B 6F+
   4011		  75 6B	6F 6C 69 76 20+
   4012		  6B 6C	A0 76 65 73 75+
   4013		  20 70	72 6F 20 70 6F+
   4014		  6B 72	61 9F 6F 76 A0+
   4015		  6E A1	2E 2E 2E 0D 0A+
   4016		  00
1  4017	    3A13			 INIT_ERROR:
1  4018	    3A13  4E 61	73 74 61 6C 61+			 db	 "Nastala chyba	pýi inicializaci!",13,10
   4019		  20 63	68 79 62 61 20+
   4020		  70 FD	69 20 69 6E 69+
   4021		  63 69	61 6C 69 7A 61+
   4022		  63 69	21 0D 0A
1  4023	    3A34  4E 65	6C 7A 65 20 64+			 db	 "Nelze	d le pokraŸovat. Vlo§te	disk s jinìm syst‚mem a",13,10,0
   4024		  A0 6C	65 20 70 6F 6B+
   4025		  72 61	9F 6F 76 61 74+
   4026		  2E 20	56 6C 6F A7 74+
   4027		  65 20	64 69 73 6B 20+
   4028		  73 20	6A 69 6E EC 6D+
   4029		  20 73	79 73 74 82 6D+
   4030		  65 6D	20 61 0D 0A 00
1  4031	    3A6C			 CPU_INIT_ERROR:
1  4032	    3A6C  54 65	6E 74 6F 20 73+			 db	 "Tento	syst‚m vy§aduje	procesor minim lnØ 80386!",13,10,0
   4033		  79 73	74 82 6D 20 76+
   4034		  79 A7	61 64 75 6A 65+
   4035		  20 70	72 6F 63 65 73+
   4036		  6F 72	20 6D 69 6E 69+
   4037		  6D A0	6C 6E D8 20 38+
   4038		  30 33	38 36 21 0D 0A+
   4039		  00
1  4040	    3A9E			 FPU_INIT_ERROR:
1  4041	    3A9E  54 65	6E 74 6F 20 73+			 db	 "Tento	syst‚m vy§aduje	koprocesor!",13,10,0
   4042		  79 73	74 82 6D 20 76+
   4043		  79 A7	61 64 75 6A 65+
   4044		  20 6B	6F 70 72 6F 63+
   4045		  65 73	6F 72 21 0D 0A+
   4046		  00
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 72
setup.asm



1  4047
1  4048	    3AC2  20 6E	65 6E 61 6C 65+	 _Nenalezen:	 db	 " nenalezen ",0
   4049		  7A 65	6E 20 00
1  4050	    3ACE  20 6F	6B 20 20 20 20+	 _OK:		 db	 " ok	     ",0
   4051		  20 20	20 20 00
1  4052	    3ADA  50 65	76 6E EC 20 64+	 _HD0:		 db	 "Pevnì	disk 0:	",0
   4053		  69 73	6B 20 30 3A 20+
   4054		  00
1  4055	    3AE9  50 65	76 6E EC 20 64+	 _HD1:		 db	 "Pevnì	disk 1:	",0
   4056		  69 73	6B 20 31 3A 20+
   4057		  00
1  4058	    3AF8  50 65	76 6E EC 20 64+	 _HD2:		 db	 "Pevnì	disk 2:	",0
   4059		  69 73	6B 20 32 3A 20+
   4060		  00
1  4061	    3B07  50 65	76 6E EC 20 64+	 _HD3:		 db	 "Pevnì	disk 3:	",0
   4062		  69 73	6B 20 33 3A 20+
   4063		  00
1  4064	    3B16  20 20	20 20 20 20 20+	 _Oblast1:	 db	 "	 Oblast1: ",0
   4065		  4F 62	6C 61 73 74 31+
   4066		  3A 20	00
1  4067	    3B27  20 20	20 20 20 20 20+	 _Oblast2:	 db	 "	 Oblast2: ",0
   4068		  4F 62	6C 61 73 74 32+
   4069		  3A 20	00
1  4070	    3B38  20 20	20 20 20 20 20+	 _Oblast3:	 db	 "	 Oblast3: ",0
   4071		  4F 62	6C 61 73 74 33+
   4072		  3A 20	00
1  4073	    3B49  20 20	20 20 20 20 20+	 _Oblast4:	 db	 "	 Oblast4: ",0
   4074		  4F 62	6C 61 73 74 34+
   4075		  3A 20	00
1  4076	    3B5A  20 20	20 20 20 20 20+	 _PrizAktiv	 db	 "		 Pý¡znak aktivity: ",0
   4077		  20 20	20 20 20 20 20+
   4078		  20 50	FD A1 7A 6E 61+
   4079		  6B 20	61 6B 74 69 76+
   4080		  69 74	79 3A 20 00
1  4081	    3B7C  20 20	20 20 20 20 20+	 _PrizOS	 db	 "		 Pý¡znak OS: ",0
   4082		  20 20	20 20 20 20 20+
   4083		  20 50	FD A1 7A 6E 61+
   4084		  6B 20	4F 53 3A 20 00
1  4085	    3B98  0000			 AdrObl		 dw	 0
1  4086
1  4087	    3B9A  20 20	3A 00 00	 DISK	 db	 '  :',0,0
1  4088
1  4089	    3B9F			 ENTER_MESS:
1  4090	    3B9F  0D 0A	00				 db	 0Dh, 0Ah, 00h
1  4091
1  4092	00003BA2			 Old13_	 struc
1  4093	00000000  01*(????)			 _AX	 dw	 ?
1  4094	00000002  01*(????)			 _BX	 dw	 ?
1  4095	00000004  01*(????)			 _CX	 dw	 ?
1  4096	00000006  01*(????)			 _DX	 dw	 ?
1  4097	00000008			 Old13_	 ends
1  4098	    3BA2  08*(??)		 Old13	 Old13_	<>
1  4099
1  4100	    3BAA			 Struktury_SDOS_:
1  4101	    3BAA  31			 NV		 db	 '1'
1  4102	    3BAB  0000			 AUX		 dw	 0
1  4103	    3BAD  0000			 PRN		 dw	 0
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 73
setup.asm



1  4104	    3BAF  ??			 BootFromDisk	 db	 ?
1  4105
1  4106	    3BB0  0000			 EXT_MEM_SIZE	 DW	 0
1  4107	    3BB2  0000			 MOUSE_PRESENT	 DW	 0
1  4108	    3BB4  0000			 APM_BIOS_VER	 DW	 0
1  4109	    3BB6  0000			 APM_BIOS_FLAGS	 DW	 0
1  4110
1  4111	00003BB8			 OldInt_ struc
1  4112	00000000  01*(????)			 OFS_00	 dw	 ?
1  4113	00000002  01*(????)			 SEG_00	 dw	 ?
1  4114	00000004  01*(????)			 OFS_09	 dw	 ?
1  4115	00000006  01*(????)			 SEG_09	 dw	 ?
1  4116	00000008  01*(????)			 OFS_13	 dw	 ?
1  4117	0000000A  01*(????)			 SEG_13	 dw	 ?
1  4118	0000000C  01*(????)			 OFS_16	 dw	 ?
1  4119	0000000E  01*(????)			 SEG_16	 dw	 ?
1  4120	00000010  01*(????)			 OFS_20	 dw	 ?
1  4121	00000012  01*(????)			 SEG_20	 dw	 ?
1  4122	00000014  01*(????)			 OFS_21	 dw	 ?
1  4123	00000016  01*(????)			 SEG_21	 dw	 ?
1  4124	00000018  01*(????)			 OFS_22	 dw	 ?
1  4125	0000001A  01*(????)			 SEG_22	 dw	 ?
1  4126	0000001C  01*(????)			 OFS_2F	 dw	 ?
1  4127	0000001E  01*(????)			 SEG_2F	 dw	 ?
1  4128	00000020			 OldInt_ ends
1  4129	    3BB8  20*(??)		 OldInts OldInt_ <>
1  4130
1  4131
1  4132	00003BD8			 ExtBt	 struc
1  4133	00000000  01*(??)			 MajorVer	 db	 ?
1  4134	00000001  01*(??)			 MinorVer	 db	 ?
1  4135	00000002  01*(????)			 NFSVer		 dw	 ?
1  4136	00000004  01*(??)			 SecRoot	 db	 ?
1  4137	00000005  01*(????????)			 FirstSecRoot	 dd	 ?
1  4138	00000009  01*(????????)			 FirstSecDat	 dd	 ?
1  4139	0000000D  01*(????????)			 SecDAT		 dd	 ?
1  4140	00000011  01*(????????)			 SecPart	 dd	 ?
1  4141	00000015  01*(????)			 FirstSecPart	 dw	 ?
1  4142	00000017  01*(????)			 FirstCylPart	 dw	 ?
1  4143	00000019  01*(??)			 FirstHeaPart	 db	 ?
1  4144	0000001A  01*(??)			 PartMounted	 db	 ?
1  4145	0000001B  01*(08*(??))			 DiskMark	 db	 8 dup(?)
1  4146	00000023  01*(32*(??))			 MountCode	 db	 50 dup(?)
1  4147	00000055  01*(32*(??))			 UnMountCode	 db	 50 dup(?)
1  4148	00000087  01*(????)			 EndSecPart	 dw	 ?
1  4149	00000089  01*(????)			 EndCylPart	 dw	 ?
1  4150	0000008B  01*(??)			 EndHeaPart	 db	 ?
1  4151	0000008C  01*(????????)			 SecSAT		 dd	 ?
1  4152	00000090  01*(????)			 SecSysPart	 dw	 ?
1  4153	00000092  01*(????)			 SecOnCyl	 dw	 ?
1  4154	00000094  01*(??)			 Heads		 db	 ?
1  4155	00000095  01*(??)			 PhysNoDisk	 db	 ?
1  4156	00000096  01*(????????)			 SerNoDisk	 dd	 ?
1  4157	0000009A  01*(0B*(??))			 NameOfDisk	 db	 11 dup(?)
1  4158	000000A5  01*(??)			 MediaID	 db	 ?
1  4159
1  4160	000000A6  01*(015A*(??))		 DDpo		 db	 346 dup(?)
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 74
setup.asm



1  4161	00000200			 ExtBt	 ends
1  4162	    3BD8  0200*(??)		 ExtBoot ExtBt <>
1  4163
1  4164	    3DD8			 Zasobnik:
1  4165	    3DD8  50*(53 74 61 63 6B)			 db	 (80) dup("Stack")
1  4166	    3F68  FF					 ISTACK	 db	 "ÿ"
1  4167
1  4168	    3F69			 DiskData:
1  4169	    3F69  44*(44 69 73 6B 44  +			 db	 (540/8+1) dup("DiskData")
   4170		  61 74	61)
1  4171
1  4172	    4189  1770*(CC)		 Doplneni	 db	 6000 dup(0CCh)
1  4173
   4174
   4175	    58F9			 _TEXT ends
   4176					 End @FD
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 75
Symbol Table




Symbol Name		Type   Value			   Cref	(defined at #)

??DATE			Text   "18/04/99"		   14
??FILENAME		Text   "setup	"		   16
??TIME			Text   "12:18:53"		   18
??VERSION		Number 0314			   20
@@_@0			Near   _TEXT:0B86		   1568	 #1570
@CPU			Text   1F9FH			   #4  #5  21
@CURSEG			Text   _TEXT			   #1
@DLY			Near   _TEXT:11FE		   #2307  2309
@FD			Near   _TEXT:0100		   #7  4176
@FILENAME		Text   SETUP
@TRYKBC			Near   _TEXT:121D		   2340	 #2344
@WORDSIZE		Text   4			   #1  #4  #5
@_@1			Near   _TEXT:0B34		   1492	 1496  1499  #1501
@_@1_			Near   _TEXT:0BAF		   1581	 1585  1588  #1590
@_@2			Near   _TEXT:0B40		   1503	 #1505
@_@_1			Near   _TEXT:0C48		   1665	 1669  1672  #1674
@_@_1__			Near   _TEXT:0C10		   1638	 1642  1645  #1647
@_@_2			Near   _TEXT:0C51		   1675	 #1677
@_@__1_			Near   _TEXT:0BD5		   1600	 1604  1607  #1609
A20_FAIL		Near   _TEXT:1203		   2294	 2300  2304  #2312
A20_OK			Near   _TEXT:11D7		   2265	 #2268
A20_SHUT		Near   _TEXT:122D		   2364	 #2366
ACCESS_ATTR		Text   byte ptr	[bp-0dh]	   #2217
ADROBL			Word   _TEXT:3B98		   1307	 1315  1321  1327  1333	 1344  1353  1363  #4085
AGAIN			Near   _TEXT:0537		   #709	 724
APM_BIOS_CHECK		Near   _TEXT:03F3		   179	#496
APM_BIOS_FLAGS		Word   _TEXT:3BB6		   505	523  #4109
APM_BIOS_VER		Word   _TEXT:3BB4		   180	497  504  #4108
AUX			Word   _TEXT:3BAB		   1525	 1541  #4102
BIG_ATTR		Text   byte ptr	[bp-0eh]	   #2218
BIOS_DISK_ERROR		Word   _TEXT:2C0B		   1108	 #3396
BIOS_DISK_FUNC		Word   _TEXT:2BCB		   1073	 #3363
BOOTFROMDISK		Byte   _TEXT:3BAF		   134	1182  #4104
BREAKCHECK		Near   _TEXT:0C52		   1501	 1610  1656  #1682
BREAKFLAG		Byte   _TEXT:3975		   1683	 1686  #3981
CHECKPART		Near   _TEXT:0A01		   1317	 1323  1329  1335  #1341
CLEARDISKDATA		Near   _TEXT:09A5		   #1306  1310
CLRSCR			Near   _TEXT:04C9		   #621	 955  1819
CMOS_DATA		Number 0071			   #2232
CMOS_INDEX		Number 0070			   #2231
CMOS_SHUTDOWN		Number 000F			   #2245
CODE_SEG_ACCESS		Number 009B			   #2209
COPYREG			Near   _TEXT:0D0D		   257	273  302  325  #1776
CPUINITERROR		Near   _TEXT:0228		   159	#212
CPU_INIT_ERROR		Near   _TEXT:3A6C		   215	#4031
CRLF			Text   0dh,0ah			   #2211
CRLF$			Text   0dh,0ah,'$'		   #2212
CTI_INT_VEC		Near   _TEXT:032D		   #350	 563  567  571	575  579  583  587  591	 1422
C_			Near   _TEXT:0673		   855	#910
DALSID			Near   _TEXT:095E		   1262	 1266  1270  1274  #1279
DAL_			Near   _TEXT:0655		   840	#884
DATA_SEG_ACCESS		Number 0093			   #2210
DA_			Near   _TEXT:0693		   864	#922
DB_			Near   _TEXT:069C		   866	#925
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 76
Symbol Table



DC_			Near   _TEXT:06A5		   868	#928
DDAL			Near   _TEXT:060E		   #851	 924  927  930	933
DDAL1			Near   _TEXT:063D		   862	#871  912  915	918  921
DDA__			Near   _TEXT:0631		   844	#863
DDB__			Near   _TEXT:0634		   846	#865
DDC__			Near   _TEXT:0637		   848	#867
DDD__			Near   _TEXT:063A		   850	#869
DD_			Near   _TEXT:06AE		   870	#931
DD_D			Near   _TEXT:05B7		   790	#811
DISABLE_BIT20		Number 00DD			   #2239  2361
DISK			Byte   _TEXT:3B9A		   841	852  874  911  914  917	 920  923  926	929  932  1112	#4087
DISKDATA		Near   _TEXT:3F69		   1281	 1302  1343  #4168
DISKERROR_00		Byte   _TEXT:27AB		   #3199  3397
DISKERROR_01		Byte   _TEXT:27C1		   #3203  3398
DISKERROR_02		Byte   _TEXT:27DF		   #3208  3399
DISKERROR_03		Byte   _TEXT:2806		   #3214  3400
DISKERROR_04		Byte   _TEXT:2834		   #3221  3401
DISKERROR_05		Byte   _TEXT:2850		   #3225  3402
DISKERROR_06		Byte   _TEXT:286E		   #3230  3403
DISKERROR_07		Byte   _TEXT:2881		   #3233  3404
DISKERROR_08		Byte   _TEXT:28A6		   #3239  3405
DISKERROR_09		Byte   _TEXT:28C4		   #3244  3406
DISKERROR_0A		Byte   _TEXT:28F1		   #3251  3407
DISKERROR_0AA		Byte   _TEXT:2ABD		   1164	 #3321	3418
DISKERROR_0B		Byte   _TEXT:291B		   #3257  3408
DISKERROR_0BB		Byte   _TEXT:2AD9		   1167	 #3325	3419
DISKERROR_0C		Byte   _TEXT:2945		   #3263  3409
DISKERROR_0CC		Byte   _TEXT:2B0B		   1170	 #3333	3420
DISKERROR_0D		Byte   _TEXT:2964		   #3268  3410
DISKERROR_0E		Byte   _TEXT:2999		   #3276  3411
DISKERROR_0E0		Byte   _TEXT:2B32		   1173	 #3339	3421
DISKERROR_0F		Byte   _TEXT:29D6		   #3285  3412
DISKERROR_0FF		Byte   _TEXT:2B65		   1176	 #3347	3422
DISKERROR_10		Byte   _TEXT:2A08		   #3293  3413
DISKERROR_11		Byte   _TEXT:2A29		   #3298  3414
DISKERROR_20		Byte   _TEXT:2A60		   #3306  3415
DISKERROR_40		Byte   _TEXT:2A6F		   #3309  3416
DISKERROR_80		Byte   _TEXT:2AA7		   #3317  3417
DISKERROR_N		Byte   _TEXT:2B98		   #3355
DISKFUNC_00		Byte   _TEXT:247C		   #3069  3364
DISKFUNC_01		Byte   _TEXT:249D		   #3074  3365
DISKFUNC_02		Byte   _TEXT:24B8		   #3078  3366
DISKFUNC_03		Byte   _TEXT:24C4		   #3080  3367
DISKFUNC_04		Byte   _TEXT:24D2		   #3082  3368
DISKFUNC_05		Byte   _TEXT:24EE		   #3086  3369
DISKFUNC_06		Byte   _TEXT:24FD		   #3089  3370
DISKFUNC_07		Byte   _TEXT:252D		   #3096  3371
DISKFUNC_08		Byte   _TEXT:2553		   #3102  3372
DISKFUNC_09		Byte   _TEXT:256A		   #3106  3373
DISKFUNC_0A		Byte   _TEXT:2593		   #3112  3374
DISKFUNC_0B		Byte   _TEXT:25A0		   #3114  3375
DISKFUNC_0C		Byte   _TEXT:25AD		   #3116  3376
DISKFUNC_0D		Byte   _TEXT:25C9		   #3120  3377
DISKFUNC_0E		Byte   _TEXT:25E2		   #3124  3378
DISKFUNC_0F		Byte   _TEXT:2624		   #3134  3379
DISKFUNC_10		Byte   _TEXT:2667		   #3144  3380
DISKFUNC_11		Byte   _TEXT:2680		   #3148  3381
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 77
Symbol Table



DISKFUNC_12		Byte   _TEXT:2692		   #3151  3382
DISKFUNC_13		Byte   _TEXT:269E		   #3153  3383
DISKFUNC_14		Byte   _TEXT:26B0		   #3156  3384
DISKFUNC_15		Byte   _TEXT:26C3		   #3159  3385
DISKFUNC_16		Byte   _TEXT:26D2		   #3162  3386
DISKFUNC_17		Byte   _TEXT:26E3		   #3165  3387
DISKFUNC_18		Byte   _TEXT:26F4		   #3168  3388
DISKFUNC_19		Byte   _TEXT:2715		   #3173  3389
DISKFUNC_1A		Byte   _TEXT:2724		   #3176  3390
DISKFUNC_1B		Byte   _TEXT:2736		   #3179  3391
DISKFUNC_1C0A		Byte   _TEXT:274D		   1076	 #3183	3392
DISKFUNC_1C0B		Byte   _TEXT:2767		   1079	 #3187	3393
DISKFUNC_1C0C		Byte   _TEXT:277F		   1082	 #3191	3394
DISKFUNC_1C0E		Byte   _TEXT:2794		   1085	 #3194	3395
DISKFUNC_??		Byte   _TEXT:2471		   #3067
DISKIOERR		Near   _TEXT:39B0		   1196	 #3998
DISKSCHECK		Near   _TEXT:0935		   191	#1259
DNENALEZEN		Near   _TEXT:098D		   1290	 #1297
DONE_APM_BIOS		Near   _TEXT:0435		   501	503  507  521  #524
DOPLNENI		Byte   _TEXT:4189		   #4172
EMPTY			Near   _TEXT:0571		   757	#761
EMPTY_8042		Near   _TEXT:1205		   2293	 2299  2303  #2326
ENABLE_BIT20		Number 00DF			   #2238  2262
ENABLE_GATE20		Near   _TEXT:11C9		   #2259
ENTER_MESS		Near   _TEXT:3B9F		   153	188  1194  1293	 1299  1318  1324  1330	 1336  #4089
ERRA1			Near   _TEXT:2235		   #2977
ERRA2			Near   _TEXT:2264		   1737	 #2984
ERRB1			Near   _TEXT:2293		   #2991
ERRB2			Near   _TEXT:22B2		   #2996
ERRB3			Near   _TEXT:22CE		   1740	 #3000
ERRB3X__		Near   _TEXT:0D08		   1761	 #1766
ERRB3_			Near   _TEXT:0CAF		   1730	 #1732
ERRB3_U			Near   _TEXT:0CB6		   #1735  1768
ERRB3__			Near   _TEXT:0D07		   1734	 1759  #1763
ERRB3___		Near   _TEXT:0CF5		   #1755  1762
ERRH0			Near   _TEXT:2366		   #3026
ERRH1			Near   _TEXT:2399		   #3034
ERRH2			Near   _TEXT:23B9		   #3039
ERRH3			Near   _TEXT:2404		   #3050
ERRH4			Near   _TEXT:243A		   #3058
ERRH5			Near   _TEXT:2448		   #3060
ERRK1			Near   _TEXT:2301		   1743	 #3008
ERRK2			Near   _TEXT:230F		   1746	 #3010
ERRK3			Near   _TEXT:231E		   #3013
ERRK4			Near   _TEXT:232D		   #3016
ERRK5			Near   _TEXT:233A		   #3018
ERRK6			Near   _TEXT:234B		   1749	 #3021
ERRK7			Near   _TEXT:2358		   #3023
ERROR			Near   _TEXT:06B7		   906	908  #934
ERRORINIT		Near   _TEXT:020F		   #198	 217  224
ERRORMESSAGE		Near   _TEXT:0CA5		   260	276  305  328  #1727
ERRORREGTBL		Near   _TEXT:0D87		   1767	 #1813
ERRX0			Near   _TEXT:2363		   1752	 #3025
ERR_NOAFBIT		Near   _TEXT:0F54		   1952	 #1956
ERR_NOAMBIT		Near   _TEXT:1032		   2024	 #2028
ERR_NOCDBIT		Near   _TEXT:1002		   2010	 #2014
ERR_NOCFBIT		Near   _TEXT:0F84		   1966	 #1970
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 78
Symbol Table



ERR_NOCPUID		Near   _TEXT:116F		   2099	 #2127
ERR_NODFBIT		Near   _TEXT:0EF4		   1924	 #1928
ERR_NOEMBIT		Near   _TEXT:1092		   2052	 #2056
ERR_NOIDBIT		Near   _TEXT:0E35		   1869	 #1873
ERR_NOMPBIT		Near   _TEXT:10AA		   2059	 #2063
ERR_NONEBIT		Near   _TEXT:1062		   2038	 #2042
ERR_NONWBIT		Near   _TEXT:101A		   2017	 #2021
ERR_NOOFBIT		Near   _TEXT:0EDC		   1917	 #1921
ERR_NOPCDBIT		Near   _TEXT:10F2		   2083	 #2087
ERR_NOPEBIT		Near   _TEXT:10C2		   2066	 #2070
ERR_NOPFBIT		Near   _TEXT:0F6C		   1959	 #1963
ERR_NOPGBIT		Near   _TEXT:0FEA		   2003	 #2007
ERR_NOPSEBIT		Near   _TEXT:113F		   2108	 #2112
ERR_NOPVIBIT		Near   _TEXT:1157		   2115	 #2119
ERR_NOPWTBIT		Near   _TEXT:110A		   2090	 #2094
ERR_NOSFBIT		Near   _TEXT:0F24		   1938	 #1942
ERR_NOTFBIT		Near   _TEXT:0F0C		   1931	 #1935
ERR_NOTSBIT		Near   _TEXT:107A		   2045	 #2049
ERR_NOVIFBIT		Near   _TEXT:0E6B		   1884	 #1888
ERR_NOVIPBIT		Near   _TEXT:0E53		   1876	 #1881
ERR_NOVMBIT		Near   _TEXT:0E83		   1891	 #1895
ERR_NOVMEBIT		Near   _TEXT:116F		   2122	 #2126
ERR_NOWPBIT		Near   _TEXT:104A		   2031	 #2035
ERR_NOZFBIT		Near   _TEXT:0F3C		   1945	 #1949
ERR_SH_AF		Byte   _TEXT:38F8		   1954	 #3938
ERR_SH_AM		Byte   _TEXT:390A		   2026	 #3944
ERR_SH_CD		Byte   _TEXT:3904		   2012	 #3942
ERR_SH_CF		Byte   _TEXT:38FE		   1968	 #3940
ERR_SH_DF		Byte   _TEXT:38EC		   1926	 #3934
ERR_SH_EM		Byte   _TEXT:3916		   2054	 #3948
ERR_SH_ID		Byte   _TEXT:38DB		   1871	 #3929
ERR_SH_MP		Byte   _TEXT:3919		   2061	 #3949
ERR_SH_NE		Byte   _TEXT:3910		   2040	 #3946
ERR_SH_NW		Byte   _TEXT:3907		   2019	 #3943
ERR_SH_OF		Byte   _TEXT:38E9		   1919	 #3933
ERR_SH_PCD		Byte   _TEXT:391F		   2085	 #3951
ERR_SH_PE		Byte   _TEXT:391C		   2068	 #3950
ERR_SH_PF		Byte   _TEXT:38FB		   1961	 #3939
ERR_SH_PG		Byte   _TEXT:3901		   2005	 #3941
ERR_SH_PSE		Byte   _TEXT:3925		   2110	 #3953
ERR_SH_PVI		Byte   _TEXT:3928		   2117	 #3954
ERR_SH_PWT		Byte   _TEXT:3922		   2092	 #3952
ERR_SH_SF		Byte   _TEXT:38F2		   1940	 #3936
ERR_SH_TF		Byte   _TEXT:38EF		   1933	 #3935
ERR_SH_TS		Byte   _TEXT:3913		   2047	 #3947
ERR_SH_VIF		Byte   _TEXT:38E2		   1886	 #3931
ERR_SH_VIP		Byte   _TEXT:38DE		   1879	 #3930
ERR_SH_VM		Byte   _TEXT:38E6		   1893	 #3932
ERR_SH_VME		Byte   _TEXT:392B		   2124	 #3955
ERR_SH_WP		Byte   _TEXT:390D		   2033	 #3945
ERR_SH_ZF		Byte   _TEXT:38F5		   1947	 #3937
EXPANSION_BIAS		Text   dword ptr [bp-20h]	   #2223
EXPECT_RESULTS		Text   byte ptr	[bp-10h]	   #2219
EXTBOOT			Struct _TEXT:3BD8 EXTBT		   252	268  286  291  292  311	 320  336  1183	 #4162
EXT_MEM_SIZE		Word   _TEXT:3BB0		   173	478  #4106
FIN			Near   _TEXT:039A		   427	#430  454
FIN_			Near   _TEXT:0BE8		   1621	 #1624
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 79
Symbol Table



FLUSHKBD		Near   _TEXT:0561		   701	#750  1713  1728  1754
FLUSHKBD_		Near   _TEXT:0563		   #754	 760
FONT852			Near   _TEXT:122F		   #2373
FORMATSTRING		Near   _TEXT:04F0		   #652	 1118
FPUINITERROR		Near   _TEXT:0234		   163	#219
FPU_INIT_ERROR		Near   _TEXT:3A9E		   222	#4040
FP_STATUS		Word   _TEXT:396A		   1241	 1242  1243  1246  1247	 #3959
FS_1			Near   _TEXT:04F3		   #656	 664  676
FS_2			Near   _TEXT:0500		   #662	 680
FS_3			Near   _TEXT:0509		   #671	 691
FS_4			Near   _TEXT:051D		   #688	 693
FS_EXIT			Near   _TEXT:0503		   661	#665
FS_PARAM		Near   _TEXT:0511		   659	#677
F_			Near   _TEXT:068B		   861	#919
GATE_A20		Near   _TEXT:11D9		   2263	 #2289	2362
GETKEY			Near   _TEXT:0549		   711	#727
GETTIME			Near   _TEXT:054E		   702	712  #733
GET_EXT_MEM_SIZE	Near   _TEXT:03D5		   172	#474
GOTOXY			Near   _TEXT:04BD		   458	#610  624  957	961  966  970  974  978	 982  986  990	997  1001 +
							   1007	 1012  1033  1040  1046	 1052  1089  1126  1822	 1909  2139  2147 +
							   2152	 2157
HEADERST_		Struct _TEXT:0105 HEADERST	   #77
I13_1C0A		Near   _TEXT:0804		   1062	 #1075
I13_1C0B		Near   _TEXT:080A		   1064	 #1078
I13_1C0C		Near   _TEXT:0810		   1066	 #1081
I13_1C0E		Near   _TEXT:0816		   1068	 #1084
I13_D1			Near   _TEXT:0775		   #1020  1026
I13_D12			Near   _TEXT:0787		   1023	 #1029
I13_DAL			Near   _TEXT:0819		   1074	 1077  1080  1083  #1087
I13_E0AA		Near   _TEXT:0884		   1095	 #1163
I13_E0BB		Near   _TEXT:0889		   1097	 #1166
I13_E0CC		Near   _TEXT:088E		   1099	 #1169
I13_E0E0		Near   _TEXT:0893		   1101	 #1172
I13_E0FF		Near   _TEXT:0898		   1103	 #1175
I13_KONEC		Near   _TEXT:0877		   #1148
I13_OK1			Near   _TEXT:077F		   1019	 #1024
I13_OK2			Near   _TEXT:0784		   1022	 #1027
I13_PERR		Near   _TEXT:0850		   #1110  1165	1168  1171  1174  1177
I21_01			Near   _TEXT:0B0F		   1449	 1463  #1488
I21_01_			Near   _TEXT:0AEE		   1381	 #1462
I21_02			Near   _TEXT:0B41		   1465	 #1511	1569
I21_02_			Near   _TEXT:0AF1		   1383	 #1464
I21_03			Near   _TEXT:0B49		   1467	 #1521
I21_03R			Near   _TEXT:0B4A		   #1523  1528
I21_03_			Near   _TEXT:0AF4		   1385	 #1466
I21_04			Near   _TEXT:0B5B		   1469	 #1535
I21_04_			Near   _TEXT:0AF7		   1387	 #1468
I21_05			Near   _TEXT:0B6C		   1471	 #1552
I21_052			Near   _TEXT:0AB0		   #1427
I21_05_			Near   _TEXT:0AFA		   1389	 #1470
I21_06			Near   _TEXT:0B7D		   1473	 #1566
I21_06_			Near   _TEXT:0AFD		   1391	 1451  #1472
I21_07			Near   _TEXT:0B8A		   1475	 #1577
I21_07_			Near   _TEXT:0B00		   1393	 1453  #1474
I21_08			Near   _TEXT:0BB0		   1477	 #1596
I21_08_			Near   _TEXT:0B03		   1395	 1455  #1476
I21_09			Near   _TEXT:0BD9		   1479	 #1615
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 80
Symbol Table



I21_09_			Near   _TEXT:0B06		   1397	 #1478
I21_0A			Near   _TEXT:0BEA		   1481	 #1629
I21_0A_			Near   _TEXT:0B09		   1457	 #1480
I21_0B			Near   _TEXT:0BEB		   1483	 #1634
I21_0B_			Near   _TEXT:0B0C		   1401	 #1482
I21_0C			Near   _TEXT:0AB6		   1403	 #1435
I21_25			Near   _TEXT:0AA8		   1406	 #1416
I21_35			Near   _TEXT:0AAC		   1408	 #1421
I21_CTIKBDBUFFER	Near   _TEXT:0C23		   1571	 #1661
I21__0C			Near   _TEXT:0AC8		   1440	 #1445
I21__0C_		Near   _TEXT:0AB7		   #1437  1444
INIT_ERROR		Near   _TEXT:3A13		   201	#4017
INIT_MESS		Near   _TEXT:3992		   151	#3992
INPT_BUF_FULL		Number 0002			   #2237  2337
INT00			Far    _TEXT:0C89		   145	#1709
INT00ERR		Near   _TEXT:21F1		   1717	 #2967
INT13			Near   _TEXT:0597		   194	#789
INT21			Near   _TEXT:0A48		   #1379
INT_BAK			Near   _TEXT:0436		   144	#561
INT_SAVE		Text   [bp-4]			   #2213
INT_STACK		Text   [bp-8]			   #2214
ISTACK			Byte   _TEXT:3F68		   137	#4166
KBC_CTL			Number 0060			   #2229  2302
KBC_STAT		Number 0064			   #2230  2298	2336
KONEC			Near   _TEXT:059A		   #791	 807  810
KONST_00195		Tbyte  _TEXT:397A		   231	#3983
LAFA_1			Near   _TEXT:0282		   255	#263
LAFA_2			Near   _TEXT:02A5		   271	#279
LAFA_3			Near   _TEXT:02E5		   300	#308
LAFA_4			Near   _TEXT:0319		   323	#331
LAFA_DONE		Near   _TEXT:0328		   262	278  307  330  #340
LENGTHSTRING		Near   _TEXT:04E3		   #637
LMINUTE			Near   _TEXT:0535		   705	#707
LOGADRFYZADR		Near   _TEXT:0258		   168	#241
LOGADRSEK		Dword  _TEXT:0329		   248	295  317  #342
LS_			Near   _TEXT:04E5		   #639	 644
LS_EX_			Near   _TEXT:04EF		   643	#645
LT100			Near   _TEXT:0588		   776	#779
MOUSE_CHECK		Near   _TEXT:03DE		   185	#482
MOUSE_PRESENT		Word   _TEXT:3BB2		   186	487  491  #4107
NASTAV_INT_VEC		Near   _TEXT:034E		   147	196  #377  1417
NOT_286			Near   _TEXT:0905		   1231	 #1234
NOT_8086		Near   _TEXT:08F2		   1217	 #1220
NOT_87			Near   _TEXT:0932		   1245	 1250  #1253
NO_32_APM_BIOS		Near   _TEXT:042F		   514	#522
NO_PSMOUSE		Near   _TEXT:03F2		   490	#492
NV			Byte   _TEXT:3BAA		   806	809  838  #4101
NV_			Near   _TEXT:05A7		   #805	 834
NV__			Near   _TEXT:05AF		   #808	 837
OFS_R			Word   _TEXT:11C5		   2170	 2172  #2175
OLD13			Struct _TEXT:3BA2 OLD13_	   827	828  829  830  1008  1013  1034	 1041  1047  1053  1059	 #4098
OLDERRREG		Struct _TEXT:388E ERR_		   1781	 1783  1784  1785  1786	 1787  1788  1789  1790	 1796  1797  1798 +
							   1799	 1800  1801  1804  1806	 1808  1828  1832  1836	 1840  1844  1848 +
							   1852	 1856  1860  1865  1867	 1874  1882  1889  1896	 1915  1922  1929 +
							   1936	 1943  1950  1957  1964	 1974  1978  1982  1986	 1990  1994  1999 +
							   2001	 2008  2015  2022  2029	 2036  2043  2050  2057	 2064  2074  2079 +
							   2081	 2088  2101  2104  2106	 2113  2120  #3915
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 81
Symbol Table



OLDINTS			Struct _TEXT:3BB8 OLDINT_	   564	565  568  569  572  573	 576  577  580	581  584  585  588  589	  +
							   592	593  905  1413	#4129
PARTTABLE		Near   _TEXT:09B4		   1295	 #1314
PAX			Word   _TEXT:396C		   #3975
PBX			Word   _TEXT:3970		   #3977
PCX			Word   _TEXT:396E		   #3976
PRESSANYK		Near   _TEXT:39E1		   203	1204  #4008
PRINTCSTR		Near   _TEXT:119A		   1872	 1880  1887  1894  1920	 1927  1934  1941  1948	 1955  1962  1969 +
							   2006	 2013  2020  2027  2034	 2041  2048  2055  2062	 2069  2086  2093 +
							   2111	 2118  2125  #2156
PRINTDISKERROR		Byte   _TEXT:2C3F		   958	#3425
PRINTERRORREG16		Near   _TEXT:1191		   1975	 1979  1983  1987  1991	 1995  #2151
PRINTERRORREG32		Near   _TEXT:1174		   1829	 1833  1837  1841  1845	 1849  1853  1857  1861	 1866  2000  2075 +
							   2080	 2105  #2136
PRINTPARTITION		Byte   _TEXT:3051		   #3579
PRINTSYSTEMERROR	Byte   _TEXT:3325		   1823	 #3692
PRINT_DIGIT		Near   _TEXT:0373		   #405	 417
PRINT_HEX		Near   _TEXT:036F		   174	181  187  #402	964  968  972  976  980	 984  988  995	999  1004 +
							   1010	 1031  1038  1044  1050	 1057  1367  2141  2149	 2154
PRN			Word   _TEXT:3BAD		   1557	 #4103
PRTCHR			Near   _TEXT:039C		   176	183  428  #436	780  783  1199	1201  1504  1514  1622	1676  1694+
							   1696	 1698  1700
PRTCOLORCHR		Near   _TEXT:03C3		   455	#463  1911
PRTCOLORSTR		Near   _TEXT:03B0		   #450	 2161
PRTDEC			Near   _TEXT:0574		   #770	 777
PRTSTR			Near   _TEXT:038D		   152	154  189  202  204  216	 223  #423  959	 1090  1130  1195  1197	  +
							   1203	 1205  1280  1292  1294	 1298  1300  1319  1325	 1331  1337  1342 +
							   1350	 1360  1370  1824
PRTSTR_			Near   _TEXT:0BDC		   #1618  1623
PS_2			Near   _TEXT:038E		   #425	 429
PS__2			Near   _TEXT:03B1		   #452	 459
PT1			Near   _TEXT:0A31		   1357	 #1359
PTD1			Near   _TEXT:0A44		   1348	 #1369
REPLACEDISK		Near   _TEXT:39D1		   1202	 #4004
RESET			Near   _TEXT:11B1		   209	#2168
RESETCPU		Number 00FE			   #2240
RETEZEC			Byte   _TEXT:398A		   #3990
SCANCODE		Byte   _TEXT:3974		   1443	 1446  1489  1490  1497	 1578  1579  1586  1597	 1598  1605  1635 +
							   1636	 1643  1662  1663  1670	 #3980
SEG_R			Word   _TEXT:11C7		   2169	 #2176
SEKTORUNAFAT		Near   _TEXT:0240		   170	#227
SEKTORUNAFAT_TMP	Dword  _TEXT:3984		   234	#3984
SEKTORU_TMP		Dword  _TEXT:3976		   230	#3982
SHUT_A20		Near   _TEXT:1220		   #2358
SKIP10			Near   _TEXT:058D		   778	#781
START			Near   _TEXT:018B		   10  #131
STRUKTURY_SDOS_		Near   _TEXT:3BAA		   1428	 #4100
TESTFOR8086		Near   _TEXT:08E7		   157	#1213
TESTFOR8087		Near   _TEXT:0908		   161	#1239
TEST_BEYOND		Text   dword ptr [bp-1ch]	   #2222
TEST_COUNTER		Text   word ptr	[bp-0ah]	   #2215
TEST_STATUS		Text   word ptr	[bp-0ch]	   #2216
TEST_WITHIN		Text   dword ptr [bp-18h]	   #2221
TMP			Word   _TEXT:3972		   1303	 1309  #3978
TMPSTRING		Byte   _TEXT:392E		   1113	 1129  #3957
TMP__1			Byte   _TEXT:38D8		   1898	 1902  #3926
TMP__2			Byte   _TEXT:38D9		   1900	 1904  #3927
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 82
Symbol Table



TMP__3			Byte   _TEXT:38DA		   1817	 1877  2098  #3928
TRY_KBC			Near   _TEXT:120C		   #2333  2338	2342
UPPER_LIMIT		Text   dword ptr [bp-14h]	   #2220
USER_SHUTDOWN		Number 000A			   #2246
VIDEOATRIBUT		Byte   _TEXT:3989		   414	442  465  625  1906  1910  1913	 2158  2160  2163  #3987
VIDEOSTRANKA		Byte   _TEXT:3988		   438	466  601  615  626  #3986
VYPLNEBERROR		Near   _TEXT:08BE		   1189	 1191  #1193
VYPLNEXTBOOT		Near   _TEXT:089D		   #1180
V_			Near   _TEXT:0683		   859	#916
WAIT30SFORPRESSK	Near   _TEXT:0525		   #697
WHEREXY			Near   _TEXT:04AF		   456	#597
ZASOBNIK		Near   _TEXT:3DD8		   #4164
Z_			Near   _TEXT:067B		   857	#913
_0B_00			Near   _TEXT:0C1B		   1649	 #1652
_0B_01			Near   _TEXT:0C1D		   1651	 #1654
_@@1			Near   _TEXT:0C5C		   1684	 #1686
_@@2			Near   _TEXT:0C62		   #1687  1692
_@@3			Near   _TEXT:0C70		   1689	 #1693
_HD0			Near   _TEXT:3ADA		   1260	 #4052
_HD1			Near   _TEXT:3AE9		   1264	 #4055
_HD2			Near   _TEXT:3AF8		   1268	 #4058
_HD3			Near   _TEXT:3B07		   1272	 #4061
_NALEZEN		Near   _TEXT:0996		   1296	 #1301
_NENALEZEN		Near   _TEXT:3AC2		   1289	 1347  1356  #4048
_OBLAST1		Near   _TEXT:3B16		   1316	 #4064
_OBLAST2		Near   _TEXT:3B27		   1322	 #4067
_OBLAST3		Near   _TEXT:3B38		   1328	 #4070
_OBLAST4		Near   _TEXT:3B49		   1334	 #4073
_OK			Near   _TEXT:3ACE		   1291	 1349  1358  #4050
_PRIZAKTIV		Byte   _TEXT:3B5A		   #4076
_PRIZOS			Byte   _TEXT:3B7C		   #4081

Macro Name						   Cref	(defined at #)

BIN_ASC							   #113
IO_DELAY						   #2248  2295	2307  2334
POPREG							   #106
PUSHREG							   #100

Structure Name		Type  Offset			   Cref	(defined at #)

ERR_							   #3891  3915
 _EAX			Dword  0000
 _EBX			Dword  0004
 _ECX			Dword  0008
 _EDX			Dword  000C
 _ESI			Dword  0010
 _EDI			Dword  0014
 _EBP			Dword  0018
 _ESP			Dword  001C
 _EIP			Dword  0020
 _EFLAGS		Dword  0024
 _CS			Word   0028
 _SS			Word   002A
 _DS			Word   002C
 _ES			Word   002E
 _FS			Word   0030
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 83
Symbol Table



 _GS			Word   0032
 _CR0			Dword  0034
 _CR2			Dword  0038
 _CR3			Dword  003C
 _CR4			Dword  0040
 _OSS			Word   0044
 _OESP			Dword  0046
EXTBT							   #4132  4162
 MAJORVER		Byte   0000
 MINORVER		Byte   0001
 NFSVER			Word   0002
 SECROOT		Byte   0004
 FIRSTSECROOT		Dword  0005
 FIRSTSECDAT		Dword  0009
 SECDAT			Dword  000D
 SECPART		Dword  0011
 FIRSTSECPART		Word   0015
 FIRSTCYLPART		Word   0017
 FIRSTHEAPART		Byte   0019
 PARTMOUNTED		Byte   001A
 DISKMARK		Byte   001B
 MOUNTCODE		Byte   0023
 UNMOUNTCODE		Byte   0055
 ENDSECPART		Word   0087
 ENDCYLPART		Word   0089
 ENDHEAPART		Byte   008B
 SECSAT			Dword  008C
 SECSYSPART		Word   0090
 SECONCYL		Word   0092
 HEADS			Byte   0094
 PHYSNODISK		Byte   0095
 SERNODISK		Dword  0096
 NAMEOFDISK		Byte   009A
 MEDIAID		Byte   00A5
 DDPO			Byte   00A6
HEADERST						   #12	77
 _DATE_			Byte   0000
 _FILENAME_		Byte   0008
 _TIME_			Byte   0010
 _LINKVER_		Word   0018
 _CPU_			Word   001A
 _OSMAJORVER		Word   001C
 _OSMINORVER		Word   001E
 _OSBUILDVER		Word   0020
 _OSSUBVER		Byte   0022
 _OSMODE		Byte   0023
 _OS			Byte   0024
 _OS_			Dword  0025
 _OS__			Dword  0029
 _MODULETYPE		Word   002D
 _OSGRSUBSYSTEM		Byte   002F
 _MODULEFLAGS		Word   0030
 _MODMAJORVER		Word   0032
 _MODMINORVER		Word   0034
 _MODBUILDVER		Word   0036
 _MODSUBVER		Byte   0038
 _NEEDCPU		Byte   0039
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 84
Symbol Table



 _NEEDFPU		Byte   003A
 _STARTEIP		Dword  003B
 _STARTCS		Word   003F
 _DATATBLOFF		Dword  0041
 _DATATBLSEG		Word   0045
 _RESOURCETBLOFF	Dword  0047
 _RESOURCETBLSEG	Word   004B
 _CODETABLEOFF		Dword  004D
 _CODETABLESEG		Word   0051
 _IMPORTTBLOFF		Dword  0053
 _IMPORTTBLSEG		Word   0057
 _EXPORTTBLOFF		Dword  0059
 _EXPORTTBLSEG		Word   005D
 _STARTSP		Dword  005F
 _STARTSS		Word   0063
 _MINMEM		Word   0065
 _MAXMEM		Word   0067
 _CHECKSUMCRC		Dword  0069
 _NEEDDOSENVIR		Byte   006D
 _FILESIZE		Dword  006E
 _LOADEDOK_		Byte   0072
OLD13_							   #4092  4098
 _AX			Word   0000
 _BX			Word   0002
 _CX			Word   0004
 _DX			Word   0006
OLDINT_							   #4111  4129
 OFS_00			Word   0000
 SEG_00			Word   0002
 OFS_09			Word   0004
 SEG_09			Word   0006
 OFS_13			Word   0008
 SEG_13			Word   000A
 OFS_16			Word   000C
 SEG_16			Word   000E
 OFS_20			Word   0010
 SEG_20			Word   0012
 OFS_21			Word   0014
 SEG_21			Word   0016
 OFS_22			Word   0018
 SEG_22			Word   001A
 OFS_2F			Word   001C
 SEG_2F			Word   001E

Groups & Segments	Bit Size Align	Combine	Class	   Cref	(defined at #)

_TEXT			16  58F9 Para	none		   #1  2  2  2	2
Turbo Assembler	 Version 3.2	    18/04/99 12:18:53	    Page 85
Error Summary



*Warning* .\EGA.852(26)	Missing	end quote
